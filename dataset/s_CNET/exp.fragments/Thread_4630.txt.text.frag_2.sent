i fixed one like this recently. 
they had some firewall software and after i added this to its allow list they remember they had to do that before as well. 
what made them think it was not the firewall was that the printer was found and there was that key code box. 
i uninstalled the firewall software during setup and later, after the printing was working reinstalled the firewall which is when the popup popped up to ask for permission for the printer connection. the ugly part of this was the popup did not mention it was for the printer but i knew that was what it was for. 
imagine that. the makers think we know this. 
bob 
