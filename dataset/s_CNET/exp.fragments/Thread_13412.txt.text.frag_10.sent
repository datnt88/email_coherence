dd-wrt is an open source firewall that has been ported to most brands of routers. 
you have to make sure to get the version that matches your router, and they have a help system to point you at it. 
from there, it's pretty easy to flash it onto the router. 
built in to dd-wrt are a few different hotspot management systems to choose from. 
i've never set one up myself, but they're designed for exactly the situation you're facing. 
so, i'd assume that at least one of them would be fairly straightforward to set up. 
drake christensen 
