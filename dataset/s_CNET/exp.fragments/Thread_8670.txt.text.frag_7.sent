i know i am reviving a thread that is 18 months old, but i recently purchased a compaq armada m700 giving the exact same problems described here! 
it just starts working again if you leave the laptop for a while. 
i have found no sollutions yet, but a few explanations came after a few hours of googling. 
the battery is fine - the leds on the battery shows it is fully charged, battery monitoring tools pick up the battery as normal. 
dignostics shows all the information that you could possibly want to know about the battery, yet it is as dead as a doornail if you pull the ac adapter! 
apparently there is a problem with the micro controller inside the battery. 
it crashes and doesn't want to discharge the battery because the battery thinks it is still charging. 
the cells are still fine. 
if this is true or not, i don't know - but it is the *only* explanation i could find... i hope someone can help out with this! 
