whenever i have a defrag problem, i have found that by booting into safe mode and runningthe defrag from there works. 
i agree that you should get rid of the .tmp 
files, those will clutter up a system like ants at a picnic, and it will give you more room to work in. 
so see what temp files you an get rid of, there may be some help files that aren't needed also. 
reboot into safe mode, run scandsk first and then run the defrag. 
by doing it from the safe mode, you don't have all of the drivers loaded into memory that will cut down on how much ram you can use. 
ed 
