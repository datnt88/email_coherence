<s> The draft spec (2.4.2) says that to match a SequenceType of form ("element" | "attribute") ElemOrAttrType?  </s>
<s> when ElemOrAttrType is a QName: The QName must be an element or attribute name that is found in the in-scope schema definitions.  </s>
<s> The match is successful only if the given element or attribute has the required name and also conforms to the schema definition for the required name.  </s>
<s> And Conformance section 2.5.2.1 Basic XQuery says: If any SequenceType contains an ElemOrAttrType, a Basic XQuery implementation raises a static error.  </s>
<s> This is very unfortunate, since it is very useful to be able to match a node against a specific element tag in a typeswitch.  </s>
<s> I'd go so far as to say that this guts most of the usefulness of typeswitch.  </s>
<s> The alternatives seem to be a lot more tedious and verbose.  </s>
<s> It is especially unfortunate for me since the examples I use in my article "Generating XML and HTML using XQuery" (available as because non-conforming without a matching Schema.  </s>
<s> Please revisit this.  </s>
<s> A suggestion, which has the advantage that it provides much of the power of XSLT's template processing: Add a pseudo-type for matching against a PATTERN: "matching" PathExpr I don't know if I'd go so far as to allow this everywheer that SequenceType is currently allowed, but I'd certainly allow it in the context of typeswitch: typeswitch ($node) case matching meta/title return "saw title inside a meta-tag" case matching title[@id] return "saw a title with an 'id' attribute" case matching title return "saw title not in a meta-tag default return "saw some other tag" Perhaps allow "match" as a synonym for "case "matching" to make it less verbose: typeswitch ($node) match meta/title return "saw title inside a meta-tag" match title[@id] return "saw a title with an 'id' attribute" match title return "saw title not in a meta-tag default return "saw some other tag" With this feature XQuery can do most of what XSLT can do, and much less verbosely.  </s>
<s> Perhaps adding the full PathExpr may be a bit much for Basic XQuery 1.0, but allowing 'matching NodeTest' may be a good start --Per Bothner per@bothner.com  </s>
<s> http://www.bothner.com/per/  </s>
<s> I've got some sympathy with the ideas here: I have been trying to press for changes that bring the type matching mechanisms and the path expressions (and match patterns) more closely together, at the moment they feel very disjoint.  </s>
<s> They use different syntactic styles and they don't compose well with each other.  </s>
<s> I have also had a feeling at the back of my mind that XSLT patterns are being used as a sort of type mechanism: pattern matching categorizes elements according to their structural properties by means of instance-level predicates in a way that is not that dissimilar from the way a schema processor allocates types by examining the structure of the content.  </s>
<s> In XSLT we have a requirement to allow template rules to be driven by schema types, and the current syntax for achieving this is pretty dire.  </s>
<s> I think that typeswitch is so central to the static typing approach that the ideas you suggest for extending it wouldn't fly.  </s>
<s> A more general kind of  </s>
<s> switch that can match on properties other than type sounds an interesting idea: it could get very close to xsl:apply-templates.  </s>
<s> I think few people would want to add such a major piece of functionality to Query version 1.0 at this stage of development.  </s>
<s> Cheers, Michael Kay  </s>
<s> No, I expected that.  </s>
<s> But is it possible to change the definition of SequenceType to that 'element QName' can be used without a Schema?  </s>
<s> Being able to specify "an element node with a given QName" is *very* useful, and I suspect *more* useful than "has a specific name and that has been validated as conforming to the schema definition for that name", especially given the existence of Basic XQuery.  </s>
<s> Expressing "an element node with a given QName" is very difficult with the current definition, even though I think it is something a lot of people will want to do, while expressing "has a specific name and that has been validated as conforming to the schema definition for that name" can be done using 'element QName1 of type QName2', as long as the Scheme defines a name for the element's type.  </s>
<s> Being able to succinctly express "element with a given QName" is a very important use-case as I see it, and we should be able to express it without requiring Schemas.  </s>
<s> (Even after I implement Schemas Import, I suspect many people will be put off if they are expected to write schemas.) (I didn't read carefully enough earlier, and I realize I should have caught this sooner.) --Per Bothner per@bothner.com  </s>
<s> http://www.bothner.com/per/  </s>
