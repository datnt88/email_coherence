<s> From the top of my head there are the following issues brought up by Netscape representatives (they will send a message to this list after having checked thouroughly):  </s>
<s> 1. Browser sniffing -- it seems that the sniffing is not elaborate  </s>
<s> enough, makes Mozille, for example, run code with calls to an ActiveX  </s>
<s> object.  </s>
<s> 2. Tests on default attributes require a validating parser, which is not  </s>
<s> a requirement (for XML), for HTML default attributes need to be there.  </s>
<s> The issue is then that the TS tests the XML appclication DOM, not the browser DOM  </s>
<s> And from IBM: 1. readonly issues, as indicated in a previous message  </s>
<s> 2. Ability to run single tests (in Java) instead of the entire suite.  </s>
<s> I  </s>
<s> promised to come back with relevant info on how not to run entire suites (this is the way we run it right now)  </s>
<s> /Dimitris  </s>
<s> I'll admit that it isn't elaborate, but under what scenario does Mozilla run  </s>
<s> an ActiveX object?  </s>
<s> It doesn't require that the document be validated, but it does require that the DTD be processed.  </s>
<s> The DOM rec doesn't seem to allow a processor to omit default attributes or return null for doctype when there is a DTD.  </s>
<s> , for HTML default attributes need to be there.  </s>
<s> The DOM Level 1 test suite currently only contains tests for XML and SVG  </s>
<s> documents.  </s>
<s> Microsoft IE does not have an browser implementation of the XML DOM so the MSXML2.DOMDocument is used for tests using XML documents.  </s>
<s> Since  </s>
<s> Mozilla does have a XML DOM in the browser, it is used for tests on XML  </s>
<s> documents.  </s>
<s> I believe that Netscape was converting going to be providing DOM 1 Core tests that use HTML documents, and when those tests are run using HTML documents they will use the browsers HTML DOM implementation.  </s>
<s> Let me search the archives and come up with a history of the discussion on these tests.  </s>
<s> From the command line, if you do:  </s>
<s> java -classpath dom1-core.jar  </s>
<s> testclassname such as: java -classpath dom1-core.jar  </s>
<s> org.w3c.domts.level1.core.documentcreatecdatasection it will run just the specified test twice (once for each configuration).  </s>
<s> Individual tests cannot be run (currently) from JUnit GUI's since there are not junit.framework.TestCase derived classes corresponding to each test.  </s>
<s> comments inlined  </s>
<s> [dd] I've no idea, they would look into this and get back to this list.  </s>
<s> [dd] My interpreetation as well, but we'll have to see what the issue is once the QA people at Netscape formulate it  </s>
<s> [dd] The issue is probably exactly that; IE has an external program for processing XML, whereas Netscape does not.  </s>
<s> [dd] Thanks, I'll update relevant documentation accordingly  </s>
<s> Sorry, I've got a volume to deal with, but let me have a quick go at the simple answer.  </s>
<s> When the TS identifies it as IE and tells it to load Active X components.  </s>
<s> The DOM spec only requires that which is required by XML of a non-validating processor.  </s>
<s> A non-validating processor is not required to read the DTD.  </s>
<s> It is only required to read and be aware of default attributes in the very unlikely scenario that they are declared in the internal subset, and then I believe there are some rules that let it ignore them starting at some points such as an external parameter entity reference where something will be missing.  </s>
<s> If there are tests, they should be clearly labeled as for default attributes in internal subsets -- which are seldom used.  </s>
<s> As people will compare the results, there has to be clarity about what was tested.  </s>
<s> I believe each implementation must clearly list what it did and did not pass.  </s>
<s> If one set of results are given as though they are for the same implementation, and two implementations are being used to satisfy the requirements, that seems wrong.  </s>
<s> If IE has two implementations, then there are two sets of results.  </s>
<s> If the test suite is broken into modules so that you can say "not tested" for one of the modules, that seems appropriate, because it, too, clearly shows that individually the implementations do less.  </s>
<s> My 2 cents, anyway.  </s>
<s> Ray Whitmer rayw@netscape.com  </s>
<s> From: Curt Arnold [mailto:carnold@houston.rr.com]  </s>
<s> IE programmatically implements DOM Documents as ActiveX objects.  </s>
<s> So, I guess some of the test that require this, use (in JavaScript) var myDomDoc = new ActiveXObject("Msxml2.XMLDOM");  </s>
<s> You may encounter an msxml version_dependent_ProgId like Msxml2.XMLDOM.4.0.  </s>
<s> The above is IE specific.  </s>
<s> Mozilla instead uses the factory style (as DOM Level 2 likes it): var myDomDoc = document.implementation.createDocument("",  </s>
<s> "", null); Anyway, it should be something like the above situation: need of vendor dependent code and lack of browser sniffing.  </s>
<s> I'd be happy to give a hand fixing this if you pass it on.  </s>
<s> Manos  </s>
<s> To get to the call to new ActiveXObject, the browser must be identified as IE.  </s>
<s> For Netscape or Mozilla to be falsely identified as IE, navigator.appName  </s>
<s> must contain "Microsoft" and not contain "Netscape".  </s>
<s> That does not occur with Mozilla on any of the versions and platforms that I've tested.  </s>
<s> What I wanted was something like, when running Mozilla 0.9.8 on OpenVMS, I get a message that ActiveXObject is not defined.  </s>
<s> The value of navigator.appName is "Mozilla (not Microsoft)".  </s>
<s> However, I've incorporated the logic from detect Navigator 6 and Mozilla.  </s>
<s> However, since I don't have access to whatever Mozilla browser that confounds the existing logic, I can't tell if it fixes the problem.  </s>
<s> I'll be committing some changes to DOMTestSuite.js in just a few moments.  </s>
<s> The report that Mozilla attempted to run the ActiveX object is a red  </s>
<s> herring due to a misunderstanding in verbal communications with a member of the DOM WG.  </s>
<s> As far as I know, no one at Netscape made such a claim.  </s>
<s> The issue with sniffing is that it is too restrictive.  </s>
<s> The relevant message to this list is from Dimitris on 2/20/2002 at 1:24PM From the top of my head there are the following issues brought up by Netscape representatives (they will send a message to this list after having checked thouroughly):  </s>
<s> 1. Browser sniffing -- it seems that the sniffing is not elaborate  </s>
<s> enough, makes Mozille, for example, run code with calls to an ActiveX  </s>
<s> object. 2. Tests on default attributes require a validating parser, which is not a requirement (for XML), for HTML default attributes need to be there.  </s>
<s> The issue is then that the TS tests the XML appclication DOM, not the browser DOM The issue with MSXML vs. Native browser implementations is another issue.  </s>
<s> /bc  </s>
<s> Manos, any help in the DOM TS is appreciated, we are expecting to ship an updated version of the DOM Level 1 TS in about a month since we will have some HTMl tests to work with.  </s>
<s> Your work will be appreciated.  </s>
<s> /Dimitris  </s>
<s> From: Curt Arnold [mailto:carnold@houston.rr.com]  </s>
<s> My bad, should have been clearer on that, however the minutes from that telephone conference seem to endorse my interpretation of what the netscape representative claimed.  </s>
<s> That is member only information, so I cannot point to it.  </s>
<s> /Dimitris  </s>
