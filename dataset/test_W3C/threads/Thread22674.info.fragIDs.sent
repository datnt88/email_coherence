<s> Hi We are trying to generate a XML file dynamically after querying the database.  </s>
<s> For this we are first creating the tree structure then using XMLSerializer we generating the XML file.  </s>
<s> But when we try to link a xsl sheet using createProcessingInstruction , the instruction is not getting included.  </s>
<s> But the XML file is getting generated without any error .  </s>
<s> Is there any other way of doing this ?  </s>
<s> What should be given as target?  </s>
<s> Document doc =  </s>
<s> (Document)Class.forName("org.apache.xerces.dom.DocumentImpl").newInstance();  </s>
<s> doc.createProcessingInstruction("xml-stylesheet"," type=\"text/xsl\" href=\"http://localhost:8080/examples/jsp/XMLProject/quiz1_xsl.xsl\"");  </s>
<s> Regards Jayashree  </s>
<s> (Document)Class.forName("org.apache.xerces.dom.DocumentImpl").newInstance  </s>
<s> Don't do that; it's not only nonportable but isn't really supported.  </s>
<s> Instead, obtain the DOMImplmentation obect (which currently does require a nonportable step): DOMImplementation  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation(); and then use  </s>
<s> Document doc=domImpl.createDocument(...);  </s>
<s> Note that createDocument forces you to create the root element.  </s>
<s> Then, after you create the ProcessingInstruction node, remember to insert or append it as a child of some other node; otherwise it won't be part of your document tree.  </s>
<s> In this case, what you probably want to do is insert it  </s>
<s> as a child of the Document node, before the Document Element: ProcessingInstruction myPI = doc.createProcessingInstruction  </s>
<s> ("xml-stylesheet"," type=\"text/xsl\" href=\"http://localhost:8080/examples/jsp/XMLProject/quiz1_xsl.xsl\""); doc.insertBefore(myPI,doc.getDocumentElement());  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> Thank u.  </s>
<s> But when i give like this i am getting a compiling error  </s>
<s> DOMImplementation  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation(); saying DOMImplementation not found in type declaration.  </s>
<s> (i think must becos DOMImplementation is a interface) But if i change DOMImplemetation to DOMImplementationImpl this error is fixed but i am not able to invoke createProcessingInstruction() method. is there any work around for this?  </s>
<s> Regards Jayashree  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation();  </s>
<s> it  </s>
<s> The line you're asking about -- retrieving the DOMImplementation object -- is specific to a particular implementation of the DOM.  </s>
<s> Since you're asking about the Xerces implementation, this really belongs on the Apache Xerces-J mailing list.  </s>
<s> But I've just rechecked the current version of the Xerces code, and I believe the line I gave you really should work should work -- assuming, of course, that you have imported the DOM APIs import org.w3c.dom.DOMImplementation; DOMImplementation  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation  </s>
<s> If you didn't do the import, try: org.w3c.dom.DOMImplementation  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation  </s>
<s> Either should fix your "DOMImplementation is not found" problem.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> everything is fine.  </s>
<s> But the instruction is not getting included.  </s>
<s> The XML is getting generated with out the PI .  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation  </s>
<s> domImpl=org.apache.xerces.dom.DOMImplementationImpl.getDOMImplementation  </s>
<s> I believe we've closed this one out -- combination of using getDocumentElement rather than trying to create a new root element, and using insertBefore to place the PI before the root element, seems to have done what was needed.  </s>
<s> Joe Kesselman / IBM Research  </s>
