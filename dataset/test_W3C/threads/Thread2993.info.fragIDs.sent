<s> Hi, In the descriptions of each of the 301, 302, and 307 response codes of RFC 2616, the following text can be found; "If the [code] status code is received in response to a request other than GET or HEAD, the user agent MUST NOT automatically redirect the request unless it can be confirmed by the user, since this might change the conditions under which the request was issued."  </s>
<s> I believe that the conformance level should be "SHOULD NOT" rather than "MUST NOT".  </s>
<s> Though I'm not familiar with the history of this requirement, it seems self-explanatory regarding its intent; it's there as a warning, not as a conformance statement.  </s>
<s> And while it's certainly the best approach in the generic case (as "SHOULD NOT" would indicate), the opportunity for a private agreement to exist between client and server should be  </s>
<s> recognized IMO.  </s>
<s> In my case, the nature of the type of resource - as indicated in the  </s>
<s> messages via link metadata - to which a POST is submitted is such that there is no change of condition under which the request was issued.  </s>
<s> The agent has committed to submitting the data across a trust boundary with the expectation that a redirect is being performed in lieu of the server acting as an intermediary for the request.  </s>
<s> Thanks.  </s>
<s> Mark.  </s>
<s> Mark Baker.  </s>
<s> Ottawa, Ontario, CANADA.  </s>
<s> http://www.markbaker.ca  </s>
<s> What you propose requires a change to client behavior in a way that potentially reduces the integrity of the user interaction for all sites  </s>
<s> because you have a specific site you believe has a valid reason for  </s>
<s> allowing handling the redirect w/o user interaction.  </s>
<s> I don't believe endorsing this change in client behavior would be a good idea.  </s>
<s> Adding a new header or header parameter which declared a server's good intentions might be a reasonable approach.  </s>
<s> The client designers could then choose to honor the declaration or perhaps prompt the user once and remember that a specific server was approved, etc. Dave Morris  </s>
<s> Not at all.  </s>
<s> My proposal doesn't require that any client change behaviour (as they'd still conform to a "SHOULD NOT" requirement).  </s>
<s> It just asks that new clients be permitted to auto-redirect if they have a very good reason to do so.  </s>
<s> Mark. Mark Baker.  </s>
<s> Ottawa, Ontario, CANADA.  </s>
<s> http://www.markbaker.ca  </s>
<s> Well, that good reason should be user authorization.  </s>
<s> Obviously you could remember this authorization for that specific redirect.  </s>
<s> What you basically don't want to happen is your POST or PUT going to a different site.  </s>
<s> I couldn't imagine someone wanting to do this anyway.  </s>
<s> This is also the reason why browsers warn (and they should be doing this) when switching secured/unsecured.  </s>
<s> This is where the potential hazard is, commonly with authentication, using a secure site and the rest on a unsecured site.  </s>
<s> These redirect from secure to unsecure and I don't want this to happen with my POST containing my  </s>
<s> authentication information.  </s>
<s> Perhaps the definition: On retreiving .... the user agent MUST NOT automatically redirect when sending data, such as POST, PUT or web authoring functions and SHOULD NOT automatically redirect otherwise, unless the request is GET or HEAD, in which case a browser MAY redirect.  </s>
<s> Still, I'm interested in a (practical) sitiation where one needs to redirect a non-GET/HEAD request?  </s>
<s> - Joris  </s>
<s> From: ietf-http-wg-request@w3.org [mailto:ietf-http-wg-request@w3.org]  </s>
<s> On Behalf Of Mark Baker Sent: Tuesday, 4 November 2003 22:04 Subject: Re: Redirection MUST NOTs  </s>
<s> for allowing handling the redirect w/o user interaction.  </s>
<s> [Hopefully not going anywhere or duplicated.  </s>
<s> Still had the old WG mail address @ hp.com listed.]  </s>
<s> Without a protocol based reason for the client to alter its behavior, there is no reason to even use "SHOULD NOT" in the HTTP specification.  </s>
<s> To achieve the intended user protection, the base protocol needs to preclude auto-redirect.  </s>
<s> Dave Morris  </s>
<s> When the user agent trusts the server as it would a proxy, e.g.  </s>
<s> POST http://auth1.example.org/proxy?uri=http://auth2.example.org/some-path/  </s>
<s> HTTP/1.1 Host: auth1.example.org  </s>
<s> There, the server is providing proxy-like capabilities, but in gateway form.  </s>
<s> Mark. Mark Baker.  </s>
<s> Ottawa, Ontario, CANADA.  </s>
<s> http://www.markbaker.ca  </s>
<s> If one requests this URL: The user agent should already be aware that it better uses auth2.  </s>
<s> It is  </s>
<s> already given in the URI.  </s>
<s> Redirection would actually be a waste of time.  </s>
<s> Auth1 could (transpart for the user) handle authentication by internally forwarding it to auth2.  </s>
<s> Load balancing could be done after authentication or using clustering.  </s>
<s> This is the exact example I'm worries about, because (authentication) information could be send all over the Internet, when redirection is allowed.  </s>
<s> - Joris  </s>
<s> From: Mark Baker [mailto:distobj@acm.org] Sent: Wednesday, 5 November 2003 3:04 Subject: Re: Redirection MUST NOTs  </s>
<s> Even so: a) The user did not choose this proxy trust relationship  </s>
<s> b) The user-agent has no way to discern this request from any other POST request in the proposed change you have described.  </s>
<s> There is no valid way that the user agent would be aware and allowed to act on a URL parameter value which happens to be a URL/URI for some other resource.  </s>
<s> From: Mark Baker [mailto:distobj@acm.org] Sent: Wednesday, 5 November 2003 3:04 Subject: Re: Redirection MUST NOTs  </s>
<s> Doesn't matter what your Agent knows, what matters is what any user-agent is entitled to do.  </s>
<s> Better that your agent has a documented non-conformance than to relax a protocol requirement.  </s>
<s> Furthermore, since your agent has this trust relationship hard coded, I would assert that the 'user' decision to accept a redirect has been made and there is no protocol issue.  </s>
<s> Dave Morris  </s>
<s> My agent is an automata, not a browser, and it's hardcoded to trust "auth1".  </s>
<s> Mark.  </s>
<s> Mark Baker.  </s>
<s> Ottawa, Ontario, CANADA.  </s>
<s> http://www.markbaker.ca  </s>
