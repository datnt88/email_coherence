Hello,
Amaya 5.1 does not properly support input and displaying of international
characters. It does not even call "setlocale" to be at least partially
prepared for it. Still I am using ISO-8859-2 charset and I desperately need
Amaya to work properly for me.
I made Amaya execute "setlocale" by inserting two lines into
Amaya/batch/writeapp.c, here is the patch:
--- writeapp-orig.c Fri Mar 30 18:06:28 2001
+++ writeapp.c Wed Aug 1 23:32:31 2001
@@ -52,6 +52,7 @@
fprintf (file, "/* File generated by app - do not edit! */\n");
fprintf (file, "/* #################################### */\n");
fprintf (file, "/* Included files */\n");
+ fprintf (file, "#include \ locale.h\ \n");
fprintf (file, "#include \"string.h\"\n");
fprintf (file, "#include \"thot_gui.h\"\n");
fprintf (file, "#include \"thot_sys.h\"\n");
@@ -541,6 +542,7 @@
fprintf (AppFile, " int lg; /* identify dialogue messages */\n");
fprintf (AppFile, " char appName[MAX_PATH]; /* name of the application */\n");
fprintf (AppFile, " char workName[MAX_PATH]; /* path of the application */\n");
+ fprintf (AppFile, " setlocale\(LC_ALL,\"\"\);\n");
fprintf (AppFile, " /* initialize the Registry */\n");
fprintf (AppFile, " TtaInitializeAppRegistry (argv[0]);\n");
As I am very new to Amaya I do not know the source very well so I have put
it in the first place that seemed to be suitable.
This was not sufficient, though. Amaya now loads the locale, yet it doesn't
load the proper font and it does not accept a modifier key (that is, key
with acute, circumflex and other special "decorations").
This is however too difficult for me to implement. Would PLEASE somebody be
so kind to implement at least a font selection dialog which would allow the
user to select also the font encoding? I suppose that would not be difficult
for a skilled programmer (I am not such a one). That would solve the font
displaying problems. Or is there a nicer way to solve it?
Thanks a lot. I will try to help as much as I can.
All the very best,
Peter
Hi Peter,
you astonished me, because my mail agent newly created a folder to
for this mailing list, where I did subscribe a month ago. This folder
wasn't created yet because I never got an answer from anybody. I feld very
seldom and its a pity to mee that you will do also, I think. So I write to
you.
The amaya project is a nice one. So lets discuss about it. Why are
you interested in amaya, since there are so many other browsers ?
CU INGO
Hello,
how does this affect the windows version -- does it have a set locale
concept.
I don't know. I doubt that the Windows locale works in a same way that Linux
locales do. The fact is that Windows handles the locale initialization
differently, so it would be the best if some Windows users reported their
(un)success with using Amaya under non-English environments.
In the meantime we could solve this platform problem by defining a symbol
LINUX and using a conditional compilation:
#ifdef LINUX
fprintf (file, "#include \ locale.h\ \n");
#endif
#ifdef LINUX
fprintf (AppFile, " setlocale\(LC_ALL,\"\"\);\n");
#endif
there are methods built into amaya to recognize and save docs as 8859-2
but at present unicode support is not there.
Maybe the Amaya can recognize the 8859-2 encoding, but it can not display it
nor it can input 8859-2 characters from the keyboard. This way a user can't
browse pages written in 8859-2, nor can he edit or annontate them. Also the
support for the modifier key (dead key, compose key) is problematic. It
obviously uses a fixed (thus incorrect) encoding to interpret the resulting
compose characters.
I suggest that those who are willing to make this working should first have
a look at the NEdit. It is a very good text editor, it uses Motif (or
Lesstif) and it is working perfectly with the 8859-2 charset. It's homepage
and source texts are at http://nedit.org .
Thanks to all.
All the very best,
Peter
Hi Peter,
The support of international characters in Amaya is quite complex.
Of course we could switch to ISO-8859-2 charset to support another
subset of European languages, but the right general solution is to
handle Unicode characters.
This implies 3 steps:
1- Replacing the handling of 8 bits characters by Unicode functions.
Due to external constraints, sometimes Unicode characters must be
encoded as UTF-8 strings, sometimes they must be encoded as
wide-characters.
So the adaptation of the code is not easy and adequate conversion
functions must be developed.
2- We need also to write displaying functions that'll find for each
character the right font and the right glyph within the font.
Theses functions depends on the platform (Windows or X-Windows).
3- Then several input methods should be added to the Amaya code.
Just the step 1 is quite finished now.
Date |Tue, 14 Aug 2001 14:56:02 +0200
From |Irene Vatton Irene.Vatton@inrialpes.fr
Hello!
IV Hi Peter,
IV The support of international characters in Amaya is quite complex.
IV Of course we could switch to ISO-8859-2 charset to support another
IV subset of European languages, but the right general solution is to
IV handle Unicode characters.
IV This implies 3 steps:
IV 1- Replacing the handling of 8 bits characters by Unicode functions.
IV Due to external constraints, sometimes Unicode characters must be
IV encoded as UTF-8 strings, sometimes they must be encoded as
IV wide-characters.
IV So the adaptation of the code is not easy and adequate conversion
IV functions must be developed.
IV 2- We need also to write displaying functions that'll find for each
IV character the right font and the right glyph within the font.
IV Theses functions depends on the platform (Windows or X-Windows).
IV 3- Then several input methods should be added to the Amaya code.
IV Just the step 1 is quite finished now.
I'm sorry but why you want to invent bicycle ?
I mean step 3.
This locale patch (i already send absolutely idenical patch half year ago)
made you work quite simple.
after set_locale(LC_ALL,"") call on all unix platforms you can
get full unicode input. Windows as far as i know support
unicode input too.
So i say: insert of set_locale call resolve all troubles
with nonlatin1 input. At least on Linux, Irix and Solaris,
cause i check it.
I like amaya. You make great product.
But i need to add this setlocale call after
each download of fresh sources. It's annoyed me.
For technical support contracts, visit https://order.mysql.com/
This email is sponsored by SWSoft, http://www.asplinux.ru/
/ |/ /_ __/ __/ __ \/ / Grigory Bakunov black@asplinux.ru
/ /|_/ / // /\ \/ /_/ / /__ MySQL AB / SWSoft
___/ www.mysql.com
Of course we don't plan to re-invent bicycle. We want to use
existing input methods and existing conversion algorithms when
it's possible. I just tried to explain that the problem is more
complex.
Date |Tue, 14 Aug 2001 16:03:59 +0200
From |Irene Vatton Irene.Vatton@inrialpes.fr
Hello!
IV Of course we don't plan to re-invent bicycle. We want to use
IV existing input methods and existing conversion algorithms when
IV it's possible. I just tried to explain that the problem is more
IV complex.
Ok but why you don't include this patch ?
It's realy clean solution of all localization troubles.
At least in this stage.
For technical support contracts, visit https://order.mysql.com/
This email is sponsored by SWSoft, http://www.asplinux.ru/
/ |/ /_ __/ __/ __ \/ / Grigory Bakunov black@asplinux.ru
/ /|_/ / // /\ \/ /_/ / /__ MySQL AB / SWSoft
___/ www.mysql.com
The patch is included in the module thotlib/dialogue/interface.c
Date |Fri, 17 Aug 2001 08:30:57 +0200
From |Irene Vatton Irene.Vatton@inrialpes.fr
Hello!
IV The patch is included in the module thotlib/dialogue/interface.c
Hurray!
Now you do realy great browser and editor !
Realy thanks!
For technical support contracts, visit https://order.mysql.com/
This email is sponsored by SWSoft, http://www.asplinux.ru/
/ |/ /_ __/ __/ __ \/ / Grigory Bakunov black@asplinux.ru
/ /|_/ / // /\ \/ /_/ / /__ MySQL AB / SWSoft
___/ www.mysql.com
