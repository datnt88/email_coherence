The DOM model constructed by JTidy for HTML seems to be erroneous. When
JTidy parses HTML it produces a DOM for the HTML. When attempting to
traverse this model, I have found that it does not get the structure
correct. For example, given the following code from Netcenter:
http-equiv=Content-Type !--REPLACE_START_QWEST5-- !--REPLACE_END_QWEST5--
SCRIPT language=JavaScript type=text/javascript !--
if (parseFloat(navigator.appVersion)
3){document.write(' FRAMESET ');location.href="http://home.netscape.com/comp
uting/download/upgrade_index.html";}
else if
((parseFloat(navigator.appVersion) =5)&amp;&amp;((navigator.appName=="Netscape")||(n
avigator.appName=="Mozilla"))){location.href="http://home.netscape.com/index
1.html";}// -- /SCRIPT
When getting the parent of the SCRIPT ... tag here (via the org.w3c.dom
package included with JTidy), JTidy returns:
as its parent, where the HEAD tag should be returned as its parent. This
appears to be an error in JTidy. Response/suggestions/reprimands are
welcome.
Thanks,
Scott
Scott --
The JTidy DOM model is a somewhat thin veneer on the node structure
created by Tidy. If you look at the META tag, it doesn't have a close
tag ( /META or META / ), so Tidy parses the next tag ( SCRIPT ) as the
child of the META tag.
This node model seems to work for Tidy's purposes although it does seem
misleading when trying to access it using JTidy's DOM model. As a
workaround, I just write out the JTidy output as XHTML and then read it
back in to a real DOM parser.
Gary
If this is the situation, how is Tidy able to deal with other "singleton"
tags, such as IMG... ?
Perhaps I'm unclear on the Tidy's purposes, I had gotten the idea from the
documentation
that it was supposed to create a valid DOM structure from an HTML document
and
allow you traverse it.
This was my first thought, however there are a couple of problems for what
I'm working on:
1.) It takes a good deal of processing time to parse once to get an XHTML
doc, then pass it through an XML parser (I use Sun's ProjectX - jaxp), and
finally to pass it through an XSLT parser/transformation (jclark's XT in my
case).
2.) I have also run into issues where XML parsers (XT and ProjectX-jaxp)
have not been able to deal with entities like '?' returned by Tidy'.
