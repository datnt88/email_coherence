Hello,
I tried to build amaya on Aix 4.2 using gcc and linking to Motif (not only I
like it more, but I am not able in any way to compile gtk 1.x on Aix...).
I did configure and use gnu-make
The build gives the following erros (apart some redefinitions):
../../thotlib/base/fileaccess.c: In function `readFloat':
../../thotlib/base/fileaccess.c:307: structure has no member named
`negative'
../../thotlib/base/fileaccess.c:308: structure has no member named
`exponent'
../../thotlib/base/fileaccess.c:309: structure has no member named
`mantissa'
../../thotlib/base/fileaccess.c:309: structure has no member named
`exponent'
further on:
/bin/sh: /usr/local/build/Amaya/rs6k/annotlib/../bin/str: not found
gmake[1]: *** [Annot.STR] Error 127
but it may be caused by the first error...
I see that aix 4.1 should be supported but no binaries are provided. Any
suggestions? Do you need further information?
thanks,
Riccardo
On Sat, 11 Oct 2003 19:16:21 +0200
I suggest that change in the file Amaya/thotlib/base/fileaccess.c:
#if __BYTE_ORDER == __BIG_ENDIAN
unsigned int negative:1;
unsigned int exponent:8;
unsigned int mantissa:23;
- #endif
- #if __BYTE_ORDER == __LITTLE_ENDIAN
+ #else
unsigned int mantissa:23;
unsigned int exponent:8;
unsigned int negative:1;
#endif
#if defined(_BIG_ENDIAN)
unsigned int negative:1;
unsigned int exponent:8;
unsigned int mantissa:23;
- #endif
- #if defined(_LITTLE_ENDIAN)
+ #else
unsigned int mantissa:23;
unsigned int exponent:8;
unsigned int negative:1;
#endif
Irene.
Ir?ne Vatton INRIA Rh?ne-Alpes
INRIA ZIRST
e-mail: Irene.Vatton@inria.fr 655 avenue de l'Europe
Ok, that made good progress, thanks. Now the build stops further on.
(There are many, many redefinitions)
gmake[1]: Entering directory `/usr/local/build/Amaya/r6k/thotlib'
gcc -O2 -W -D_I18N_ -DHAVE_CONFIG_H -I.. -I../../amaya/xpm
-I../../tablelib/f -I../../thotlib/include -I../../thotlib/internals/var
-I../../thotlib/internals/h -I../../thotlib/internals/f -I../../libjpeg
-I/usr/include/Motif1.2 -c ../../thotlib/unicode/ustring.c -o
unicode/ustring.o In file included from ../../thotlib/unicode/ustring.c:15:
../../thotlib/include/thot_sys.h:33: warning: `M_PI' redefined
/usr/local/lib/gcc-lib/rs6000-ibm-aix4.2.1.0/2.95.3/include/math.h:234:
warning:
this is the location of the previous definition
../../thotlib/include/thot_sys.h:34: warning: `M_PI_2' redefined
/usr/local/lib/gcc-lib/rs6000-ibm-aix4.2.1.0/2.95.3/include/math.h:235:
warning: this is the location of the previous definition
../../thotlib/unicode/ustring.c:114: conflicting types for `wcstok'
/usr/include/wchar.h:155: previous declaration of `wcstok'
gmake[1]: *** [unicode/ustring.o] Error 1
Greetings,
Riccardo
On Mon, 13 Oct 2003 21:04:08 +0200
Could you test that change in Amaya/thotlib/include/thot_sys.h
+ #ifndef M_PI
#define M_PI 3.14159265358979323846 /* pi */
#define M_PI_2 1.57079632679489661923 /* pi/2 */
+ #endif
Irene.
Ir?ne Vatton INRIA Rh?ne-Alpes
INRIA ZIRST
e-mail: Irene.Vatton@inria.fr 655 avenue de l'Europe
Hello Irene,
good work, this work solved many of the warnings.
there remains one that is fatal though:
I../../thotlib/include -I../../thotlib/internals/var
-I../../thotlib/internals/h -I../../thotlib/internals/f -I../../libjpeg
-I/usr/include/Motif1.2 -c ../../thotlib/unicode/ustring.c -o
unicode/ustring.o
../../thotlib/unicode/ustring.c:114: conflicting types for `wcstok'
/usr/include/wchar.h:155: previous declaration of `wcstok'
gmake[1]: *** [unicode/ustring.o] Error 1
This is the declaration I have in the header:
extern wchar_t *wcstok(wchar_t *, const wchar_t *);
-Riccardo
On Thu, 16 Oct 2003 10:59:51 +0200
On current Unix systems there is an include /usr/include/wchar.h
If not present could you look for this file within /usr/lib/gcc-lib/
Irene.
Ir?ne Vatton INRIA Rh?ne-Alpes
INRIA ZIRST
e-mail: Irene.Vatton@inria.fr 655 avenue de l'Europe
