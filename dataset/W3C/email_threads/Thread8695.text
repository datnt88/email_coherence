Hi all!
I think there is a contradiction between the textual description of
section 4.4.4 and the corresponding Schema and DTD definitions:
The text (and the provided example) permit multiple declarations inside
a single X509Data Element, such as X509IssuerSerial and X509SKI. But as
you can see in the following Schema and DTD definitions, such multiple
declarations are not possible:
I
--------------------------------------------I
element name='X509SKI' type='string'/ !-- should this be
binary? --
element name='X509Certificate' type='ds:CryptoBinary'
minOccurs='0' maxOccurs='unbounded'/
element name='X509CRL' type='ds:CryptoBinary' minOccurs='0'
maxOccurs='unbounded'/
!ELEMENT X509Data ((X509IssuerSerial | X509SKI | X509SubjectName),
I I
-----------------------I--------------------------------------------I
X509Certificate*, X509CRL*)
Regards, Gregor
Gregor Karlinger
Phone +43 316 873 5541
Institute for Applied Information Processing and Communications
Austria
Ah... this is the tricky bit that I might've goofed up from Brian when I
translated that section's clarifications into the new schema syntax.
Doesn't the choice/ above it permit it?
Oh, and below you quoted some text that included a comment from me. Was
X509SKI supposed to be string or binary?
Joseph Reagle Jr.
W3C Policy Analyst mailto:reagle@w3.org
IETF/W3C XML-Signature Co-Chair http://www.w3.org/People/Reagle/
The ASN.1 structure for the SKI X509 certificate extension is the following:
SubjectKeyIdentifier ::= KeyIdentifier
KeyIdentifier ::= OCTET STRING
Therefore I suggest to let X509SKI be of type "ds:CryptoBinary".
Regards, Gregor
Gregor Karlinger
Phone +43 316 873 5541
Institute for Applied Information Processing and Communications
Austria
Gregor is correct, the X509Data schema is incorrect as it currently stands
(Joseph, looks like you swapped the upper bounds on the first choice w/ the
sequence). I believe this is the correct schema:
choice minOccurs='1' maxOccurs='1' ***
changed
sequence minOccurs='1' maxOccurs='unbounded' ***
changed
element name='X509SKI' type='string'/ !-- should this be
binary? --
element name='X509Certificate' type='ds:CryptoBinary'
minOccurs='1' maxOccurs='1'/ **changed
element name='X509CRL' type='ds:CryptoBinary' minOccurs='1'
maxOccurs='1'/ **changed
The maxOccurs of the first choice should be 1, not unbounded, and the
maxOccurs of the sequence should be unbounded, not 1. Also, the "zero or
more" qualifiers for X509Certificate and X509CRL became "exactly one". This
change means that an individual X509Data clause may be one of:
a) a collection of X509IssuerSerial, X509SKI and X509SubjectName elements,
b) exactly one X509Certificate element, or
c) exactly one X509CRL
Given this schema, I believe the declaration in the immediately preceeding
paragraph in the draft is now correct:
Multiple declarations about a single certificate (e.g., a X509SubjectName
and X509IssuerSerial element) MUST be grouped inside a single X509Data
element;
[this is covered by the sequence of choice of... --bal]
multiple declarations about the same key but different certificates (related
to that single key) MUST be grouped within a single KeyInfo element but
multiple X509Data elements.
[this is covered by the outer choice --bal]
For example, the following block contains two pointers to certificate-A
(issuer/serial number &amp; SKI) and a single reference to certificate-B
(Subject Name):
I believe this paragraph and the scheme correctly capture the desire of the
working group as expressed in Victoria. I would point out that there's one
unfortuate side-effect of this syntax, which is that expressing a cert chain
gets a little more verbose than it needs to be. A three-cert chain will
look like this:
Base64 data for cert 1
Base64 data for cert 2
Base64 data for cert 3
So you end up with two levels of tags for each cert.
I agree with making SKI a ds:CryptoBinary; it's just a OCTET STRING.
--bal
Ah... this is the tricky bit that I might've goofed up from Brian when I
translated that section's clarifications into the new schema syntax.
Doesn't the choice/ above it permit it?
Oh, and below you quoted some text that included a comment from me. Was
X509SKI supposed to be string or binary?
Joseph Reagle Jr.
W3C Policy Analyst mailto:reagle@w3.org
IETF/W3C XML-Signature Co-Chair http://www.w3.org/People/Reagle/
