Here is a proposed version of the DOM TS Process Document with the new
Grant Of License:
If you have any issue with it, please let us (Daniel and I) know.
Philippe
Hi all,
I have been having a look at the dom test suite, and after checking out
2001/ from dev.w3.org I found that I couldn't build anything in the
DOM-Test-Suite apart from the dom*-schema option.
My setup and some of the error messages for the various build optons I have
tried are as follows:
jdk1.3.1_02
ant 1.4
xalan-j 2.3.1
redhat 7.1
Although the *core-gen-* options complained that it cannot load requested
documents, the corresponding xml files are all present in
tests/level*/core/tests.
Any help would be appreciated.
Min
-- ant dom1-core-validate-tests --
Buildfile: build.xml
init:
dom1-core-validate-tests:
[xmlvalidate]
/cache/min/cvs/w3c/2001/DOM-Test-Suite/tests/level1/core/metadata.xml:14:65:
Attribute "xmlns" must be declared for element type "metadata".
BUILD FAILED
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build.xml:736:
/cache/min/cvs/w3c/2001/DOM-Test-Suite/tests/level1/core/metadata.xml is not
a valid XML document.
Total time: 24 seconds
--ant dom2-core-validate-tests --
Buildfile: build.xml
init:
dom2-core-validate-tests:
BUILD FAILED
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build.xml:968: Could'nt validate
document
/cache/min/cvs/w3c/2001/DOM-Test-Suite/tests/level2/core/alltests.xml
Total time: 2 seconds
-- ant dom1-core-gen-jsunit --
Buildfile: build.xml
init:
jsunit-get:
[get] Getting: http://www.edwardh.com/jsunit/jsunit.zip
jsunit-init:
[unzip] Expanding: /cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit.zip
into /cache/min/cvs/w3c/2001/DOM-Test-Suite/lib
[patch] patching file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit/app/main.html
[patch] Hunk #1 FAILED at 46.
[patch] Hunk #2 FAILED at 274.
[patch] Hunk #3 FAILED at 280.
[patch] 3 out of 3 hunks FAILED -- saving rejects to file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit/app/main.html.rej
[patch] patching file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit/app/jsUnitRunner.js
[patch] Reversed (or previously applied) patch detected! Assume -R? [n]
[patch] Apply anyway? [n]
[patch] Skipping patch.
[patch] 3 out of 3 hunks ignored -- saving rejects to file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit/app/jsUnitRunner.js.rej
[patch] patching file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/jsunit/app/jsUnitCore.js
dom1-check-spec:
get-dom1:
dom1-init:
[unzip] Expanding:
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/DOM.zip into
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1
[unzip] Expanding:
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1/xml-source.zip into
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1
[patch] patching file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1/xml/wd-dom.xml
[patch] patching file
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1/xml/definitions/lev
el-one-core/element.xml
dom1-interfaces:
[style] Processing
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1/xml/wd-dom.xml to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/dom1-interfaces.xml
[style] Loading stylesheet
/cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/extract.xsl
dom1-dtd:
[style] Processing
/cache/min/cvs/w3c/2001/DOM-Test-Suite/lib/specs/Level-1/xml/wd-dom.xml to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/dom1.dtd
[style] Loading stylesheet
/cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/dom-to-dtd.xsl
[copy] Copying 1 file to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/tests/level1/core
[copy] Copying 1 file to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/tests/level1/html
dom1-core-gen-jsunit:
[mkdir] Created dir:
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[copy] Copying 1 file to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[copy] Copying 8 files to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[copy] Copying 1 file to
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[style] Transforming into
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[style] Transforming into
/cache/min/cvs/w3c/2001/DOM-Test-Suite/build/level1/core/ecmascript/tests
[style] Loading stylesheet
/cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-jsunit.xsl
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc: elementnormalize.xml
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc:
elementremoveattribute.xml
BUILD FAILED
java.lang.OutOfMemoryError
-- ant dom1-core-gen-ecmascript --
last few lines only, I terminated the process since it wasn't going anywhere
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc:
nodenotationnodetype.xml
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc:
nodenotationnodevalue.xml
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc: nodeparentnode.xml
[style]
file:////cache/min/cvs/w3c/2001/DOM-Test-Suite/transforms/test-to-ecmascript
.xsl; Line 240; Column 60; Can not load requested doc:
nodeparentnodenull.xml
Hi,
I also get the exactly similar error! My config is:
jdk1.3.1
ant 1.4.1
xalan-j 2.3.1_01
xerces-2_0_1
Any help would be appreciated!
-vivek.
On Thu, 16 May 2002 10:16:56 -0700
I think this is a problem with Ant's XSLT Task. Someone is not closing
file descriptors explicitly and resources pressure pushes the problem to
the point where more files cannot be opened. Someone needs to get on that
mailing list and look at that source but I'm just not up to it right now.
Mike
May The Source be with you.
The DOM test suite code generation is a stress test for XSLT procecessors.
I don't think we were able to use Xerces-J 2.3 to build dom-ts, but had to
use 2.2. I've also had success with SAXON 6.5, but others have had
problems.
On Thu, 16 May 2002 14:51:33 -0600
I think this is a problem with Ant's XSLT Task. Someone is not closing
file descriptors explicitly and resource pressure pushes the problem to
the point where more files cannot be opened.
Mike
May The Source be with you.
umm.... XSLT processor found wanting could explain the java.lang out of
memory errors, but most of the errors I have got, about invalid xml files
(metadata.xml and alltests.xml etc.) or could not load requested docs, are
still there after changing to xerces-j 2.2.
Min
On Fri, 17 May 2002 09:31:30 -0600
Thanks for the analysis. I'll take a look at the Ant source and see if I
see anything obvious. The timing would be good as Ant is on a beta cycle to
a 1.5 release.
First, sorry for the duplicate message. I *thought* I sent this mail
message but I didn't see it after almost a day. I think my ISP is
having issues.
Regarding this problem, I don't have any hard evidence that it's Ant
but when I ran into this problem I built each domts case independently
with a simple shell script for j in loop. It took 15 minutes but it
worked. So there's nothing particularly twisted about any one xml
test case. It's just when Ant is brought into the fray that there
are problems. At the very least there would probably be a way to free
resources more agressively. The Ant task could totally reinitialize
the XSLT processor at every opportunity. If that worked without seeing
anything obviously wrong with that task that's pretty good evidence to
take to the Xalan people.
Mike
May The Source be with you.
My experience with the DOM TS and Xalan:
I used xalan-j_2_2_D11 last time I built, all other version of Xalan
gave me problems. However, this version does not seem to be available
(http://xml.apache.org/dist/xalan-j/old/).
/Dimitris
Thanks for the analysis. I'll take a look at the Ant source and see
if I
see anything obvious. The timing would be good as Ant is on a beta
cycle to
a 1.5 release.
