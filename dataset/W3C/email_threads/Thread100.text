Hi all,
I using Tidy COM to convert my HTML to XML and then use MSXML.
The problem I'm getting is that even though I set the doctype to omit,
I still get the doctype outputted by Tidy. I also seem to get a HTML DOCTYPE
even though the output is XML which in my eyes would mean an XML DOCTYPE.
As a result MSXML doesn't like this DOCTYPE and coughs up an error.
Is there any way for the DOCTYPE to be omitted, or is there a workaround ?
Below is my code:
Set TidyObj = CreateObject("TidyCOM.TidyObject")
TidyObj.Options.doctype = "omit"
TidyObj.Options.NumericEntities = True
TidyObj.Options.TidyMark = False
TidyObj.Options.UppercaseTags = True
TidyObj.Options.OutputXml = True
strHTML = TidyObj.TidyToMem(strHTML)
' XML is loaded here
docXML.loadXML (strHTML)
If docXML.parseError.errorCode  0 Then
Here is my error:
The public ID "-\\W3C\\DTD HTML 4.0 Transitional\\EN" is invalid.
Anyone have any suggestions ?
Ciaran
Ciaran,
The proper public IDs for XHTML (the XML implementation of HTML) are:
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"DTD/xhtml1-strict.dtd"
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"DTD/xhtml1-transitional.dtd"
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
"DTD/xhtml1-frameset.dtd"
Case is important.
I cut and paste these directly from the W3C site at
Ken
DOCTYPE
Those are actually incorrect. Yes, I know that's what it says in the
Recommendation, but it's a misprint. It *should* be corrected soon, or so I've
heard. The only ways those would work with a validating XML parser is if you
have a subdirectory of your current directory called "DTD". The real
declarations should read:
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"
!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"
/Jelks
The DOCTYPES work fine, but what if I want to omit them
totally, so that they aren't in the document loaded
in the XML validation process ??
Ciaran Byrne
Software Engineer
