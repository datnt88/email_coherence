<s> I report on preliminary interoperation testing between the Python DAV client and the Xythos server (at 216.102.212.251, port 80, using base collection /~webdav/) So far as I know, Xythos is the only other WebDAV server that supports locking on collections (MS supports locking, but not on collections.  </s>
<s> I am unsure about the IBM implementation, someone should set me straight.)  </s>
<s> I tested OPTIONS, PUT, GET, HEAD, PROPFIND, PROPPATCH, MKCOL, DELETE, LOCK, and UNLOCK, including some combinations.  </s>
<s> I find the following problems: 1.  </s>
<s> The reply from server (to a PROPFIND) has neither a content-length nor  </s>
<s> does it use chunked encoding.  </s>
<s> I believe this is a violation of HTTP/1.1 rules.  </s>
<s> PROPFIND /~webdav HTTP/1.1 Host: 216.102.212.251  </s>
<s> HTTP/1.1 207 Multi-Status Server: JavaWebServer/2.0 Vary: Accept-Encoding Connection: close Date: Mon, 12 Jul 1999 16:49:20 GMT  </s>
<s> (seems like the server just closes the connection each time.  </s>
<s> Is this allowed?  </s>
<s> It's certainly not efficient.  </s>
<s> But anyway on the assumption that it is legal, I modified my test code to work with this, so I could test more features)  </s>
<s> 2) the server does not seem to be preserving the xml:lang attribute 3) dead properties are preserved across deletion of a resource.  </s>
<s> That is, I PROPPATCH foo, delete it, then PUT foo again, and the property I set the first time is still there 4) PROPPATCH changes a property even if the resource is locked.  </s>
<s> I could set and delete properties on the other hand, I could not *delete* a property when I did pass a token 5) PUT could not create resource in a locked collection even with token 6) attempt to create collection /~webdav/newcoll/ when parent was locked got code 405 (NotAllowed).  </s>
<s> shouldn't this be 409 (conflict) instead?  </s>
<s> 7) Deleted resource /~webdav/foo.html  </s>
<s> when parent was locked (without passing token)  </s>
<s> 8) attempt to lock a non-existant resource gets NotFound I was not able to test operation of locked resources within locked collections because of these bugs.  </s>
<s> When they are corrected, I'll try again.  </s>
<s> I congratulate the Xythos team on a good (though not yet perfect) server.  </s>
<s> Jim  </s>
<s> DAV4J is a complete DAV class 2 server and does support locking on collections.  </s>
<s> It is allowed, but prevents the client from knowing whether they obtained the complete response or were just cut off.  </s>
<s> In other words, it is legitimate in HTTP/1.1, but never a good design  </s>
<s> choice when chunked is an alternative.  </s>
<s> ....Roy  </s>
<s> The WebDAV spec explicitly addresses this point.  </s>
<s> The reason being that you  </s>
<s> might want to lock something before creating it so you can control all the  </s>
<s> details of it.  </s>
<s> otherwise there is a race condition: you create FOO, someone else locks FOO before you can issue the lock.  </s>
<s> Does this make sense?  </s>
<s> See spec section 7.4 for more details  </s>
<s> Jim, thanks again for testing the server.  </s>
<s> I will be making all of the changes necessary in the next few days.  </s>
<s> - 2) the server does not seem to be preserving the xml:lang attribute  </s>
<s> I need to add that support.  </s>
<s> Not sure how I want to handle this, do I need to stripe property by lang.  </s>
<s> This means that someone could set the same property to two different values as long as the lang was set differently???  </s>
<s> that's not how I understand it.  </s>
<s> If you're not clear, better post a question to the webdav list asking for clarification, as others may also be unclear.  </s>
<s> I talked to Jim Whitehead on this.  </s>
<s> He told me that I must keep the xml:lang attribute, but it is not intended to stripe the property.  </s>
<s> In other words a propatch of then propatch Will result in only ONE value for K:foo .  </s>
<s> The second value REPLACES the first even though it is a different lang.  </s>
<s> I think this is different than what you are telling me.  </s>
<s> While I am at it.  </s>
<s> Is the server required to keep ALL attributes sent to it???  </s>
<s> Thanks, Kevin  </s>
<s> What Jim W said is the same as what I believe.  </s>
<s> Sorry if I did not explain it well.  </s>
<s> Required? No, at least not at present.  </s>
<s> You'll note that the protocol document is mute on the point.  </s>
<s> SInce it says nothing, there's no requirement.  </s>
<s> Some have stated that it *should* be required, but the list has never reached concensus on the point.  </s>
<s> There are arguments both ways.  </s>
<s> I won't repeat them in full, but in brief they are: NO: The data model for WebDAV properties is a tree, where the leaf nodes are string values, and the interior nodes have a label, BUT NO OTHER STATE, except for the xml:lang attribute (and perhaps one or two other attributes required by XML).  </s>
<s> WebDAV uses XML as an on the wire format, but the data model is not XML.  </s>
<s> An additional argument against is the possible cost of storing attributes.  </s>
<s> YES: Since WebDAV uses XML, and since XML uses attributes, users will expect it, so it should be required.  </s>
<s> The list has never reached concensus on this point, and, as I recall, it has not even been able to agree to place an explicit statement on the non-agreement in the protocol document.  </s>
<s> So the protocol is simply silent on the point.  </s>
