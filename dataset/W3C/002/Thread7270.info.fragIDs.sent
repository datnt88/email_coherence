<s> Based on the comments I have received, I have modified "Requirements on HTTP for Distributed Content Editing."  </s>
<s> At the bottom of this message, please find draft v0.2 of this document.  </s>
<s> Major changes from v0.1: o Addition of new sections: - Status of this Memo - Acknowledgements - References - Author's Address o Removed sections: - Abstract o New Requirements: - Read Locks - Lock Query - Partial Write o Addition of new rationale text for requirements: - Source Retrieval - Locks - List URL Hierarchy level I appreciate any comments you may have on this draft.  </s>
<s> In particular, it would be very helpful to know if I have omitted any requirements.  </s>
<s> Also, if you feel you have made a contribution towards this draft, but are not listed in my acknowledgements section, please assume that you have been accidentally omitted, and let me know.  </s>
<s> It is my intent to submit this as an official Internet Draft either later this week or early next week, so it may be considered by the HTTP Working Group.  </s>
<s> - Jim  </s>
<s> HTTP Working Group E. J. Whitehead, Jr. INTERNET-DRAFT U.C. Irvine draft-ietf-http-distreq-00.txt September 1996 Expires March, 1996 Rev. 0.2, September 3, 1996 Requirements on HTTP for Distributed Content Editing Status of this Memo This document is an Internet draft.  </s>
<s> Internet drafts are working documents of the Internet Engineering Task Force (IETF), its areas and its working groups.  </s>
<s> Note that other groups may also distribute working information as Internet drafts.  </s>
<s> Internet Drafts are draft documents valid for a maximum of six months and can be updated, replaced or obsoleted by other documents at any time.  </s>
<s> It is inappropriate to use Internet drafts as reference material or to cite them as other than as "work in progress".  </s>
<s> To learn the current status of any Internet draft please check the "lid-abstracts.txt"  </s>
<s> listing contained in the Internet drafts shadow directories on ftp.is.co.za (Africa), nic.nordu.net  </s>
<s> (Europe), munnari.oz.au (Pacific Rim), ds.internic.net  </s>
<s> (US East coast) or ftp.isi.edu (US West coast).  </s>
<s> Further information about the IETF can be found at URL: Distribution of this document is unlimited.  </s>
<s> Please send comments to the HTTP working group at http-wg@cuckoo.hpl.hp.com .  </s>
<s> Discussions of the working group are archived at URL:http://www.ics.uci.edu/pub/ietf/http/ .  </s>
<s> General discussions about HTTP and the applications which use HTTP should take place on the www- talk@w3.org  </s>
<s> mailing list.  </s>
<s> 1. Introduction This document describes functionality which, if provided in the HyperText Transfer Protocol (HTTP) [4], would support the interoperability of tools which allow remote loading, editing and saving (publishing) of various media types using HTTP.  </s>
<s> As much as possible, this functionality is described without suggesting a proposed implementation, since there are many ways to perform the functionality within the HTTP framework.  </s>
<s> It is also possible that a single mechanism within HTTP could simultaneously satisfy several requirements.  </s>
<s> Much of the functionality described in this document stems from the assumption that people performing distributed authoring only have access to the objects they are editing via the HTTP protocol.  </s>
<s> This is in contrast to the majority of current authoring practice, where there is access to the underlying storage media, often with a shell or graphical user interface mediating access to a filesystem.  </s>
<s> Authors need more than just remote control over their individual documents: they need remote control over the namespace in which those documents reside.  </s>
<s> Currently, authors control their namespace by interacting directly with the underlying storage system, but when performing distributed authoring this access is not available.  </s>
<s> 2. Requirements In the requirement descriptions below, the requirement will be stated, followed by its rationale.  </s>
<s> If any current distributed authoring tools currently implement the requirement, this is also mentioned.  </s>
<s> It is assumed that "server" means "a program which receives and responds to HTTP requests," and that "distributed authoring tool" or "intranet enabled tool" means "a program which can retrieve a source entity via HTTP, allow editing of this entity, and then save/publish this entity to a server using HTTP."  </s>
<s> A "client" is "a program which issues HTTP requests and accepts responses."  </s>
<s> 1. Source Retrieval.  </s>
<s> The source of any given entity should be retrievable via HTTP.  </s>
<s> There are many cases where the source entity stored on a server does not correspond to the actual entity transmitted in response to an HTTP GET.  </s>
<s> Current known cases are server side include directives, and Standard Generalized Markup Language (SGML) source entities which are converted on the fly to HyperText Markup Language (HTML) [2] output entities.  </s>
<s> There are many possible cases, such as automatic conversion of bitmap images into several variant bitmap media types (e.g. GIF, JPEG), and automatic conversion of an application's native media type into HTML.  </s>
<s> As an example of this last case, a word processor could store its native media type on a server which automatically converts it to HTML.  </s>
<s> A GET of this entity would retrieve the HTML.  </s>
<s> Retrieving the source of this entity would retrieve the word processor native entity.  </s>
<s> Ideally, this requirement will be satisfied by a general mechanism which can handle both the "single-step" source processing described above, where the source is converted into the transmission entity via a single conversion step, as well as "multi-step" source processing, where there are one or more intermediary processing steps and outputs.  </s>
<s> An example of multi-step source processing is the relationship between an executable binary image, its object files, and its source language files.  </s>
<s> It should be noted that the relationship between source and transmission entity could be expressed using the relationship functionality described below in "Relationships."  </s>
<s> 2. Relationships.  </s>
<s> Via HTTP, it should be possible to create, query, and delete typed relationships (links) between entities of any media type.  </s>
<s> Relationships (or links which are not necessarily navigable) between entities can be used for many purposes.  </s>
<s> Relationships can support pushbutton printing of a multi-resource document in a prescribed order, jumping to the access control page for an entity, and quick browsing of related information, such as a table of contents, an index, a glossary, help pages, etc. While relationship support is provided by the HTML "LINK" element, this is limited only to HTML entities, and does not support bitmap image types, and other non-HTML media types.  </s>
<s> Aolpress From America Online [1] currently "allows pages to add toolbar buttons on the fly using the HTML 3.2 LINK REL.... tag.  </s>
<s> For example, your page can add toolbar buttons that link to a home page, table of contents, index, glossary, copyright page, next page, previous page, help page, higher level page, or a bookmark in the document."  </s>
<s> 3. Write Locks.  </s>
<s> It should be possible, via HTTP, to restrict modification of an entity to a specific person, or list of persons.  </s>
<s> 4. Read Locks.  </s>
<s> It should be possible, via HTTP, to indicate to the HTTP server that the contents of an entity should not be modified.  </s>
<s> 5. Lock Query.  </s>
<s> It should be possible to query for whether a given URL has any active modification restrictions, and if so, who currently has modification permission.  </s>
<s> 6. Independence of locks.  </s>
<s> It should be possible to lock an entity without re-reading the entity, and without committing to editing an entity.  </s>
<s> At present, HTTP provides limited support for preventing two or more people from overwriting each other's modifications when they save to a given URL.  </s>
<s> Furthermore, there is no way for people to discover if someone else is currently making modifications to an entity.  </s>
<s> This is known as the "lost update problem," or the "overwrite problem."  </s>
<s> Since there can be significant cost associated with discovering and repairing lost modifications, preventing this problem is crucial for supporting distributed authoring.  </s>
<s> A "write" lock ensures that only one person (or list of persons) may modify an entity, preventing overwrites.  </s>
<s> Furthermore, locking support is also a key component of many versioning schemes, a desirable capability for distributed authoring.  </s>
<s> An author may wish to lock an entire web of entities even though they are editing just a single entity, to keep the other entities from changing.  </s>
<s> In this way, an author can ensure that if a local hypertext web is consistent in their distributed authoring tool, it will then be consistent when they write it to the server.  </s>
<s> Because of this, it should be possible to take out a lock without also causing transmission of the contents of an entity.  </s>
<s> Since it should not be assumed that because an entity is locked, that it will necessarily be modified, and since many people may wish to have simultaneous guarantees that an entity will not be modified, but still not want to modify the entity themselves, it is desirable to have a "read" lock capability.  </s>
<s> A read lock, by being less restrictive, provides better support than a write lock for providing a guarantee that an entity will not be modified.  </s>
<s> 7. Notification of Intention to Edit.  </s>
<s> It should be possible to notify the HTTP server that an entity is about to be edited by a given person.  </s>
<s> It should be possible to query the HTTP server for the list of people who have notified the server of their intent to edit an entity.  </s>
<s> Experience from configuration management systems has shown that people need to know when they are about to enter a parallel editing situation.  </s>
<s> Once notified, they either decide not to edit in parallel with the other authors, or they use out-of-band communication (face-to-face, telephone, etc.) to coordinate their editing to minimize the difficulty of merging their results.  </s>
<s> Notification is separate from locking, since a write lock does not necessarily imply an entity will be edited, and a notification of intention to edit does not carry with it any access restrictions.  </s>
<s> This capability is supportive of versioning, since a check-out is typically involves taking out a write lock, making a notification of intention to edit, and getting the entity to be edited.  </s>
<s> 8. Partial Write.  </s>
<s> After editing an entity, it should be possible, via HTTP, to only write the changes to an entity, rather than retransmitting the entire entity.  </s>
<s> During distributed editing which occurs over wide geographic separations and/or over low bandwidth connections, it would be extremely inefficient (and frustrating) to rewrite a large entity after minor changes, such as a one-character spelling correction.  </s>
<s> Ideally, support will be provided for transmitting "insert" (e.g., add this sentence in the middle of a document) and "delete" (e.g. remove this paragraph from the middle of a document) style updates.  </s>
<s> Support for partial entity updates will make small edits more efficient, and allow distributed authoring tools to scale up for editing of large documents.  </s>
<s> 9. Attributes.  </s>
<s> Via HTTP, it should be possible to create, query, and delete arbitrary attributes on entities of any media type.  </s>
<s> Attributes can be used to define fields such as author, title, subject, and organization, on resources of any media type.  </s>
<s> These attributes have many uses, such as supporting searches on attribute contents, and the creation of catalog entries as a placeholder for an entity which is not available in electronic form, or which will be available later.  </s>
<s> 10.  </s>
<s> List URL Hierarchy Level.  </s>
<s> A listing of all entities, along with their media type, and last modified date, which are located at a specific URL [3] hierarchy level in an http URL scheme should be accessible via HTTP, so long as this operation is meaningful.  </s>
<s> In [3] it states that, "some URL schemes (such as the ftp, http, and file schemes) contain names that can be considered hierarchical."  </s>
<s> Especially for HTTP servers which directly map all or part of their URL name space into a filesystem, it is very useful to get a listing of all resources located at a particular hierarchy level.  </s>
<s> This functionality supports "Save As..." dialog boxes, which provide a listing of the entities at a current hierarchy level, and allow navigation through the hierarchy.  </s>
<s> It also supports the creation of graphical visualizations (typically as a network) of the hypertext structure among the entities at a hierarchy level, or set of levels.  </s>
<s> It also supports a tree visualization of the entities and their hierarchy levels.  </s>
<s> There are many instances where there is not a strong correlation between a URL hierarchy level and the notion of a container.  </s>
<s> One example is a server in which the URL hierarchy level maps to a computational process which performs some resolution on the name.  </s>
<s> In this case, the contents of the URL hierarchy level can vary depending on the input to the computation, and the number of entities accessible via the computation can be very large.  </s>
<s> It does not make sense to implement a directory feature for such a namespace.  </s>
<s> However, the utility of listing the contents of those URL hierarchy levels which do correspond to containers, such as the large number of HTTP servers which map their namespace to a filesystem, argue for the inclusion of this capability, despite not being meaningful in all cases.  </s>
<s> If listing the contents of a URL hierarchy level does not makes sense for a particular URL, then a "405 Method Not Allowed" status code could be issued.  </s>
<s> AOLpress from America Online currently supports "Save As..." dialog boxes, and graphical network visualization of a portion of a site's hypertext structure, which they term a "mini-web."  </s>
<s> FrontPage from Microsoft [5] also currently supports a graphical network visualization and additionally supports a tree visualization of a portion of a site's structure.  </s>
<s> 11.  </s>
<s> Make URL Hierarchy Level.  </s>
<s> Via HTTP, it should be possible to create a new URL hierarchy level in an http URL scheme.  </s>
<s> The ability to create containers to hold related entities supports management of a name space by packaging its members into small, related clusters.  </s>
<s> This utility of this capability is demonstrated by the broad implementation of directories in recent operating systems.  </s>
<s> The ability to create a URL hierarchy level also supports the creation of "Save As..." dialog boxes with "New Level/Folder/Directory" capability, common in many applications.  </s>
<s> AOLpress from America Online, currently supports this capability through their "Save As..." dialog box, and their custom MKDIR method.  </s>
<s> 12. Copy.  </s>
<s> Via HTTP, it should be possible to make a byte-for-byte duplicate of an entity without a client loading, then resaving the entity.  </s>
<s> This copy should leave an audit trail.  </s>
<s> There are many reasons why an entity might need to be duplicated, such as change of ownership, a precursor to major modifications, or to make a backup.  </s>
<s> In combination with delete functionality, copy can be used to implement rename and move capabilities, by performing a copy to a new name, and a delete of the old name.  </s>
<s> Due to network costs associated with loading and saving an entity, it is far preferable to have a server perform an entity copy than a client.  </s>
<s> If a copied entity records which entity it is a copy of, then it would be possible for a cache to avoid loading the copied entity if it already locally stores the original.  </s>
<s> 13. Rename.  </s>
<s> Via HTTP, it should be possible to change the URL of an entity without a client loading, then resaving the entity under a different name.  </s>
<s> It is often necessary to change the name of an entity, for example due to adoption of a new naming convention, or if a typing error was made entering the name originally.  </s>
<s> Due to network costs, it is undesirable to perform this operation by loading, then resaving the entity, followed by a delete of the old entity.  </s>
<s> Ideally an HTTP server should record the rename operation, and issue a "301 Moved Permanently" status code for requests on the old URL.  </s>
<s> Note that moving an entity is considered the same function as renaming an entity.  </s>
<s> 3. Acknowledgements My understanding of these issues has emerged as the result of much thoughtful discussion, email, and assistance by many people, who deserve recognition for their effort.  </s>
<s> Martin Cagan, Continuus Software, Marty_Cagan@continuus.com  </s>
<s> Dan Connolly, World Wide Web Consortium, connolly@w3.org  </s>
<s> David Durand, Boston University, dgd@cs.bu.edu Ron Fein, Microsoft, ronfe@microsoft.com  </s>
<s> David Fiander, Mortice Kern Systems, davidf@mks.com  </s>
<s> Roy Fielding, U.C. Irvine, fielding@ics.uci.edu  </s>
<s> Yaron Goland, Microsoft, yarong@microsoft.com  </s>
<s> Phill Hallam-Baker, MIT, hallam@ai.mit.edu  </s>
<s> Dennis Hamilton, Xerox PARC, hamilton@parc.xerox.com  </s>
<s> Andre van der Hoek, University of Colorado, Boulder, andre@bigtime.cs.colorado.edu  </s>
<s> Gail Kaiser, Columbia University, kaiser@cs.columbia.edu  </s>
<s> Rohit Khare, World Wide Web Consortium, khare@w3.org  </s>
<s> Dave Long, America Online, dave@sb.aol.com  </s>
<s> Henrik Frystyk Nielsen, World Wide Web Consortium, frystyk@w3.org  </s>
<s> Larry Masinter, Xerox PARC, masinter@parc.xerox.com  </s>
<s> Murray Maloney, SoftQuad, murray@sq.com  </s>
<s> Jim Miller, World Wide Web Consortium, jmiller@w3.org  </s>
<s> Andrew Schulert, Microsoft, andyschu@microsoft.com  </s>
<s> Christopher Seiwald, Perforce Software, seiwald@perforce.com  </s>
<s> Judith Slein, Xerox, slein@wrc.xeroc.com  </s>
<s> Richard Taylor, U.C. Irvine, taylor@ics.uci.edu  </s>
<s> Robert Thau, MIT, rst@ai.mit.edu  </s>
<s> Fabio Vitali, University of Bologna, Italy, fabio@dm.unibo.it 4. References [1] America Online, "AOL Web Tools -- AOLpress 1.2 Features."  </s>
<s> WWW page.  </s>
<s> [2] T. Berners-Lee, D. Connolly.  </s>
<s> "HyperText Markup Language Specification - 2.0." RFC 1866, MIT/LCS, November 1995.  </s>
<s> [3] T. Berners-Lee, L. Masinter, M. McCahill.  </s>
<s> "Uniform Resource Locators (URL)."  </s>
<s> RFC 1738, CERN, Xerox PARC, University of Minnesota, December 1994.  </s>
<s> [4] R. Fielding, J. Gettys, J. C. Mogul, H. Frystyk, and T. Berners-Lee.  </s>
<s> "Hypertext Transfer Protocol -- HTTP/1.1." RFC XXXX, U.C. Irvine, DEC, MIT/LCS, August 1996.  </s>
<s> [5] Microsoft.  </s>
<s> "Microsoft FrontPage for Windows Data Sheet."  </s>
<s> WWW page.  </s>
<s> Author's Address E. James Whitehead, Jr. Department of Information and Computer Science University of California Irvine, CA 92697-3425  </s>
<s> Jim, as usual, you have done an absolutely bang up job.  </s>
<s> [2.1]  </s>
<s> You may want to consider changing the first sentence to read "This requirement should be met by a general mechanism..."  </s>
<s> The mention of links confuses the paragraph.  </s>
<s> You start off by equating Links to relationships (which I think is proper but that is another story) and then go on to say that links may not be navigable, even though relationships must be.  </s>
<s> I understand you do not want to be seen as supporting any particular implementation type.  </s>
<s> I would suggest removing the references to links, I think the requirement stands on its own.  </s>
<s> We should specify that the entity placing a lock should be able to choose what type of lock they want (single or multiperson) and if multiperson, who should be on the list.  </s>
<s> O.K. I'm confused.  </s>
<s> What is the difference between a write lock and a read lock?  </s>
<s> I was brought up to believe that a write lock means only someone with a lock may write to the file and a read lock means only someone with a lock may even read the file.  </s>
<s> Do I need to change religions?  </s>
<s> In addition I think we need an explicit statement that locks must allow for multiple files under a single lock.  </s>
<s> Hence the user can always be sure that whenever they perform any action under the auspices of a multiple file lock, such as a GET or PUT, the action will either go through, meaning all files under the lock remain locked, or the action will be rejected with an error indicating that one or more files under a lock have been removed from that lock.  </s>
<s> In addition I think we need an explicit statement that locks can be placed on sections of entities rather than entire entities.  </s>
<s> This is critical if the shared file is a database or a multi-part file.  </s>
<s> Partial locks should also be supported under the multiple file lock regime.  </s>
<s> We should also note that performing a Copy followed by a Delete is also not preferable because it places an undue load on the server.  </s>
<s> Yaron Y. Goland, Microsoft, yarong@microsoft.com  </s>
<s> =)  </s>
<s> Yaron  </s>
<s> By (hypertext) link, I usually mean "that subset of relationships which are browsable using the hypertext point-and-click navigation user interface."  </s>
<s> This is not consistent with the meaning I use in the text above.  </s>
<s> I'll work more on the wording...  </s>
<s> An entity is *always* readable under HTTP, independent of what kind of lock (read, write, none) exists on it.  </s>
<s> A read lock only says that the entity is guaranteed not to change for the duration of the lock.  </s>
<s> A write lock says an entity is guaranteed not to change only if the owner of the lock does not change it, and only the owner of the write may change it.  </s>
<s> Perhaps the name "read" lock should be changed to something more meaningful.  </s>
<s> Such higher level locking actions can be implemented using single-entity locks, and hence I'd prefer not to introduce the added complexity of multiple entity simultaneous locks.  </s>
<s> - Jim  </s>
<s> If a user locks files A, B, &amp; C with separate locks and performs a PUT to A, there is no guarantee that the locks on B &amp; C have not been already been broken.  </s>
<s> Thus a mechanism is needed to perform actions on a group of files in such a way that each individual action is guaranteed to be atomic with respect to the lock on those files.  </s>
<s> Your own paper includes a perfect example of this - A user wishes to lock an entire web site so as to be able to guarantee global consistency even if they are only interested in changing a single file.  </s>
<s> If they have to lock every file individually, a bandwidth eating action I might add, they still have no guarantee of global consistency as one or more locks could be removed for any number of reasons.  </s>
<s> A multi-file lock will guarantee that an action will only go through if all the relevant files are still locked.  </s>
