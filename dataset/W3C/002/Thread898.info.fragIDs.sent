<s> I first sent this message to HTML-Kit maintainers.  </s>
<s> I was kindly told that the feature I wrote about is actually a Tidy feature.  </s>
<s> Please excuse me for describing the problem in HTML-Kit terms.  </s>
<s> I hope you can translate them into Tidy concepts.  </s>
<s> I have found the "Strip surplus tags in Word 2000 pages" in HTML-Kit very useful.  </s>
<s> However, it seems to go too far in one issue: it removes language markup.  </s>
<s> Specifically, when a document is saved in "HTML" format by Word, information about language is included.  </s>
<s> This seems to apply to such information as specified by the author's settings of the language for different parts of the document (as opposite to Word's heuristic guesses of language).  </s>
<s> It is useful for an author to set the language for text fragments in Word, since he gets spelling checking according to each language.  </s>
<s> It is potentially very useful to carry this information over to HTML.  </s>
<s> Although language markup is still used rather little, it has great potential, as described e.g. at And part of making the potential a reality is to favor the use of language markup - preferably so that it's easy to the author.  </s>
<s> And Word makes it relatively easy.  </s>
<s> (It's apparently not automatic, though.  </s>
<s> If Word heuristically recognizes the language of a text fragment, it applies suitable spelling checking algorithms but doesn't seem to store the information about language into the document when saved onto disk.  </s>
<s> Perhaps the reason is that the authors of Word thought that it would be redundant to store information that can be reconstructed on the fly.) What happens when I, say, paint some words in a document otherwise in Finnish and use Word's menu to set the language of those words English (in a situation where Word's heuristics hasn't worked)?  </s>
<s> I don't really know the intrinsics of Word, but what it writes into "HTML" is like this: p class=MsoNormal span lang=FI (text in Finnnish) /span span lang=EN-US style='mso-ansi-language:EN-US' (text in English) /span span lang=FI (text in Finnish) /span /p This isn't optimally clever, and the style attribute with a Microsoft specific stuff should stripped off, but the lang attributes _should_ be preserved, together with any span markup needed to carry them.  </s>
<s> The lang attribute is completely standard (though HTML-Kit might  </s>
<s> wish to add equivalent xml:lang attributes as well) and structural.  </s>
<s> Note that currently HTML-Kit strips away e.g. a LANG attribute from body as well, so this isn't just a by-product of stripping span .  </s>
<s> Jukka "Yucca" Korpela, http://www.cs.tut.fi/~jkorpela/  </s>
<s> Hi Jukka, Thanks for the note.  </s>
<s> You have found the right place.  </s>
<s> span lang="fr" Foo /span , should be kept.  </s>
<s> It is a simple tweak to avoid doing so.  </s>
<s> Comments anyone?  </s>
<s> take it easy, Charlie  </s>
<s> File a bug report and commit the fix :-)  </s>
<s> i am not positive that the "lang" attribute is part of the HTML 4.0 specification or not.  </s>
<s> I do not use that attribute, so I am not really familiar with the issue.  </s>
<s> however, I am very familiar with useing MS Word's "save as html" feature and find the proprietary HTML that M$ uses to be annoying and frustrating.  </s>
<s> What's worse is WordXP, which has now introduced 'smart tags" which clutter up and litter each document with vast quantities of unneeded proprietary XML markup for all sorts of idiotic things.  </s>
<s> It would be nice if M$ could truly make the tags "smart" by allowing them to be turned off so that those of us who do not like them can opt out of their brand of HMTL.  </s>
<s> Its truly rediculous.  </s>
<s> Once you remove the proprietary HTML, the document size is reduced by 5-10 fold.  </s>
<s> peace, dude  </s>
<s> Microsoft offers a "compact HTML" output filter...  </s>
<s> i am not positive that the "lang" attribute is part of the HTML 4.0 specification or not.  </s>
<s> I do not use that attribute, so I am not really familiar with the issue.  </s>
<s> It's easy enough to find out, in all conscience.  </s>
<s> !ENTITY % LanguageCode "NAME" -- a language code, as per [RFC1766] -- !ENTITY % i18n "lang %LanguageCode; #IMPLIED -- language code -- dir (ltr|rtl) #IMPLIED -- direction for weak/neutral text --" Practically every element type in HTML 4.01 that can contain text has 'lang' and 'dir' attributes.  </s>
<s> (Some characters in Unicode are inherently left-to-right, others inherently right-to-left, and some don't specify a direction but adapt to it.  </s>
<s> The comment on 'dir' suggests that it doesn't override inherent direction, but supplies context for charcaters that need it.) Why would Tidy ever remove a legal attribute if not told explicitly to do so?  </s>
