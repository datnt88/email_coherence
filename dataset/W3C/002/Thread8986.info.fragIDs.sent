<s> According to some users of XAdES, it is more secure as you also sign the hash of the signer's certificate in order to thwart changing this element.  </s>
<s> Any thoughts on why this presumably good solution is not a part of XML Dsig?  </s>
<s> thanx Anders Rundgren  </s>
<s> You can do this now, by adding a Reference that points to the cert and including the cert in the Signature.  </s>
<s> I don't think anything special is needed.  </s>
<s> /r$ Rich Salz, Chief Security Architect DataPower Technology http://www.datapower.com  </s>
<s> XS40 XML Security Gateway http://www.datapower.com/products/xs40.html  </s>
<s> XML Security Overview http://www.datapower.com/xmldev/xmlsecurity.html  </s>
<s> Rich,  </s>
<s> Sorry for the stupid question but since X509Data and X509Certificate do not support "Id" attributes, would not KeyInfo would be a better candidate?  </s>
<s> Anders  </s>
<s> Not a stupid question -- it shows you've read the spec more carefully than I have, or that I've forgotten too much.  </s>
<s> Yes, keyinfo would be what you have to use.  </s>
<s> Or perhaps an errata that adds an id attribute would be best.  </s>
<s> :)  </s>
<s> Rich Salz, Chief Security Architect DataPower Technology http://www.datapower.com  </s>
<s> XS40 XML Security Gateway http://www.datapower.com/products/xs40.html  </s>
<s> XML Security Overview http://www.datapower.com/xmldev/xmlsecurity.html  </s>
<s> A novice question.  </s>
<s> Pardon me if it is obvious.  </s>
<s> What is the need for signing the X509 certificate.  </s>
<s> Since each certificate contains a signature of its contents, which is validated by the next level Cert, until a self signed Cert is met.  </s>
<s> And the root Cert (self signed) is not trusted unless the receiver has that certificate in his/her cert store already.  </s>
<s> Even if the Certs are signed, by a reference, its still not secure until a trusted Cert (present in Cert store) is present in the Cert chain, isnt it.  </s>
<s> As long Cert validation happens, the contents is not trustable isnt it.  </s>
<s> And Cert validation is a prerequisite, and independent of the authenticating of the message received, isnt it.  </s>
<s> thanks Joseph  </s>
<s> A Certificate's Issuer binds a Subject and its Public Key with a specific set of Claims (e.g. Account #, validity period, etc.).  </s>
<s> The same Public Key might be bound in different Certificates (for the same or other Subject) to different sets of Claims.  </s>
<s> So there may exist more than one valid Certificate with the same Public Key.  </s>
<s> Including the Certificate with the in the signature makes eliminates the possibility that the Certificate might be replaced after signing.  </s>
<s> Thanks, Mike w3c-ietf-xmldsig-request@w3.org wrote on 03/11/2004 01:49:36 PM:  </s>
<s> Suppose I have a single keypair, but multiple certificates for that pair.  </s>
<s> For example, I might have a cert that identifies me as an employee, for signing email, and I might have a cert that identifies me as an officer of the company, for signing official documents.  </s>
<s> Unless I sign the cert, I can swap the two roles, and the receiver cannot tell.  </s>
<s> Even worse, a "fraudulent" or irrespoinsible CA can mint a new certificate for my public key that contains all sorts of things.  </s>
<s> Unless the receiver does full cert-chain validation (and really, who does that?  </s>
<s> nobody:), they can be fooled by this fraudulent cert.  </s>
<s> /r$  </s>
<s> Rich Salz, Chief Security Architect DataPower Technology http://www.datapower.com  </s>
<s> XS40 XML Security Gateway http://www.datapower.com/products/xs40.html  </s>
<s> XML Security Overview http://www.datapower.com/xmldev/xmlsecurity.html  </s>
<s> Michael, Rich, Thanks to both of you for the clarification.  </s>
<s> I was not aware a same key be certified by different bodies, and/or for different rolls.  </s>
<s> Even a full cert-chain validation, cannot determine the fraud in that situation, if the hacker has in possession one valid message each signed by the sender in his each role.  </s>
<s> thanks Joseph  </s>
<s> However, I do not think that modelling the signer role per using different  </s>
<s> certs for the same key is a good practice.  </s>
<s> Rather the relying party should  </s>
<s> deduce this from the context, for instance from the data being signed (as  </s>
<s> you do it in the paper world as well), or from another signature attribute  </s>
<s> which XadES provides (Signer Role).  </s>
<s> Yes, reading this chain I got the same feeling as Gregor that the CAs issuing  </s>
<s> multiple certs per the same key pair had crossed the line of the intent of  </s>
<s> the system and were now using the self-signing ability of XML DSig or XAdES  </s>
<s> to fix the hack.  </s>
<s> A key pair is supposed to be assigned to a unique identity.  </s>
<s> If, within a system,  </s>
<s> that means (name+role), then that is what should be assigned the key pair.  </s>
<s> To say that (name+role) is the identity, but we assign the key pair to name  </s>
<s> opens up the real possibility of abuse of the system.  </s>
<s> To wit, how is the relying party supposed to know whether or not a cert is the  </s>
<s> unique wrapper for a given key pair?  </s>
<s> Therefore, how can generic signature engines  </s>
<s> be written?  </s>
<s> Must they be told to require signatures that sign the certificate as  </s>
<s> part of the core validation?  </s>
<s> Conversely, because it's not part of core validation, shouldn't the CA's have  </s>
<s> stayed away from this practice?  </s>
<s> John Boyer, Ph.D. Senior Product Architect and Research Scientist PureEdge Solutions Inc.  </s>
<s> It is interesting to note that the use of a single key-pair for multiple certificates still is fairly often touted by promoters of smart cards.  </s>
<s> Usually due to limitations in private key storage and generation.  </s>
<s> Anders PS I never thought this was a such a great idea BTW DS  </s>
<s> However, I do not think that modelling the signer role per using different  </s>
<s> certs for the same key is a good practice.  </s>
<s> Rather the relying party should  </s>
<s> deduce this from the context, for instance from the data being signed (as  </s>
<s> you do it in the paper world as well), or from another signature attribute  </s>
<s> which XadES provides (Signer Role).  </s>
<s> Yes, reading this chain I got the same feeling as Gregor that the CAs issuing  </s>
<s> multiple certs per the same key pair had crossed the line of the intent of  </s>
<s> the system and were now using the self-signing ability of XML DSig or XAdES  </s>
<s> to fix the hack.  </s>
<s> A key pair is supposed to be assigned to a unique identity.  </s>
<s> If, within a system,  </s>
<s> that means (name+role), then that is what should be assigned the key pair.  </s>
<s> To say that (name+role) is the identity, but we assign the key pair to name  </s>
<s> opens up the real possibility of abuse of the system.  </s>
<s> To wit, how is the relying party supposed to know whether or not a cert is the  </s>
<s> unique wrapper for a given key pair?  </s>
<s> Therefore, how can generic signature engines  </s>
<s> be written?  </s>
<s> Must they be told to require signatures that sign the certificate as  </s>
<s> part of the core validation?  </s>
<s> Conversely, because it's not part of core validation, shouldn't the CA's have  </s>
<s> stayed away from this practice?  </s>
<s> John Boyer, Ph.D. Senior Product Architect and Research Scientist PureEdge Solutions Inc.  </s>
<s> Yes, it is very interesting how the marketing mind works, turning a limitation into a desirable feature.  </s>
<s> They're really good at manufacturing need.  </s>
<s> :-) About 10 years ago we had a doc writer who went on to marketing greatness (someplace else), but the doc writer had this tendency of occasionally finding a bug then writing about it as a wonderful feature rather than realizing it wasn't intended.  </s>
<s> The particular bug that comes to mind was my own.  </s>
<s> I was doing something that was not quite right with windows 3.1 color palette management and the occasional video card took note of it.  </s>
<s> So, instead of getting a directory menu that was consistently a steel blue-grey color, this doc writer would get a different color every time the program was launched.  </s>
<s> So, into the manual went this long spiel about the wonderful, cheery, background color mutation strategy.  </s>
<s> Even called it the 'rainbow effect.'  </s>
<s> Ironically, the name ended up being appropriate as it described all the colors I turned when I saw the documentation.  </s>
<s> :-)  </s>
<s> John Boyer, Ph.D. Senior Product Architect and Research Scientist PureEdge Solutions Inc.  </s>
<s> John, Just like none of us should use the same username/password for different systems, none of us should request multiple certificates for the same key pair.  </s>
<s> However, a CA has no ultimate control over this since the subject may request certificates from multiple CAs.  </s>
<s> Thanks, Mike w3c-ietf-xmldsig-request@w3.org wrote on 03/12/2004 11:52:56 AM:  </s>
<s> different  </s>
<s> should  </s>
<s> (as  </s>
<s> attribute  </s>
<s> issuing  </s>
<s> of  </s>
<s> XAdES  </s>
<s> system,  </s>
<s> pair.  </s>
<s> name  </s>
<s> is the  </s>
<s> signature engines  </s>
<s> certificate as  </s>
<s> have  </s>
