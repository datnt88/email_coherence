<s> ... please provide a sequence of operations that would be impossible [if a depth 0 lock on a colllection is inherited by newly created  </s>
<s> internal members of that collection, as in 7.5]...  </s>
<s> LOCK /a/ is invoked, depth:0 ...Now the owner does a BIND to /a/c/ and adds a whole new tree below /a/.  </s>
<s> Oh now I get it.  </s>
<s> You are thinking about the consequences for BIND.  </s>
<s> But BIND is not part of RFC 2518.  </s>
<s> But my question was about the behavior of plain old RFC 2518.  </s>
<s> My intention is to try to finish a WebDAV testing tool tdav.py that tests compliance and interoperability of WebDAV servers according to RFC 2518, not according to the work of the advanced collections group.  </s>
<s> RFC 2518 is on its way to a Standard, but the advanced collection work is not yet there.  </s>
<s> it may be part of WebDAV someday, but it is not, yet.  </s>
<s> I have not proposed or argued against anything.  </s>
<s> I am just trying to get a clear understanding of RFC 2518.  </s>
<s> We all agree that a depth infinity lock on a collection is inherited by  </s>
<s> newly created internal members.  </s>
<s> The only point of disagreement is about a depth zero lock.  </s>
<s> I read 7.5 as saying that even a depth zero lock is inherited, because it does not say "only depth infinity".  </s>
<s> You and others have asserted that this  </s>
<s> is bad.  </s>
<s> When I asked why, you said it causes problems for BIND.  </s>
<s> But BIND is not in RFC 2518, so let me ask, just for clarity's sake, does it cause problems for a server compliant with RFC 2518, but ignorant of BIND?  </s>
<s> If so, what is it?  </s>
<s> If not, then we can take up the problem with BIND, and see whether it really is a problem, and if so, what to do about it.  </s>
<s> it's perfectly fine with me to rule out certain behaviors that might be lawful under plain old RFC 2518 in order to leave room for future expansion.  </s>
<s> But if that's the reason, we should say so.  </s>
<s> So can we clear up this question first, and then take on the question of whether there's a problem for BIND?  </s>
<s> With all best wishes Jim  </s>
<s> That's being a bit pedantic, don't you think?  </s>
<s> All right, so the RFC is missing three words.  </s>
<s> Put them in and interpret it that way.  </s>
<s> We know what the state of a Depth:0 lock on a collection is after one has been applied (just the collection is locked), and we know the state after a Depth:infinity has been applied (a bunch of stuff is locked).  </s>
<s> Your "interpretation" would create situations that just don't match normal behavior.  </s>
<s> With the simple insertion of three words, you get behavior that matches for the PUT/MKCOL case and the LOCK case.  </s>
<s> What I don't understand is how you could arrive at a reasonable interpretation that the lock *should* be inherited.  </s>
<s> Could you explain?  </s>
<s> Cheers, -g Greg Stein, http://www.lyra.org/  </s>
<s> Uh, actually no I don't think it's being pedantic.  </s>
<s> Could we please keep the discussion to logic and pragmatics?  </s>
<s> I don't object off hand to making a change (in the next draft) but I would like it to be noted as a *change* or at least a clarification in the meaning.  </s>
<s> It's possible that the authors actually had in mind that only depth infinity locks would be inherited, but that is not what the spec actually says.  </s>
<s> maybe it's a typo, or maybe it's a bad design decision, but neither you nor I are free to simply insert words that change the meaning just because we don't like the behavior as specified.  </s>
<s> The point of this conversation, and the testing experience with WebDAV is to find places where the spec is either a bad idea and should be changed, or is unclear.  </s>
<s> Just to remind you, at the start of this thread someone (G Slein, J Amsden,  </s>
<s> CC Jason or G Clemm, sorry I am not sure who though) asserted that if a depth 0 lock was inherited, something bad would happen.  </s>
<s> but upon challenge, no one has been able to say what that bad thing is.  </s>
<s> All you  </s>
<s> have said is that it's pedantic to interpret it that way.  </s>
<s> Look, I quote 7.5 If a lock owner causes the URI of a resource to be added as an internal member URI of a locked collection then the new resource MUST be automatically added to the lock.  </s>
<s> This is the only mechanism that allows a resource to be added to a write lock.  </s>
<s> Thus, for example, if  </s>
<s> the collection /a/b/ is write locked and the resource /c is moved to /a/b/c then resource /a/b/c will be added to the write lock.  </s>
<s> It does not say "locked depth infinity" it just says "locked".  </s>
<s> If the authors had meant to restrict this to apply only to infinite-depth locked collection, they would have said so, no?  </s>
<s> Or perhaps the difficulty lies in the term "added to the lock"?  </s>
<s> I think this may be the source of the confusion.  </s>
<s> This really isn't pedantry, honest.  </s>
<s> I am not doing this just for the pleasure of arguing.  </s>
<s> I am doing this because i want a spec that's clear, so that any implementor can read it and know what to expect.  </s>
<s> I suspect that you guys interpret "added to the lock" as meaning something like "falling under the same protection as the other resources previously protected by it", which is to say protected from DELETE (because that changes the membership-state of the parent collection) but not from a (second) PUT.  </s>
<s> I interpret it as meaning "locked in the same manner as the original resource".  </s>
<s> Thus when patent collection P is exclusive write locked (at depth 0) with lock L and new resource R is added to that lock, then there are now two resources that lock L applies to, P and R. And just as one can not change P's state without passing L's token, neither can one change R. If this is not the correct interpretation, then we should add language to the spec to make this explicit.  </s>
<s> Is any one else on this list paying any attention to this?  </s>
<s> Or is it just the five of us?  </s>
<s> Hopefully we will soon straighten this out.  </s>
<s> Well, since you asked, yes, someone else is paying attention.  </s>
<s> For clarity, I think 7.5 should specify a depth infinity lock if that is in fact what the  </s>
<s> authors intended (I don't know whether that might be true).  </s>
<s> As far as the "bad" behavior which might result when newly-added children inherit depth-0 locks, I propose the following scenario.  </s>
<s> Please forgive me if this is  </s>
<s> obviously wrong.  </s>
<s> Suppose the following hierarchies of resources: a/ a/b a/b/d/ a/b/d/q a/b/d/r c/ c/j c/k Suppose a/b/ is write-locked depth 0. My understanding is that a/b/d and its members are not locked at this point.  </s>
<s> Now suppose we move collection /c with its members under /a/b, as in the example of 7.5.  </s>
<s> Now we have a/ a/b a/b/c/ a/b/c/j a/b/c/k a/b/d/ a/b/d/q a/b/d/r If we interpret 7.5 to mean that the write-locks are inherited even for depth 0, then /a/b/c becomes locked, but /a/b/d is not locked, which seems inconsistent to me because the lock has developed memory--pre-existing internal members are not locked, but newly-added ones are.  </s>
<s> Furthermore, what about new members of /a/b/c?  </s>
<s> Wouldn't /a/b/c/x and /a/b/c/y inherit the depth-0 write-lock from /a/b/c while /a/b/c/j and /a/b/c/k remain unlocked?  </s>
<s> It's the same case, just another level down.  </s>
<s> I think you could end up with a depth-0 lock locking some resources down to depth infinity by virtue of the fact they were added after /a/b/ was locked.  </s>
<s> Or I'm just completely lost, which is a real possibility.  </s>
<s> for  </s>
<s> example, if the collection /a/b/ is write locked and the resource /c is moved to /a/b/c then resource /a/b/c will be added to the write  </s>
<s> lock.  </s>
<s> David Chandler  </s>
<s> How do I unsubscribe?  </s>
<s> this  </s>
<s> Uh, actually no I don't think it's being pedantic.  </s>
<s> Could we please keep the discussion to logic and pragmatics?  </s>
<s> I don't object off hand to making a change (in the next draft) but I would like it to be noted as a *change* or at least a clarification in the meaning.  </s>
<s> It's possible that the authors actually had in mind that only depth infinity locks would be inherited, but that is not what the spec actually says.  </s>
<s> maybe it's a typo, or maybe it's a bad design decision, but neither you nor I are free to simply insert words that change the meaning just because we don't like the behavior as specified.  </s>
<s> The point of this conversation, and the testing experience with WebDAV is to find places where the spec is either a bad idea and should be changed, or is unclear.  </s>
<s> Just to remind you, at the start of this thread someone (G Slein, J Amsden,  </s>
<s> CC Jason or G Clemm, sorry I am not sure who though) asserted that if a depth 0 lock was inherited, something bad would happen.  </s>
<s> but upon challenge, no one has been able to say what that bad thing is.  </s>
<s> All you  </s>
<s> have said is that it's pedantic to interpret it that way.  </s>
<s> Look, I quote 7.5 If a lock owner causes the URI of a resource to be added as an internal member URI of a locked collection then the new resource MUST be automatically added to the lock.  </s>
<s> This is the only mechanism that allows a resource to be added to a write lock.  </s>
<s> Thus, for example, if the collection /a/b/ is write locked and the resource /c is moved to /a/b/c then resource /a/b/c will be added to the write lock.  </s>
<s> It does not say "locked depth infinity" it just says "locked".  </s>
<s> If the authors had meant to restrict this to apply only to infinite-depth locked collection, they would have said so, no?  </s>
<s> Or perhaps the difficulty lies in the term "added to the lock"?  </s>
<s> I think this may be the source of the confusion.  </s>
<s> This really isn't pedantry, honest.  </s>
<s> I am not doing this just for the pleasure of arguing.  </s>
<s> I am doing this because i want a spec that's clear, so that any implementor can read it and know what to expect.  </s>
<s> I suspect that you guys interpret "added to the lock" as meaning something like "falling under the same protection as the other resources previously protected by it", which is to say protected from DELETE (because that changes the membership-state of the parent collection) but not from a (second) PUT.  </s>
<s> I interpret it as meaning "locked in the same manner as the original resource".  </s>
<s> Thus when patent collection P is exclusive write locked (at depth 0) with lock L and new resource R is added to that lock, then there are now two resources that lock L applies to, P and R. And just as one can not change P's state without passing L's token, neither can one change R. If this is not the correct interpretation, then we should add language to the spec to make this explicit.  </s>
<s> Is any one else on this list paying any attention to this?  </s>
<s> Or is it just the five of us?  </s>
<s> Hopefully we will soon straighten this out.  </s>
<s> From: Jim Davis jrd3@alum.mit.edu  </s>
<s> Amsden,  </s>
<s> See http://lists.w3.org/Archives/Public/w3c-dist-auth/1999OctDec/0245.html  </s>
<s> In particular, this message says: I lock a collection, because I'm going to be adding members to that collection.  </s>
<s> If a depth:0 lock applies to all the immediate members of a collection as well, then I have prevented anyone from updating the state of one of the existing internal members of that collection.  </s>
<s> If I'd wanted that behavior, I would have issued a  </s>
<s> depth:1 lock.  </s>
<s> And quoting from the definition of what depth means: The Depth header is used with methods executed on resources which could potentially have internal members to indicate whether the method is to be applied only to the resource ("Depth: 0"), to the resource and its immediate children, ("Depth: 1"), or the resource and all its progeny ("Depth: infinity").  </s>
<s> Cheers, Geoff  </s>
<s> Your scenario is exactly right, that is, it makes all the right predictions.  </s>
<s> So the claim is that it would be confusing if WebDAV acted this way... you'd have a tree of resources, only some of which were locked, and whose lockedness depended on the history.  </s>
<s> In fact I agree, it seems confusing to me too.  </s>
<s> It's a good argument for changing the spec.  </s>
<s> Thanks for tracking down the quotation (I can't search the email archive right now) but that message responds to a strawman.  </s>
<s> I never said "a depth:0 lock applies to all the immediate members of a collection".  </s>
<s> (indeed, that's what a depth infinity lock does).  </s>
<s> I was asking about a depth 0 lock being inherited by *newly created* members of the collection.  </s>
<s> So let me ask again.  </s>
<s> If I lock collection a/ with depth 0, then do a PUT to a/b.html (which did not prev exist), and a/b.html is added to the lock, what bad thing then happens, or what good thing is prevented?  </s>
<s> Does something bad happen if the PUT is instead a MKCOL, or COPY/MOVE, or a LOCK?  </s>
<s> Note that I have seen David Chandler's reply.  </s>
<s> Do you have anything to add other than his example?  </s>
<s> Also, if you have any comments on the very end of my last email (where I asked whether the problem was the definition of "added to the lock") that might help.  </s>
<s> best wishes Jim  </s>
<s> Yes, I've been following this analysis too, and I concur that depth 0 locks stay on the resource, period.  </s>
<s> There should be no weird crossovers from depth:0 to depth:1 just because the resource is a collection.  </s>
<s> [I am afraid to ask what the implications are for creating a locked-null resource as an immediate child, but if it is a problem, I think the defect is in lock-null.]  </s>
<s> -- Dennis Dennis E. Hamilton InfoNuovo [mailto:w3c-dist-auth-request@w3.org]On  </s>
<s> Behalf Of Geoffrey Clemm I lock a collection, because I'm going to be adding members to that collection.  </s>
<s> If a depth:0 lock applies to all the immediate members of a collection as well, then I have prevented anyone from updating the state of one of the existing internal members of that collection.  </s>
<s> If I'd wanted that behavior, I would have issued a depth:1 lock.  </s>
<s> And quoting from the definition of what depth means: The Depth header is used with methods executed on resources which could potentially have internal members to indicate whether the method is to be applied only to the resource ("Depth: 0"), to the resource and its immediate children, ("Depth: 1"), or the resource and all its progeny ("Depth: infinity").  </s>
<s> Cheers, Geoff  </s>
<s> In case you've lost the initial mail sent when you subscribed to this list,  </s>
<s> the way to unsubscribe to the WG list is to send an email with a subject line of "unsubscribe" to w3c-dist-auth-request@w3.org.  </s>
<s> You'll then automatically be removed from the mailing list.  </s>
<s> - Jim  </s>
<s> Sorry I didn't read this thread sooner...  </s>
<s> The original intent was to have the inheritance behavior only apply to Depth infinity locked collections, not to Depth 0 locked collections.  </s>
<s> Since section 7.5 does not explicitly state a "depth infinity locked collection", but only states a "lcoked collection", the section is ambiguous, and should be clarified in a future revision of RFC 2518.  </s>
<s> I've added this to the issues list, available at:  </s>
<s> - Jim  </s>
<s> Okay, that resolves that.  </s>
<s> I've modified tdav.py to reflect the intended behavior, and now I can confirm that the server at Sharemation is (so far as I can tell) in full compliance with RFC 2518.  </s>
<s> And a reminder to those of you who have mail servers that occasionally go off-line: our list server will automatically remove addresses that bounce more than 4 messages.  </s>
<s> If the list is very active it may not take long for that to happen.  </s>
