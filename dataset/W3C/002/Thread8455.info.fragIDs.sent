<s> TO:w3c-ietf-xmldsig@w3.org Here's the updated version of the draft (a few minor changes from Friday) including a draft DTD (probably containing a few typos).  </s>
<s> This will be the basis for tomorrow's discussions.  </s>
<s> Dave XML Digital Signature Syntax and Processing David Solo Citigroup dsolo@alum.mit.edu 29 August 1999 1.0 Introduction This document describes the proposed syntax and processing rules for the XML Digital Signature Standard.  </s>
<s> This standard provides a mechanism for applying digital signatures to XML documents and other internet resources.  </s>
<s> The structure allows for both embedded and detached signatures.  </s>
<s> An embedded signature may either include the signature within the signed object or embed the signed object within the signature.  </s>
<s> A detached signature allows the signature to be independent of the object.  </s>
<s> The processing structure allows for switching between embedded and detached signatures without invalidating the signature.  </s>
<s> In addition to the basic signature document type, this document also defines other useful types including a manifest for referencing multiple resources and key management and algorithm definitions.  </s>
<s> 2.0 General model The general structure of an XML signature document is: 2.1 signedinfo signedinfo is the actual data over which the signature is calculated.  </s>
<s> It contains control information (algorithm identifiers, pre-processing transformations), a digest over the object being signed, and optional signed attributes (information associated with the signature).  </s>
<s> 2.2 signedobject signedobject is an optional element which is used to include the object being signed within the signature document.  </s>
<s> When present this element may contain any item and specifies the encoding.  </s>
<s> 2.3 keyinfo keyinfo is an optional element which enables the recipient(s) to obtain the key(s) needed to validate the signature.  </s>
<s> keyinfo may contain the key, may name the key, may include certificates and other public key management information, may include inband key distribution or agreement data, or use any other method.  </s>
<s> 2.4 signaturevalue signaturevalue is an empty element that contains the actual value of the digital signature.  </s>
<s> The ability to define a signaturealg and signaturevalue pair which includes multiple distinct signatures is explicitly permitted (e.g. ?rsawithsha-1 and ecdsawithsha-1").  </s>
<s> 3.0 signedinfo The structure of signedinfo is: The signedinfo element may contain an optional ID attribute that will allow it to be referenced by other signatures.  </s>
<s> 3.1 c14nalg c14nalg is an optional element which specifies the c14n algorithm applied to the signedinfo element prior to performing signature calculations.  </s>
<s> If the default c14n algorithm for signedinfo is used, this element may be omitted.  </s>
<s> This element uses the general structure here for algorithms in which a uri is included as an attribute naming the algorithm and optional contents of the element contain any parameter, value, or other information defined by the algorithm name.  </s>
<s> Possible options may include a null algorithm (no changes), a simple identity algorithm (CRLF and charset normalization), and more extensive transformations such as the W3C c14n proposal.  </s>
<s> 3.2 signaturealg signaturealg is a required element which specifies the algorithm used for signature generation and validation.  </s>
<s> This algorithm ID identifies all cryptographic functions involved in the signature operation (e.g. hashing, public key algorithms, MACs, etc.).  </s>
<s> This element uses the general structure here for algorithms in which a uri is included as an attribute naming the algorithm and optional contents of the element contain any parameter, value, or other information defined by the algorithm name.  </s>
<s> While there is a single identifier, that identifier may specify a format containing multiple distinct signature values.  </s>
<s> 3.3 signedobjectdata The structure of signedobjectdata is: 3.3.1  </s>
<s> objectlocation objectlocation identifies where to find the signedobject and optionally information about the type of object being signed (e.g. manifest, package, document, signedinfo, PDF file).  </s>
<s> This element may be omitted if the location is implicit in the application.  </s>
<s> The element contains two attributes, a type uri and a location uri.  </s>
<s> 3.3.2  </s>
<s> transformations transformations is an optional element that contains one or more operations to be performed on the signedobject prior to signature calculation.  </s>
<s> Examples of transformations include c14n, exclusion (omitting certain portions of the object from the signature), encoding, etc.  </s>
<s> Each element within transformations uses the general structure here for algorithms in which a uri is included as an attribute naming the algorithm and optional contents of the element contain any parameter, value, or other information defined by the algorithm name.  </s>
<s> If the transformations element is omitted, the only operation performed is the default object c14n algorithm (null or identity).  </s>
<s> 3.3.3  </s>
<s> digestalg digestalg is a required element which identifies the digest algorithm to be applied to the signed object.  </s>
<s> This element uses the general structure here for algorithms in which a uri is included as an attribute naming the algorithm and optional contents of the element contain any parameter, value, or other information defined by the algorithm name.  </s>
<s> 3.3.4  </s>
<s> digestvalue digestvalue is a required empty element which contains the base64 encoded value of the digest.  </s>
<s> 3.4 signedattributes signedattributes is an optional element which contains one or more attributedata elements.  </s>
<s> Each attributedata element contains a type attribute naming the attribute type with a uri and has a value defined by the type.  </s>
<s> signedattributes contain information associated with the signature itself.  </s>
<s> Information about the content should be included within the signedobject.  </s>
<s> 4.0 signedobject signedobject is an optional element which contains the signed object identified in signed info.  </s>
<s> This element is used for embedded signatures where the object being signed is to be included in the signature document.  </s>
<s> The signedobject element may include optional type, ID, and encoding attributes and may contain any data.  </s>
<s> 5.0 keyinfo keyinfo is an optional element which enables the recipient(s) to obtain the key(s) needed to validate the signature.  </s>
<s> If omitted, the recipient is expected to be able to identify the key based on application context information.  </s>
<s> This element contains one or more keyinfodata elements providing information for the recipient(s).  </s>
<s> Some types are defined here, although applications may define any mechanism they choose.  </s>
<s> 5.1 keyname keyname contains an identifier for the key which may be useful to the recipient.  </s>
<s> This may be a name, index, etc. 5.2 keyvalue keyvalue contains the actual key(s) used to validate the signature.  </s>
<s> If the key is sent in protected form, the keymgmtdata element should be used.  </s>
<s> Specific types must be defined for each algorithm type (see algorithms).  </s>
<s> 5.3 subjectname subjectname contains one or more names for the sender.  </s>
<s> Forms to be supported include a simple name string, encoded DN, email address, etc. 5.4 keyretrievalmethod keyretrievalmethod is a uri which may be used to obtain key and/or certificate information.  </s>
<s> The uri should contain the complete string for retrieving the key needed for this message (rather than a generic uri).  </s>
<s> 5.5 x509data x509data contains an identifier of the key/cert used for validation (either an issuerserial value, a subject name, or a subjectkeyID) and an optional collection of certificates and revocation/status information which may be used by the recipient.  </s>
<s> issuerserial contains the encoded issuer name (RFCxxxx) along with the serial number.  </s>
<s> 5.6 pgpdata 5.7 keymgmtdata keymgmtdata contains in-band key distribution or agreement data.  </s>
<s> Examples may include DH key exchange, RSA key encryption etc. 6.0 signaturevalue signaturevalue is a required empty element which contains the base64 encoded value of the signature as defined by the signaturealg value in signedinfo.  </s>
<s> 7.0 Algorithms This sections identifies algorithms used with the XML digital signature standard.  </s>
<s> Entries contain the identifier to be used in signature documents, a reference to the formal specification, and definitions, where applicable, for the representation of keys and the results of cryptographic operations.  </s>
<s> 7.1 Digest algorithms 7.2 Signature algorithms 7.3 c14n algorithms 8.0 Processing rules These sections describe the operations to be performed as part of signature generation and validation.  </s>
<s> The description is of a logical behavior and does not specify an order of execution, nor specify discrete steps.  </s>
<s> 8.1 Generation a) apply transformations determined by application to object to be signed.  </s>
<s> b) calculate digest over object c) create signedobjectdata element including location of object, digest, and transformation and digest algorithm elements, if required.  </s>
<s> d) create signedinfo element with signaturealg, c14nalg (for signedinfo), signedobjectdata, and signedattributes (if any).  </s>
<s> e) canonicalize and calculate signature over signedinfo based on algorithms in step d. f) construct signature document with signedinfo, signedobject (if desired, encoding may be different than that used for signing), keyinfo (if required), and signaturevalue.  </s>
<s> 8.2 Validation a) locate and apply transformations (e.g. c14n) to the signed object based on signedobjectdata in the signedinfo element.  </s>
<s> b) calculate digest over transformed signed object based on the algorithm in signedobjectdata.  </s>
<s> If the object is contained within the signedobject element, only the object itself is hashed (i.e. the signedobject and /signedobject tags are excluded).  </s>
<s> c) compare value against digest value in signedinfo (if mismatch, validation fails).  </s>
<s> d) canonicalize the signedinfo element based on the c14n algorithm ID in signedinfo (or based on the default if absent).  </s>
<s> e) obtain the validation keying info from keyinfo or externally.  </s>
<s> f) validate the signaturevalue based on the signaturealg in the signedinfo element, the key obtained in step c, and the results of step d. - Digest calculation is performed over the signedInfo element including start and end tags.  </s>
<s> - The signedattributes element is treated as opaque with respect to processing (i.e. signedattributes do not effect processing and are just included in the signaturevalue calculation).  </s>
<s> 9.0 DTD !ELEMENT dsig:signature (dsig:signedinfo, dsig:signedobject?, dsig:keyinfo?, dsig:signaturevalue) !ATTLIST dsig:signature id ID #IMPLIED !ELEMENT dsig:signedinfo (dsig:c14nalg?, dsig:signaturealg, dsig:signedobjectdata, dsig:signedattributes?) !ATTLIST dsig:signedinfo id ID #IMPLIED !ATTLIST dsig:signedobject id CDATA #IMPLIED type CDATA #IMPLIED encoding CDATA #IMPLIED !ATTLIST dsig:keyinfodata type CDATA #REQUIRED !ATTLIST dsig:signaturevalue value CDATA #REQUIRED !ATTLIST dsig:c14nalg type CDATA #REQUIRED !ATTLIST dsig:signaturealg type CDATA #REQUIRED !ATTLIST dsig:digestalg type CDATA #REQUIRED !ATTLIST dsig:encoding type CDATA #REQUIRED !ATTLIST dsig:exclusion type CDATA #REQUIRED !ELEMENT dsig:signedobjectdata (dsig:objectlocation, dsig:transformations?, dsig:digestalg, dsig:digestvalue) !ATTLIST dsig:objectlocation type CDATA #IMPLICIT href CDATA #REQUIRED !ELEMENT dsig:transformations (dsig:c14nalg?, dsig:encoding?, dsig:exclusion?) !ATTLIST dsig:digestvalue value CDATA #REQUIRED !ATTLIST dsig:attributedata type CDATA #REQUIRED 10.0 Example syntax: dsig:attributedata type="http://..." 19990824132700Z jhasodutoinwoiahsh 11.0 Open Issues 1) At this time, the only method for signing an object that is supported is to calculate a digest over the signed object and include that digest in signedinfo.  </s>
<s> The signed object may be anything (a manifest, a document, another signedinfo element, etc.).  </s>
<s> Only a single such digest may appear (signing multiple items is handled in the signedobject (e.g. in a manifest).  </s>
<s> Alternatives would allow the actual object to be included within signed info or to allow multiple digests.  </s>
<s> The decision to always use the digest method is based on separating the pre- processing transformations (e.g. encoding, c14n) for signedinfo and for the object itself and also to allow for switching between detached and embedded signatures.  </s>
<s> 2) Default c14n algorithms for signedinfo and for objects.  </s>
<s> Other defaults.  </s>
<s> Mandatory to implement cryptographic algorithms and keyinfo types.  </s>
<s> 3) Identifying signed object.  </s>
<s> How do we handle the pointer from signedinfo to the signed object, and what rules need to be defined for the ID attributes in signedinfo and signedobject?  </s>
<s> 12.0 Security Considerations 13.0 References 14.0 Acknowledgements  </s>
<s> Generally, I like the proposal.  </s>
<s> Just some minor remarks: a) why is the objecttype "hidden" in objectlocation?  </s>
<s> I don't have a strong opinion here but it would seem cleaner to have it as a sepearate element of signedobjectdata.  </s>
<s> Even Digestalg and value are sepearated...... however b) Wouldn't it be better to put digestalg and value into one element?  </s>
<s> What if we want to allow more than one digest for multiple signature algorithms?  </s>
<s> I would like to allow more than one digest (using different algs) in a signature to protect against broken digest algs without the need to have separate signatures.  </s>
<s> Have a nice F2F!  </s>
<s> Peter  </s>
<s> "Peter Lipp" Peter.Lipp@iaik.at on 08/30/99 06:41:43 AM Subject: AW: syntax and processing draft - update Generally, I like the proposal.  </s>
<s> Just some minor remarks: a) why is the objecttype "hidden" in objectlocation?  </s>
<s> I don't have a strong opinion here but it would seem cleaner to have it as a sepearate element of signedobjectdata.  </s>
<s> Even Digestalg and value are sepearated...... however b) Wouldn't it be better to put digestalg and value into one element?  </s>
<s> What if we want to allow more than one digest for multiple signature algorithms?  </s>
<s> I would like to allow more than one digest (using different algs) in a signature to protect against broken digest algs without the need to have separate signatures.  </s>
<s> [Tom Gindin] How about the "composite hash algorithm" idea?  </s>
<s> There should shortly be some published OID's for such combinations as SHA-1 followed by MD2, and some could be added to mix RIPE-MD with either SHA-1 or one of the MD's.  </s>
<s> Breaking one of those digest algorithms just reduces the digest strength to that of the other digest algorithm(s), and finding collisions in one (which seems to be the most common kind of break) has little effect unless you can find coincident collisions in the other.  </s>
<s> For longer signature keys, you can even have three hashes, although there might be some reason not to extend the aggregate hash length beyond half the key length.  </s>
<s> Have a nice F2F!  </s>
<s> Peter  </s>
