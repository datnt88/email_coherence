<s> Hi, I'm new to HTMLtidy and I have seen a couple a references to a shortcoming of HTML tidy.  </s>
<s> It does not look like you can get clean HTML to XHTML conversion, the script tag being one of the culprit.  </s>
<s> XTML requires a CDATA section within a script block, HTMLtidy neither  </s>
<s> complies nor discard the script .  </s>
<s> I know I am not the first one to face the issue ( cf. the "Notes on pending work" ) My question is : What is the status on this problem ?  </s>
<s> TIA, Philippe  </s>
<s> Thats not correct.  </s>
<s> XML does not know content model CDATA for Elements, so the content of a script element is interpreted as markup.  </s>
<s> To keep the script readable, one could use a CDATA section, but there is no must to do so, you can use if (a  b) too.  </s>
<s> Further, this is only necessary if the script includes characters, that need to be escaped.  </s>
<s> The problem is, that current browsers don't know CDATA sections and ignore the script completly.  </s>
<s> I've suggested the following to get around this: !-- -- ![CDATA[ / !-- for (var i=0; i  10; i++) { ... } // -- !  </s>
<s> ]] Tidy should offer an option to extract the script and put it into a seperate file.  </s>
<s> Bj?rn H?hrmann ^ mailto:bjoern@hoehrmann.de ^ http://www.bjoernsworld.de am Badedeich 7 ?  </s>
<s> Telefon: +49(0)4667/981ASK ?  </s>
<s> http://bjoern.hoehrmann.de  </s>
<s> 25899 Dageb?ll # PGP Pub.  </s>
<s> KeyID: 0xA4357E78 # http://learn.to/quote  </s>
<s> [!]e "Everything we see or seem is but a dream within a dream" - E.A. Poe  </s>
<s> ok, I may have been wrong.  </s>
<s> My situation is : I took a notoriously badly written page ( http://www.6sens.com/  </s>
<s> , sorry it's a French site ).  </s>
<s> I wanted to XHTMLize it.  </s>
<s> As real-world "validation", I tried to open the page both with "XMLspy" from Icon Information System and to "LoadXML" using microsoft parsers.  </s>
<s> The output from HTMLtidy failed to load in both cases (I just glanced at the XHTML specs, I admit.) I did some corrections by hands, and I mananaged to load it.  </s>
<s> Examples of corections: enclosed script content in CDATA, adding a white space in empty comments ( ie : from ---- to -- -- ) .  </s>
<s> I do understand that a lots a w3c specs implementations are rather fuzzy.  </s>
<s> I do not want to argue about it.  </s>
<s> ( especially, because I am likely to be wrong quite often...) Was I am looking for is a clear Status Report on HTMLtidy XHTML compliance ( both as compared to the specs and as compared to realworld "validation" ).  </s>
<s> Ther are 2 items above to add on the to-do list .  </s>
<s> Anyone wanting to centralize the datas ( or is it already done somewhere ?  </s>
<s> ) thanks Bjoern, regards to you all, Philippe | XTML requires a CDATA section within a script block, Thats not correct.  </s>
<s> XML does not know content model CDATA for Elements, so the content of a script element is interpreted as markup.  </s>
<s> To keep the script readable, one could use a CDATA section, but there is no must to do so, you can use if (a  b) too.  </s>
<s> Further, this is only necessary if the script includes characters, that need to be escaped.  </s>
<s> The problem is, that current browsers don't know CDATA sections and ignore the script completly.  </s>
<s> I've suggested the following to get around this: !-- -- ![CDATA[ / !-- for (var i=0; i  10; i++) { ... } // -- !  </s>
<s> ]] Tidy should offer an option to extract the script and put it into a seperate file.  </s>
<s> Bj?rn H?hrmann ^ mailto:bjoern@hoehrmann.de ^ http://www.bjoernsworld.de am Badedeich 7 ?  </s>
<s> Telefon: +49(0)4667/981ASK ?  </s>
<s> http://bjoern.hoehrmann.de  </s>
<s> 25899 Dageb?ll # PGP Pub.  </s>
<s> KeyID: 0xA4357E78 # http://learn.to/quote  </s>
<s> [!]e "Everything we see or seem is but a dream within a dream" - E.A. Poe  </s>
<s> Examples of corections: enclosed script content in CDATA, adding a white space in empty comments ( ie : from ---- to -- -- ) .  </s>
<s> Presumably from !---- to !-- -- That most certainly should not be necessary.  </s>
<s> The definition of a comment in SGML is basically / !(--([^-]|-[^-])*--\s*)* / In particular, ! is a comment, !--foo-- --bar-- is a comment, and !---- is a comment.  </s>
<s> XML is supposed to make precisely two changes to this: (a) there must be exactly one chunk (b) trailing space is not allowed after that chunk, So the definition of a comment in XML is / !--([^-]|-[^-])*-- / I do understand that a lots a w3c specs implementations are rather fuzzy.  </s>
<s> I do not want to argue about it.  </s>
<s> ( especially, because I am likely to be wrong quite often...) "Rather fuzzy" is an extremely generous way of describing quite a few of them; the people who worked out how to formally specify software appear to have lived in vain.  </s>
<s> But in the case of XML comments, there is not the slightest fuzziness.  </s>
<s> Here is the actual rule: [15]Comment = ' !--' ((Char - '-') | ('-' (Char - '-')))* '-- ' There is admittedly a note: [E27]Note that the grammar does not allow a comemnt ending in --- .  </s>
<s> This is *not* an additional constraint; it is supposed to be explaining what the *grammar* already forbids.  </s>
<s> As it stands, it is wrong, but the associated example makes it clear that the author of the note did not have !---- in mind.  </s>
<s> Nor, for that matter, is there anything in XHTML that requires a script to have its content enclosed in CDATA.  </s>
<s> There *is* advice, appendix C.4, that says C.4 Embedded Style Sheets and Scripts.  </s>
<s> Use external style sheets if your style sheet uses  or &amp; or ]] or --. Use external scripts if your script uses  or &amp; or ]] or --.  </s>
<s> Note that XML parsers are permitted to silently remove the contents of comments.  </s>
<s> Therefore, the historical practice of "hiding" scripts and style sheets within comments to make the documents backward compatible is likely to not work as expected in XML-based implementations.  </s>
<s> Section 4.8 says that you *MAY* use CDATA, not that you *must*: 4.8 Script and Style elements In XHTML, the script and style elements are declared as having #PCDATA content.  </s>
<s> As a result,  and &amp; will be treated as the start of markup, and entities such as  and &amp;amp; will be recognized as entity references by the XML processor to  and &amp; respectively.  </s>
<s> Wrapping the content of the script or style element within a CDATA marked section avoids the expansion of these entities.  </s>
<s> CDATA sections are recognized by the XML processor and appear as nodes in the Document Object Model, see Section 1.3 of the DOM Level 1 Recommendation [DOM].  </s>
<s> An alternative is to use external script and style documents.  </s>
<s> Since most browsers out there do NOT support XHTML, I wonder whether using external scripts would not be the simplest device?  </s>
<s> There is a real incompatibility between HTML and XHTML here.  </s>
<s> In HTML, we have which says that the *only* significant markup within a SCRIPT is the / that closes it.  </s>
<s> But in XHTML, since XML does not support CDATA elements, we have which says that markup *may* occur inside a SCRIPT .  </s>
<s> External scripts have got to be *the* simplest way to work around this!  </s>
