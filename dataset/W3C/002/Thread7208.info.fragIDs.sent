<s> "I'm suprised that some people think that the reason that I've supported range locking is because GroupWise uses the feature, GroupWise does not.  </s>
<s> In the early days SoftSolutions did, but that is behind us.  </s>
<s> " You sound like a person who has learned from experience that byte-range locking has some problems, and you seem happy to report that GroupWise doesn't use it.  </s>
<s> I can agree that a lot of people and products have used byte-range locking.  </s>
<s> Would you agree that it's often been merely expedient, rather than being a good idea architecturally?  </s>
<s> --Mark  </s>
<s> No, I don't feel that expediency is the issue.  </s>
<s> Clustering (granularization) is a common method of handing shared things.  </s>
<s> In many operating systems the easiest way to do this is to use byte range locking.  </s>
<s> It is a quick way of creating a shared semaphore.  </s>
<s> As far as having "problems" with range locking, this can be said of most all mechanisms  </s>
<s> that are used.  </s>
<s> Each mechanism has it's up- and down-side.  </s>
<s> Sharing a file and allowing  </s>
<s> multiple writers (not simultaneous) requires some shared attribute with an owner.  </s>
<s> Again, byte range locking has it's place.  </s>
<s> -src  </s>
<s> Mark_Day/CAM/Lotus@lotus.com 02/24/97 08:13AM  </s>
<s> "I'm suprised that some people think that the reason that I've supported range locking is because GroupWise uses the feature, GroupWise does not.  </s>
<s> In the early days SoftSolutions did, but that is behind us.  </s>
<s> " You sound like a person who has learned from experience that byte-range locking has some problems, and you seem happy to report that GroupWise doesn't use it.  </s>
<s> I can agree that a lot of people and products have used byte-range locking.  </s>
<s> Would you agree that it's often been merely expedient, rather than being a good idea architecturally?  </s>
<s> --Mark  </s>
<s> Would someone like to provide a summary of the discussion so far on range locking?  </s>
<s> We have heard several arguments for and against range locking -- it would be valuable to collect them in one message.  </s>
<s> - Jim  </s>
<s> The web is an unusual operating system, though.  </s>
<s> (The Internet is an unusual computer.)  </s>
<s> In Webdav, we've been pursuing using links and site maps to do clustering, and it seems that so far we can handle these issues by having separate resources with a relationship between them, and having the lock operation work on the separate URLs.  </s>
<s> It might be that in one implementation "http://server.dom/resource/bytes=1-12" is a byte range of "http://server.dom/resource",  </s>
<s> but we don't need to standardize on that, only the relationship between them.  </s>
<s> Clearly we have to address the container/contained relationships, that locking a chapter has some effect on the lock state of the entire book.  </s>
<s> If we can handle the relationship at the larger granularity, we probably should use the same mechanism for dealing with locks even with a finer grain.  </s>
<s> Larry  </s>
<s> "My focus is on back-end issues especially where it deals with legacy systems exposing their functionality via WebDAV.  </s>
<s> I agree with what you pointed out when it pertains to Internet documents, however, the argument does not hold water when exposing a non-web based document repository where data structures other than file systems are used to organize documents and provide access."  </s>
<s> I guess that I don't understand why byte range locks are singled out for special treatment among all the flavors of legacy system behaviors that one might choose to support in WebDAV.  </s>
<s> Why not hardware pages?  </s>
<s> Unix inodes?  </s>
<s> nodes in a B-tree index?  </s>
<s> All of these seem to me to have the same character as byte ranges: they have no necessary connection to the semantic structure of a document or document collection, and they are used by various legacy repositories and databases to implement forms of locking.  </s>
<s> --Mark Day Mark_Day@lotus.com  </s>
<s> I realize that many in this group are focused exclusively on Internet issues.  </s>
<s> My focus is on back-end issues especially where it deals with legacy systems exposing their functionality via WebDAV.  </s>
<s> I agree with what you pointed out when it pertains to Internet documents, however, the argument does not hold water when exposing a non-web based document repository where data structures other than file systems are used to organize documents and provide access.  </s>
<s> If we are only concerned with Internet resource documents then we can dump a whole truck load of concerns, we can also expect that WebDAV will not be the mechanism to expose the multitudes of documents held in back-end document repositories.  </s>
<s> -src  </s>
<s> Larry Masinter masinter@parc.xerox.com  </s>
<s> 02/25/97 06:23AM  </s>
<s> The web is an unusual operating system, though.  </s>
<s> (The Internet is an unusual computer.)  </s>
<s> In Webdav, we've been pursuing using links and site maps to do clustering, and it seems that so far we can handle these issues by having separate resources with a relationship between them, and having the lock operation work on the separate URLs.  </s>
<s> It might be that in one implementation "http://server.dom/resource/bytes=1-12" is a byte range of "http://server.dom/resource",  </s>
<s> but we don't need to standardize on that, only the relationship between them.  </s>
<s> Clearly we have to address the container/contained relationships, that locking a chapter has some effect on the lock state of the entire book.  </s>
<s> If we can handle the relationship at the larger granularity, we probably should use the same mechanism for dealing with locks even with a finer grain.  </s>
<s> Larry  </s>
<s> You are right, the protocol does not need to deal with the range lock.  </s>
<s> If needed it can be performed at the resource level.  </s>
<s> If a DMS manages documents via a database then the resource name becomes the access name for the document.  </s>
<s> I believe we are no longer at cross purposes.  </s>
<s> -src  </s>
<s> Larry Masinter masinter@parc.xerox.com  </s>
<s> 02/25/97 07:51AM  </s>
<s> Steve, You keep on talking about function, and I'm talking about protocol.  </s>
<s> The issue isn't whether the function needs to get exposed, the issue is whether the protocol needs to be aware of it.  </s>
<s> I don't see any good reason why the protocol needs to get more complicated to deal with "byte range locking" when "resource locking" covers it, because a "byte range" can be a "resource".  </s>
<s> Is there really a disagreement, or are we just talking at cross purposes?  </s>
<s> Larry  </s>
<s> This is interesting.  </s>
<s> Byte ranges are indpendently cacheable, as are multiple representations of the same resource, but unless I'm misunderstanding something fundamental, they don't have URIs.  </s>
<s> It seems here that the difficulty comes from the assumption that a lockable resource must be uniquely identified through a URI.  </s>
<s> gjw@wnetc.com  </s>
<s> / http://www.wnetc.com/home.html  </s>
<s> If you're going to reinvent the wheel, at least try to come up with a better one.  </s>
<s> Byte ranges (in HTTP range retrieval) don't apply to resources.  </s>
<s> They apply to entities.  </s>
<s> An entity is the data stream that you get when you perform a GET operation.  </s>
<s> Servers are free to ignore byte range requests and deliver the entire entity rather than the indicated range.  </s>
<s> Resources don't have "byte ranges".  </s>
<s> Entities are immutable.  </s>
<s> They don't change.  </s>
<s> Since they don't change, it doesn't make sense to lock one or even lock part of one.  </s>
<s> That's why locking byte ranges doesn't make sense, even though you might think of having one resource which is a particular byte range of another resource and locking _that_.  </s>
<s> (Yaron, your example is broken because "#" is not a valid character in URLs.)  </s>
<s> Goal: To provide locking for defined subsections of a document Problem: DAV only supports locking on URLs, as URLs are given to a resource as a whole, DAV can not currently handle a partial lock Solution: Give subsections URLs.  </s>
<s> Example: Byte Ranges - A client searches for the attribute "xssdfsyhw30rwfwofjslfihleihfsfe" which is a token meaning "I give you permission to mangle the URL for this resource to point to a byte range in a defined way, specifically, you may add a "#" followed by a number, followed by a dash, followed by another number".  </s>
<s> The client then sends 23 are locked.  </s>
<s> Obviously the example doesn't provide all the semantic requirements but it is just a taste of the underlying mechanism.  </s>
<s> Problem: Mangling Overload.  </s>
<s> It is very nice and good to mangle a URL w/permission from the server, but at some point the various mangling mechanisms are going to run into each other.  </s>
<s> Potential Solution: A byte range method called ByteHead =).  </s>
<s> A range header is included to specify the byte range, although it can be used to specify any arbitrary range such as chapter or page.  </s>
<s> The request-URI is the request-URI of the resource.  </s>
<s> The response contains a content-location header which is the URL pointing to the relevant range.  </s>
<s> The rest of the response contains the same thing as a HEAD request done on the URL contained in content-location.  </s>
<s> Problem: Two round trips for every single lock request.  </s>
<s> Solution: A convenience method which combines ByteHead with Lock, we can call it LocksByte.  </s>
<s> Yaron  </s>
<s> Larry Masinter masinter@parc.xerox.com  </s>
<s> 02/25/97 07:51AM  </s>
<s> This is interesting.  </s>
<s> Caching in HTTP works precisely because it implememnts the immutable file model of a distributed file system...or at least that's the way I tend to think about it.  </s>
<s> Your point that entities are immutable and reources are not is, of course, correct.  </s>
<s> The difference is that I think of the combination of a resource and a validator for that resource (think of it as a version, something like a version number of an OpenVMS file) as the immutable object.  </s>
<s> I'm not sure about this one.  </s>
<s> Certainly, if a resource is modified, a byte range may become an inaccurate representation of that resource (or, perhaps I should say valid entity), and in this sense I agree with you.  </s>
<s> But byte range requests are made against resources and not entities.  </s>
<s> It seems that the real point is that the link between a byte range and a reource is a transient thing, whereas the link between a byte range and an entity is permanent.  </s>
<s> I'm not quite sold.  </s>
<s> As I indicated in an earlier message, it may be that a byte range lock is not a useful concept, but it is still meaningful.  </s>
<s> For the purposes of this post I will define a version of a reource to be a resource together with a unique validator for that resource.  </s>
<s> With this definition, it makes sense to require that new versions of a resource can only be created subject to the constraint that the byte range 0-500 is the same for both versions.  </s>
<s> (I know this use of version is not consistent with WEBDAV terminology, but it saves a lot of words.) Surely, this is a meaningful requirement.  </s>
<s> Is it a useful concept?  </s>
<s> I don't know.  </s>
<s> The problem is that byte ranges need to be independently cacheable or there is no advantage in locking a byte  </s>
<s> range instead of locking the whole resource.  </s>
<s> The problem is that if resource R is represented by a 1000 byte entity, and person A has already obtained byte ranges B1 and B2 representing bytes 0-500 and 501-1000 respectively, and both are available in cache, then if that person wants to GET the resource (not a byte range), then the corresponding entity E is the union of B1 and B2, and so it should not be necessary to transer the whole entity, a revalidation should be sufficient.  </s>
<s> But how can this be done?  </s>
<s> Even if the byte ranges have their own validators e1 and and e2, there is no relationship between the pair (e1,e2) and a validator e for R.  </s>
<s> (Sorry for all the "symbol speak".  </s>
<s> I guess my background in mathematics is catching up with me.) gjw@wnetc.com  </s>
<s> / http://www.wnetc.com/home.html  </s>
<s> If you're going to reinvent the wheel, at least try to come up with a better one.  </s>
<s> What you were calling a "validator" is called an "ETag" in HTTP/1.1 (because we got into a knot over the meaning of 'validation'), and the ETag for a "version" of a resource is for the whole resource and not for any particular byte range.  </s>
<s> The ETag returned is that for the entire entity and not for the subranges.  </s>
<s> It was important that caches be able to stitch together whole entities from partial ranges in order to satisfy subsequent requests.  </s>
<s> So byte ranges *don't* have their own "validators".  </s>
<s> Right, and I intentionally chose validator instead of entity tage because I was referring to a non-existant validation mechanism.  </s>
<s> This is another way of saying the same thing.  </s>
<s> If entity tags refer to entire entities, then it is possible to build an entity out of individually cached subranges.  </s>
<s> My point was simply that if modifying a resource doesn't invalidate all cached subranges (even those not affected), then there is no way to know if a union of subranges will be equal a valid (up to date) entity.  </s>
<s> I then concluded that there is nothing to be gained by locking a subrange (whtever that might mean) because the entity tag will change with an update, and so even byte ranges which are disjoint from the affected range will become invalid.  </s>
<s> gjw@wnetc.com  </s>
<s> / http://www.wnetc.com/home.html  </s>
<s> If you're going to reinvent the wheel, at least try to come up with a better one.  </s>
