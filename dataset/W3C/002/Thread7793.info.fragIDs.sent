<s> How can a WebDAV server support MKCOL if the repository the server is  </s>
<s> built upon assigns names to newly created collections (as opposed to allowing clients to specify the name)?  </s>
<s> Put another way, how can a  </s>
<s> client create a collection on a WebDAV server using MKCOL if the  </s>
<s> collection that gets created must be assigned a URI by the server?  </s>
<s> For example, suppose that each collection is assigned an ID that is  </s>
<s> unique to the database that underlies the WebDAV server and this ID is  </s>
<s> used to identify the collection in a URI (e.g., collection, it must issue a MKCOL request to server essentially controls the namespace, not the client, the client  </s>
<s> can't know what to send for NEW_NAME.  </s>
<s> Am I missing some important piece of information here?  </s>
<s> I assume that  </s>
<s> document management systems might be likely to encounter this kind of  </s>
<s> problem.  </s>
<s> If so, has anyone dealt with it?  </s>
<s> Although it doesn't seem to be explicitly forbidden, I am assuming that it is inappropriate for the server to ignore the name in the request-URI and respond with a Location header that identifies the name assigned by the server.  </s>
<s> Though this seems like a possible solution, it seems contrary to the intent expressed in the spec.  </s>
<s> Or am I wrong in this assumption?  </s>
<s> Brian Stiles  </s>
<s> It can't.  </s>
<s> MKCOL is defined as creating the collection specified by the Request-URI.  </s>
<s> If your server doesn't do that, it it isn't MKCOL :-)  </s>
<s> Is it possible for you to create (internally) the server-specified collection and then somehow link/alias the Request-URI to point to the new collection?  </s>
<s> If you have a custom client, then you can define a method such as "STARBASE-MKCOL" which is modelled after MKCOL, but returns a Location header with the true URI.  </s>
<s> Another alternative is to return the "next-collection-name" as a property of the parent collection; this has transactional problems, though (e.g. what happens if two clients request the property and then use it in MKCOL?)  </s>
<s> Cheers, -g Greg Stein, http://www.lyra.org/  </s>
<s> Thanks for the quick response.  </s>
<s> It's problematic because we are trying to make use of a legacy repository that has some inconsistencies with the WebDAV model and we are trying not to modify the repository code.  </s>
<s> In particular, if you use the repository-assigned ID's of the objects in the repository for the URI, then you can have proper URI's for each object, but you can't create new collections with MKCOL for the aforementioned reason.  </s>
<s> If you use the user-assigned name of each object in the repository, you can't have proper URI's for each object in the repository because there can be multiple objects in one collection that have the same name.  </s>
<s> After thinking about your suggestion, it appears we have two choices.  </s>
<s> We could use the user-assigned names of collections in the MKCOL request-URI and also assign the new collection a URI based on the repository-assigned ID's.  </s>
<s> Or, perhaps a better approach would be to consider it a flaw in the repository that two objects in the same collection can have the same name and just disallow access via WebDAV to all but one of the objects with the same name.  </s>
<s> That is problematic indeed in our case.  </s>
<s> I think I'd rather bend my product to work with the protocol than extend the protocol to work with my product.  </s>
<s> Thanks again.  </s>
<s> Brian Stiles  </s>
<s> I agree with you that this is a problem for all document management systems.  </s>
<s> I believe it is the most fundamental mismatch between the WebDAV operational model and the way document management systems work.  </s>
<s> It affects not only MKCOL, but all methods that result in the creation of new resources (COPY, MKREF, PUT, MKRESOURCE).  </s>
<s> It's also wound up with the requirement that WebDAV resource names reflect the collection hierarchy, which the server-generated names in document management systems generally do not do.  </s>
<s> Document Management Systems will probably be forced to do aliasing between client names and server names, no matter how costly and annoying that turns out to be.  </s>
<s> --Judy Judith A. Slein Xerox Corporation jslein@crt.xerox.com  </s>
<s> (716)422-5169 800 Phillips Road 105/50C Webster, NY 14580  </s>
<s> This is an old and well known issue that many people mistakenly think is solved.  </s>
<s> The server is completely free to return to a PUT or MKCOL with a 200 O.k.  </s>
<s> and throw on a location header which points to the "real name" of the new  </s>
<s> resource while throwing away the client's proposed name.  </s>
<s> In practice no server I'm aware of does this and no client I'm aware of could properly handle this.  </s>
<s> If memory serves this issue is already on the WebDAV open issues list.  </s>
<s> Personally I think we should just adopt current practice which says that you must either accept the name or reject the request but that is just my $0.02.  </s>
<s> Yaron  </s>
<s> Make the $0.04 (i.e.  </s>
<s> I agree with Yaron).  </s>
<s> Cheers, Geoff  </s>
<s> yg The server is completely free to return to a PUT or MKCOL with a yg 200 O.k. and throw on a location header which points to the "real yg name" of the new resource while throwing away the client's yg proposed name.  </s>
<s> I don't think that's so.  </s>
<s> (Nit #1 is that "201 Created" is the response for a new resource.)  </s>
<s> More importantly, RFC-2068 has specific language about this situation for PUT (the following compares PUT to POST): In contrast, the URI in a PUT request identifies the entity enclosed with the request -- the user agent knows what URI is intended and the server MUST NOT attempt to apply the request to some other resource.  </s>
<s> If the server desires that the request be applied to a different URI, it MUST send a 301 (Moved Permanently) response; the user agent MAY then make its own decision regarding whether or not to redirect the request.  </s>
<s> I agree that a precise reading of the RFC-2518 definition of MKCOL allows a 201 response with a LOCATION: header, but one certainly has the impression from RFC-2518 that "MKCOL is just like PUT, but there is no enclosed entity comprising the contents of the new resource".  </s>
<s> If it is the intent that MKCOL differ from PUT is this fairly significant respect, I suggest that appropriate clarifying language be added, but I don't particularly see why such a difference should exist.  </s>
<s> The RFC-2068 specified behavior for PUT could be used to solve the problem of server-generated collection names if applied to MKCOL.  </s>
<s> When issuing the LOCATION: header, the server could secretly keep a record (with a timeout) of the fact that it had been sent.  </s>
<s> A couple hundred milliseconds later, the redirected request comes in with the same credentials and succeeds.  </s>
<s> If no redirected request comes within some timeout, the collection name could be harvested.  </s>
<s> bill@carpenter.ORG  </s>
<s> (WJCarpenter) PGP bill@bubblegum.net  </s>
<s> 0x91865119 38 95 1B 69 C9 C6 3D 25 73 46 32 04 69 D6 ED F3  </s>
<s> I like it.  </s>
