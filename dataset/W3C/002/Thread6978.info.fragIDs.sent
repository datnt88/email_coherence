<s> Hello everyone, I've just recently joined the uri@w3.org  </s>
<s> list, and so apologize in advance if this subject has been been discussed before (I reviewed the archives but couldn't find an answer, although I imagine it's been tacked before).  </s>
<s> I wonder if un-escaped colons are legal in the path portion of a URL so  </s>
<s> long as they're not in the scheme or domain?  </s>
<s> For example:  </s>
<s> I ask because our Web3D Universal Media Working Group uses URNs for media referencing, which we'd like to extend to single URL environments such as standard HTML browsers and authoring tools (our use of URNs is based on the VRML97 ISO standard, which supports multiple URLs/URNs).  </s>
<s> The two URLs above show how we might embed a URN into a URL so that the media can be resolved via http (over the net) by products that don't understand Universal Media (just like a normal URL) while also giving products that understand our system what they need to know in order to fetch the media from the user's local system (the URN identifier "urn:web3d:media:" is the key; this tells Universal Media products that a piece of media is likely be be locally resident and so they'll attempt to resolve it locally first before trying the Web).  </s>
<s> I chair the Universal Media Working within the Web3D Consortium, and I'd like to extend our media system to URL/URI environments *without* conflicting with standard use of URIs/URLs.  </s>
<s> If you'd like some background on our work before commenting please feel free to visit our site at: To see how we deal with URNs, you can read our recommended practice: see "VRML, URNs and Universal Media Recommended Practice Proposal" Below my signature is a message I recently sent to our group regarding using colons in URLs so that our URNs can be used by a wider audience.  </s>
<s> I've since read rfc2396 again and would like to know if it's possible to include colons in URLs without escaping them, like these: Is this legal so long at the colon appears in the path (as above) and not in the scheme or domain?  </s>
<s> With thanks for your advice, Aaron Aaron E. Walsh http://www.mantiscorp.com/people/aew/  </s>
<s> 617.350.7119  </s>
<s> Subject: Colons in URIs (rfc2396) for Universal Media URNs in URLs Date: Wed, 16 Aug 2000 15:34:02 -0400 From: "Aaron E. Walsh" aaron@mantiscorp.com  </s>
<s> Content Working Group content@web3d.org  </s>
<s> Hello everyone, I haven't read rfc2396 in great detail yet, but after a few quick passes it looks like our use of colons in URLs for the purpose or transparently encoding URNs is legal as long as we escape them (escape the colons).  </s>
<s> I wonder if anyone else comes to the same conclusion, or different?  </s>
<s> Following is are three excerpts (sections 2.2, 3, and from rfc2396 that made me think we're ok as long as our colons are escaped (look for !!!!!  </s>
<s> at the very bottom of this message where I explain what makes me think so).  </s>
<s> Please note that I plan to ask for comment from the W3C URI group as well (after more investigation), but would first prefer to have feedback from our own community.  </s>
<s> ---- Excerpts from "Uniform Resource Identifiers (URI): Generic Syntax" See: http://www.ietf.org/rfc/rfc2396.txt  </s>
<s> 2.2.  </s>
<s> Reserved Characters Many URI include components consisting of or delimited by, certain special characters.  </s>
<s> These characters are called "reserved", since their usage within the URI component is limited to their reserved purpose.  </s>
<s> If the data for a URI component would conflict with the  </s>
<s> reserved purpose, then the conflicting data must be escaped before  </s>
<s> forming the URI.  </s>
<s> reserved = ";" | "/" | "?" | ":" | "@" | "&amp;" | "=" | "+" | The "reserved" syntax class above refers to those characters that are allowed within a URI, but which may not be allowed within a particular component of the generic URI syntax; they are used as delimiters of the components described in Section 3. 3. URI Syntactic Components The URI syntax is dependent upon the scheme.  </s>
<s> In general, absolute URI are written as follows: An absolute URI contains the name of the scheme being used ( scheme ) followed by a colon (":") and then a string (the scheme-specific- part ) whose interpretation depends on the scheme.  </s>
<s> The URI syntax does not require that the scheme-specific-part have any general structure or set of semantics which is common among all URI.  </s>
<s> However, a subset of URI do share a common syntax for representing hierarchical relationships within the namespace.  </s>
<s> This "generic URI" syntax consists of a sequence of four main components: each of which, except scheme , may be absent from a particular URI.  </s>
<s> For example, some URI schemes do not allow an authority component, and others do not use a query component.  </s>
<s> absoluteURI = scheme ":" ( hier_part | opaque_part ) URI that are hierarchical in nature use the slash "/" character for separating hierarchical components.  </s>
<s> For some file systems, a "/" character (used to denote the hierarchical structure of a URI) is the delimiter used to construct a file name hierarchy, and thus the URI path will look similar to a file pathname.  </s>
<s> This does NOT imply that the resource is a file or that the URI maps to an actual filesystem pathname.  </s>
<s> hier_part = ( net_path | abs_path ) [ "?" query ] net_path = "//" authority [ abs_path ]  </s>
<s> abs_path = "/" path_segments URI that do not make use of the slash "/" character for separating hierarchical components are considered opaque by the generic URI parser.  </s>
<s> opaque_part = uric_no_slash *uric uric_no_slash = unreserved | escaped | ";" | "?" | ":" | "@" | "&amp;" | "=" | "+" | "$" | "," We use the term path to refer to both the abs_path and opaque_part constructs, since they are mutually exclusive for any given URI and can be parsed as a single component.  </s>
<s> 3.3.  </s>
<s> Path Component The path component contains data, specific to the authority (or the scheme if there is no authority component), identifying the resource within the scope of that scheme and authority.  </s>
<s> path = [ abs_path | opaque_part ] path_segments = segment *( "/" segment ) segment = *pchar *( ";" param ) param = *pchar pchar = unreserved | escaped | ":" | "@" | "&amp;" | "=" | "+" | "$" | "," The path may consist of a sequence of path segments separated by a single slash "/" character.  </s>
<s> Within a path segment, the characters "/", ";", "=", and "?" are reserved.  </s>
<s> Each path segment may include a sequence of parameters, indicated by the semicolon ";" character.  </s>
<s> The parameters are not significant to the parsing of relative references.  </s>
<s> !!!!! If I read the above correctly, in particular the frist 2 sentences of the very last paragraph immediately above (after considering the previous material) then ":" is not a reserved character when used within a path segment.  </s>
<s> But the following definition implies that our colons should be escaped, I think: pchar = unreserved | escaped | ":" | "@" | "&amp;" | "=" | "+" | "$" | "," Do others gather the same from the RFC and these sections?  </s>
<s> If not, what's your take on our use of colons in URLs when used to transparently embed a URN like so: Comments?  </s>
<s> Aaron Aaron E. Walsh http://www.mantiscorp.com/people/aew/  </s>
<s> 617.350.7119  </s>
<s> According to 2396 and my personal experience its legal.  </s>
<s> From the ABNF: absoluteURI = scheme ":" ( hier_part | opaque_part ) hier_part = ( net_path | abs_path ) [ "?" query ] abs_path = "/" path_segments path_segments = segment *( "/" segment ) segment = *pchar *( ";" param ) pchar = unreserved | escaped | ":" | "@" | "&amp;" | "=" | "+" | "$" | "," Which means that pchar says that an unencoded ':' is fine in the path segment... Yep.  </s>
<s> I've seen that used before.  </s>
<s> The PDI URN space uses it...  </s>
<s> From my reading, yes...  </s>
<s> BTW, now that there is a URN registration process would it be to much trouble to have this one registered?  </s>
<s> It just needs a short RFC on what the space is and how its managed.  </s>
<s> See RFC 2611.... -MM Michael Mealling| Vote Libertarian!  </s>
<s> | www.rwhois.net/michael  </s>
<s> Sr. Research Engineer | www.ga.lp.org/gwinnett | ICQ#: 14198821 Network Solutions| www.lp.org | michaelm@netsol.com  </s>
<s> Hi Michael, thanks for your fast reply.  </s>
<s> I'm glad to hear that you think we'll be able to use colons in our URLs without escaping them, which in turn allows us to cleanly embed our URNs into URLs for HTML and other single-URL and URN unaware apps (Web browsers, in particular!). Leslie has also suggested that we register the Web3D URN, which I'll do this month.  </s>
<s> Do you think it makes sense to include the URN embedded in URL examples (such as those below), or just the URN syntax/usage in our registration RFC?  </s>
<s> Best regards, Aaron Aaron E. Walsh http://www.mantiscorp.com/people/aew/  </s>
<s> 617.350.7119  </s>
<s> Aaron Aaron E. Walsh http://www.mantiscorp.com/people/aew/  </s>
<s> 617.350.7119  </s>
<s> Hello Aaron,  </s>
<s> Michael answered this one, yes they are legal (and don't need to be escaped).  </s>
<s> These look definitely like legal URIs.  </s>
<s> While the syntax is okay, this may not exactly work.  </s>
<s> The above are http URIs, and the fact that they contain 'urn:web3d:media:' as one of their path components doesn't make any difference.  </s>
<s> For the HTML browsers, this would work out because they just send a request to www.web3dmedia.com  </s>
<s> with /urn:web3d:media:..., and www.web3dmedia.com is allowed to treat this in any way it wants (and may even have set up a directory named urn:web3d:media: just to make work easy on the server side).  </s>
<s> However, the other way round is a bit more difficult.  </s>
<s> How is VRML software supposed to treat this differently?  </s>
<s> Looking at the first path component and treating it as an URN if it starts with urn: is definitely wrong; it would go havoc if somebody decided to use something like http://www.example.com/urn:web3d:media,  </s>
<s> which is a perfectly good straight old http URI.  </s>
<s> It is of course not forbidden to define such behavior for a single (or a few) well known domain name(s), just as proxy/caching behavior, this may not exactly be what you want (but it may be all you can get).  </s>
<s> Regards, Martin.  </s>
<s> Hi Martin, thanks for your reply and confirmation that colons in the path of URLs is legal...  </s>
<s> Great.  </s>
<s> That makes our job much easier...  </s>
<s> Yes, that's exactly what we did (created a folder on the server named "urn:web3d:media:", which flies on all platforms except Windows as that OS doesn't allow colons in names).  </s>
<s> Actually that's exactly the behavior we want; products that don't know about our URNs treat the above URL like an ordinary URL (fetch via http), whereas VRML browsers and other Universal Media aware programs see "urn:web3d:media:" and extract the entire URN based on the path that follows, and resolve it locally (using http as a "fallback" if the resource isn't already locally installed).  </s>
<s> For example: Looks like "urn:web3d:media:/textures/nature/grass_1.jpg" to Universal Media savvy products, but like a normal URL to all others.  </s>
<s> We also *want* to let anyone include "urn:web3d:media:" in their Web URLs so that they can host the textures, sounds, and 3D objects in our standard libraries directly from their own sites.  </s>
<s> Standard browsers (like Navigator, IE, WebTV, etc.) just fetch the resource from the URL (their site), whereas URN-savvy products parse out the embedded URN and grab the local copy instead.  </s>
<s> This allows our system to be massively scalable (anyone can host our standard media libraries on their site by creating a folder "urn:web3d:media:" and placing the library contents into it, taking the load of our main server and official mirrors for all cases except when the the URN is really used; in this case the media is either fetched 1) locally or 2) from the official site or an official mirror).  </s>
<s> We won't parse for anything other than "urn:web3d:media:" (notice the three colons are required) as that is part of our naming scheme.  </s>
<s> If we omitted the last colon, for example, and just parsed for "urn:web3d:media" (as you have above, although I'm not sure if the last colon was intentionally omitted?) then we could run into conflict with future Web3D Consortium working groups (if a wg named having the "mediaplayer" identifier in our consortium was created, for example, they'd have "urn:web3d:mediaplayer:" -- by not including the final ":" the parsing would be too ambiguous).  </s>
<s> So, our intent is to give valid URLs to standard browsers, and embedded URNs to Web3D products and other products that want to utilize our shared, persistent cache.  </s>
<s> By intentionally encouraging end users to host our library, using their own URLs (i.e, media libraries without losing the intent of our system (fetching locally when possible, using an official site or official mirror to install the reference element if the product is capable of doing that, or just fetching from that user's own site in the case of standard Web browsers and other products that don't utilize Universal Media).  </s>
<s> Regards, Aaron Aaron E. Walsh http://www.mantiscorp.com/people/aew/  </s>
<s> 617.350.7119  </s>
