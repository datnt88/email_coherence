<s> I suppose I should point out the following:  </s>
<s> Consider Rich Himes' scenario in which a signed resource must be moved from the inside to the outside of a surrounding document.  </s>
<s> On the inside it is base64 encoded and in some Object X, so it must be identified by an XPath of part should we decide to keep IDREF).  </s>
<s> *After* the XPath transform, we need to base64 decode it.  </s>
<s> To move this resource to the outside of the document, we must throw out both the XPath transform (whether or not it locates X) and the base 64 decode transform.  </s>
<s> Further, the URI must change from "" to "something".  </s>
<s> If I were forced to do this with the current syntax, I would use a Manifest.  </s>
<s> In the core signature, the Manifest will be identified by an  </s>
<s> ObjectReference, which means that I can apply transforms to it (in the same  </s>
<s> way I described transforming SignedInfo).  </s>
<s> Since I can apply an XPath transform to the Manifest, I can use delete the specific things I need to  </s>
<s> delete from the Manifest (and maintain security by being quite precise about  </s>
<s> it using XPath) such that the DigestValue over the Manifest will not change if the Location and specific transforms are changed by the application.  </s>
<s> Thus, the crux of the matter is not whether we can solve Rich's problem.  </s>
<s> It is a question of whether core behavior or application specific behavior will be necessary to solve Rich's problem.  </s>
<s> The Location-as-hint and assertions-about-assertions ideas try to skate  </s>
<s> around the problem that core behavior cannot solve Rich's problem without introducing application-specific behavior *within* core behavior.  </s>
<s> I think that this is like going from the frying pan into the fire (at the very least, we haven't gotten out of the frying pan).  </s>
<s> What we should be saying is one of the following three: 1) Treat URI location as URL, allow signed XPath transform of SignedInfo, and everyone's problems are solved by core behavior (as I showed at FTF#3).  </s>
<s> 2) URI resolution is application specific, so we should move it to the Manifest and simplify the syntax.  </s>
<s> 3) A design limitation prevents the solution of problems in which the Location and/or some transforms must change.  </s>
<s> Applications needing to do this can still use XML signatures by using Manifests (as described above), but their signatures will require custom code to validate.  </s>
<s> The other solutions are hacks that accomplish #3 in a manner inconsistent with how we hope to capture other application-specific behaviors.  </s>
<s> John Boyer Software Development Manager UWI.Com -- The Internet Forms Company  </s>
<s> I think I'm leaning more towards John's XPath-on-SignedInfo solution than location-as-hint, but I'm still a bit uncomfortable with it.  </s>
<s> Speaking as a human, I'd really rather see everything in SignedInfo be signed, and not have to worry about applying transformations to it.  </s>
<s> I'm going to get very confused if bits of SignedInfo are omitted from the signature.  </s>
<s> On the other hand, I realize that sometimes people will want to sign a document's URI, and sometimes they won't (insert similar thoughts about transforms here).  </s>
<s> So we really do need a mechanism that allows us to omit pieces from what gets signed.  </s>
<s> I just think that a self-transforming  </s>
<s> SignedInfo is too confusing, that the stuff that gets transformed should be  </s>
<s> isolated.  </s>
<s> So I propose that John's solution using the current syntax -- that we use a  </s>
<s> Manifest -- be formally adopted.  </s>
<s> I'd go so far as to say that SignedInfo must only contain a single ObjectReference to a Manifest that is inside the Signature element, but not in SignedInfo.  </s>
<s> In other words, allow only a  </s>
<s> single IDREF ObjectReference inside SignedInfo.  </s>
<s> The SignedInfo reference to  </s>
<s> the Manifest could then contain various transformations on the Manifest to omit or include URIs and/or various transforms.  </s>
<s> This makes things a bit more explicit as to what's being directly signed, and  </s>
<s> what's being transformed in various ways.  </s>
<s> I'd like to make a point about the core behaviour resolving URIs.  </s>
<s> There are two ways to sign URIs, either: (a) as a pure reference, where whatever is retrieved from the URI isn't itself signed.  </s>
<s> A URI to retrieve a live audio stream would be a good example (see my message on the "Detached Signatures Vs Detached Objects" thread for a start at how to authenticate the retrieved data).  </s>
<s> Basically, in this case the URI is fixed but the data it points to can change.  </s>
<s> (b) as an absolute location for some data, where whatever is retrieved from the URI is also signed.  </s>
<s> In this case, both the URI and its document are fixed by the signature.  </s>
<s> For case (a), core behaviour needn't (and shouldn't) do anything to resolve the URI.  </s>
<s> For case (b) though, what's on the other end of the URI is vital to verifying the signature, and so core behaviour really has to know what's there.  </s>
<s> I have a couple of problems here.  </s>
<s> My first is that I'm not sure the current syntax allows us to differentiate between the two ways to sign URIs.  </s>
<s> (If it does, could someone please show me.) My second problem is that I can't see how, in case (b), the core behaviour can be expected to always be able to resolve the URI.  </s>
<s> HTTP isn't the only protocol on the planet, and it isn't practical for the core behaviour to be conversant in evey protocol.  </s>
<s> There are conceivably a myriad of private protocols that people might want to use with XML signatures.  </s>
<s> In practical terms, I don't see how the core library can do anything but ask the application to resolve a URI.  </s>
<s> Marc  </s>
<s> I Agree.  </s>
<s> If SignedInfo isn't always signed info, it's not intuitive and should  </s>
<s> have another name.  </s>
<s> I'd like to see it head in this direction also.  </s>
<s> Also, it is starting to look  </s>
<s> very messy to me.  </s>
<s> I'd like to see Object, Manifest, Package, and  </s>
<s> SignatureProperties combined in some way, preferably as the Manifest (in  </s>
<s> unsigned Signature if present).  </s>
<s> I'm not adverse to having multiple digests  </s>
<s> (object references) in SignedInfo, though, or allowing an optional direct  </s>
<s> reference, though it might be cleaner to always use a manifest.  </s>
<s> (Also, maybe  </s>
<s> location could be one of the optional SignatureProperties if one only wants to  </s>
<s> sign location and not content.)  </s>
<s> In the process, there are two core capabilities I need that John has mentioned, those are unfixed (movable) location and unfixed base64-decode (the ability to move a document internal to/from external and external to external without breaking the signature).  </s>
<s> Actually, this sounds like it should have been a basic requirement, not just for me but for the generic world of applications.  </s>
<s> It seems to me that this means the actual tags and attributes of Manifest and  </s>
<s> its sub-elements shouldn't automatically be hashed.  </s>
<s> Rather, the Manifest should  </s>
<s> call out the list of things to be included in the hash (or not, perhaps  </s>
<s> defaulting to include).  </s>
<s> I think it would be far more lucid to have an attribute  </s>
<s> in each Manifest entry that specifies (hash=?)include/exclude  </s>
<s> rather than use  </s>
<s> XPath (also an attribute to specify base64-decoding of element content).  </s>
<s> The  </s>
<s> actual object(s) could be embedded or targeted.  </s>
<s> I think SignatureProperties  </s>
<s> should be included in Manifest.  </s>
<s> If there is a requirement for a MegaManifest  </s>
<s> that is application-specific, we should give it another name, but Manifest should have core behavior for signature and authentication.  </s>
<s> Thanks, Rich  </s>
<s> look  </s>
<s> digests  </s>
<s> maybe  </s>
<s> wants to  </s>
<s> In my mind, an object is the element which we define as having an open content model.  </s>
<s> People can put whatever elements they want within an object  </s>
<s> element (or if people wanted to use schema classes, other things could be a  </s>
<s> subclass of an object).  </s>
<s> Manifest, package and signature properties are all different "applications"  </s>
<s> with different meanings that could be within an object (or a sub-type of).  </s>
<s> Manifest and  </s>
<s> should  </s>
<s> attribute  </s>
<s> use  </s>
<s> The  </s>
<s> SignatureProperties  </s>
<s> MegaManifest  </s>
<s> I think of a Manifest as a collection of resource/content references and I'm not sure what SignatureProperties has to do with that.  </s>
<s> SignatureProperties is a set of semantics related to the signature itself.  </s>
<s> (A specific place to make an assertion about the signature.) Joseph Reagle Jr. Policy Analyst mailto:reagle@w3.org  </s>
<s> XML-Signature Co-Chair http://www.w3.org/People/Reagle/  </s>
<s> I'm using the term "manifest" in the sense of "an invoice of cargo", that is, a list that clearly states what is and is not included in the signature, and provides us with more clarity and flexibility than we have with the current approach, while still allowing closure.  </s>
<s> Thanks, Rich  </s>
