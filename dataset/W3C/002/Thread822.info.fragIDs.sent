<s> I had simply assumed that under SGML rules, tags were closed when a new STAGO was seen, exempli gratia: !DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd" html head  </s>
<s> Quite some time ago, I posted patches to make this work.  </s>
<s> I seem to remember that is is disallowed by the HTML spec, but  </s>
<s> in any case won't work with existing web browsers.  </s>
<s> Regards, -- Dave Raggett dsr@w3.org or dave.raggett@openwave.com  </s>
<s> W3C Visiting Fellow, see http://www.w3.org/People/Raggett  </s>
<s> The W3C search does not work for me URL: Does it work for you?  </s>
<s> The archives are not (obviously) downloadable as for example these archives are.  </s>
<s> Almost all guides on asking questions suggests searching archives exempli gratia it is a good idea to follow a bit the mailing list or to read some of the mailing list archives before asking, to get aquanted to the culture of the list and not to get flamebated imediately.  </s>
<s> Often the list etiquette is explicitly listed on it's homepage or refered to in the subscription reply.  </s>
<s> Ben.  </s>
<s> I hope that I am not reading this backwards.  </s>
<s> If Tidy does not already do so is there a reason why it should not normalise sgml-valid unclosed tags?  </s>
<s> Surely one of the raison d'etres of Tidy is to fix syntactically valid but not browser ready mark-up?  </s>
<s> Ben  </s>
<s> Ben Fowler commented on html head and I remarked that  </s>
<s> Dave Raggett responded: I seem to remember that is is disallowed by the HTML spec,  </s>
<s> The SGML declarations in the HTML 3.2 and HTML 4.0 specifications very clearly disallow this (leaving out the  at the end of a tag when there is a following ).  </s>
<s> HOWEVER, the reason I sent patches way back when was that this pattern nevertheless occurs in some real HTML pages.  </s>
<s> but in any case won't work with existing web browsers.  </s>
<s> Yes, exactly.  </s>
<s> That's why it's nice for Tidy to fix it.  </s>
<s> I hesitate to take a position contrary to a co-author, and probably the senior author of the relevant documents, but my reading of URL: http://www.w3.org/TR/html401/appendix/notes.html#h-B.3.7 suggests that the relevant features are certainly allowed in HTML and are not even deprecated. the only warning is that some browsers do not support them.  </s>
<s> Do you have a URL for this?  </s>
<s> Ben  </s>
<s> bfowler@ewitness.co.uk (ewitness - Ben Fowler) very properly challenged this: Do you have a URL for this?  </s>
<s> The relevant part is section 20.1 "SGML Declaration" of http://www.w3.org/TR/html4/sgml/sgmldecl.html  </s>
<s> The SHORTTAG feature of SGML controls three things: (1) Empty tags  and / , where the generic identifier is inferred; empty end-tags make a lot of sense, but the rules for empty start-tags are sufficiently involved, not to say weird, that even a die-hard SGMLer would be wary of them.  </s>
<s> (2) Unclosed tags foo ... /foo ... where the  that closes a tag may be omitted "when it is followed immediately by another tag".  </s>
<s> (3) Null end tags foo/..../ where the start-tag ends with / and the end-tag is then simply /.  </s>
<s> I am very fond of these; I'd _much_ rather write em/this/ than em that /em .  </s>
<s> Now section B.3.7 says to avoid all of these things, and the simple way for the HTML designers to have been serious about that would have been for them to put "SHORTTAG NO" in the SGML declaration.  </s>
<s> It would have made it easy for people to check that their documents didn't use these features.  </s>
<s> In fact my local copy of HTML.dcl _was_ hacked to say SHORTTAG NO. Trouble is, I'm the one that hacked it, and I'd forgotten that.  </s>
<s> The _official_ SGML declaration says "SHORTTAG YES", thus explicitly requiring HTML processors to support these features that B.3.7 says not to use.  </s>
<s> Is it just me, or is that odd?  </s>
<s> SHORTTAG YES is there to allow input type="checkbox" checked instead of input type="checkbox" checked="checked" .  </s>
<s> Liam Quinn  </s>
<s> Thanks for jogging my memory.  </s>
<s> The HTML working group wanted to support the widespread practice of omitting quote marks around attribute values when these didn't include spaces.  </s>
<s> This forced SHORTTAG YES even though none of the browsers supported the other features implied by SHORTTAG YES.  </s>
<s> My advice is not to encourage authors to rely on short tags.  </s>
<s> Please don't extend Tidy to fully support shorttags.  </s>
<s> Regards, -- Dave Raggett dsr@w3.org or dave.raggett@openwave.com  </s>
<s> W3C Visiting Fellow, see http://www.w3.org/People/Raggett  </s>
<s> Thanks for jogging my memory.  </s>
<s> The HTML working group wanted to support the widespread practice of omitting quote marks around attribute values when these didn't include spaces.  </s>
<s> This forced SHORTTAG YES even though none of the browsers supported the other features implied by SHORTTAG YES.  </s>
<s> By Jove, he's right: "An attribute value specification can be an attribute value (that is, not an attribute value literal) only if it contains nothing but name characters and either: a) it occurs in an attribute definition list; or b) "SHORTTAG YES" is specified on the SGML declaration."  </s>
<s> Why on _earth_ would the SGML designers make this entirely harmless feature depend on SHORTTAG?  </s>
<s> As far as I can see, the only benefit is to make SGML parsers slower (because they'd have to make an otherwise unnecessary check of SHORTTAG) and to link this feature with an extremely dangerous one (  ).  </s>
<s> However, the fact that they _are_ linked means that people who develop HTML pages using an SGML parser to check them for validity (like me) still need to use HTML Tidy to check that  , / , x//, x y and so on are not used, because an SGML parser won't complain about them.  </s>
<s> Note in particular  </s>
<s> that Emacs' is a good HTML editor, but uses an SGML parser, so it's quite easy to slip in the odd em/item/ that should be tidied.  </s>
<s> This suggests that it would be a good thing for Tidy to recognise and eliminate at least some of the SHORTTAG features.  </s>
<s> In the case of nsgmls, it will complain if you use -wmin-tag on the command line.  </s>
<s> The WDG HTML Validator [*] uses this when warnings are enabled.  </s>
<s> [*] http://www.htmlhelp.com/tools/validator/  </s>
<s> Liam Quinn  </s>
<s> Liam Quinn liam@htmlhelp.com pointed out that people checking HTML  </s>
<s> with nsgmls can use the -wmin-tag option on the nsgmls command line.  </s>
<s> Many thanks for that, my scripts now do this.  </s>
<s> Interestingly enough, the test cases I tried (real web pages) have now convinced me that Tidy _shouldn't_ be made to clean up NET.  </s>
<s> Reason: This is in the "Hacker's Digest - Ten Things not to do if Arrested" page.  </s>
<s> Given the prevalence of / in URIs and things like this, and the prevalence of incorrectly omitted quotations marks (I've even seen pages generated by well known commercial HTML editors where there are attribute names with spaces in them...) it's obviously right that Tidy should treat / like a letter and not like NET.  </s>
<s> I therefore withdraw my remark that it would be nice if Tidy cleaned up SHORTTAG stuff in general.  </s>
<s> However, I _have_ run into br br and the like in real pages, so it's still a good idea to handle unclosed tags as well as possible.  </s>
<s> Tidy turns  into  and pretends nothing happened.  </s>
<s> Sure, it is usually what we want, but I just don't think it is right for tidy to use the same 'no errors found' message for a file that is completely unchanged when run thru tidy, v.s. one that gets changed.  </s>
<s> At least tell us "I changed something, not too important, use diff if you absolutely must see it."  </s>
<s> Tidy does warn about changes it makes to the document structure, e.g. adding missing tags.  </s>
<s> Since  and  are equivalent no warning message is issued.  </s>
<s> The output may be different even when the structure of the document is unchanged, and no entities have been converted -- in essence, tidy parses the document, builds an internal tree representation of the document and serializes the internal tree as HTML.  </s>
<s> There is no single "canonical" form for an HTML document, so even when no errors or warnings are reported you should always expect the output to look different from the input.  </s>
<s> Klaus Johannes Rusch KlausRusch@atmedia.net  </s>
<s> K Tidy does warn about changes it makes to the document structure, e.g. K adding missing tags.  </s>
<s> K Since  and  are equivalent no warning message is issued.  </s>
<s> K The output may be different even when the structure of the document is K unchanged, and no entities have been converted -- in essence, tidy K parses the document, builds an internal tree representation of the K document and serializes the internal tree as HTML.  </s>
<s> There is no single K "canonical" form for an HTML document, so even when no errors or K warnings are reported you should always expect the output to look K different from the input.  </s>
<s> Tidy not telling me that it changed  into  means that I have no way of telling if I have written good HTML or not.  </s>
<s> It is very important to me to know if I am careless enough to put raw  's into a file...  </s>
<s> I thought that I am skilled enough in HTML to make my own  </s>
<s> 's .  </s>
<s> If a  gets through then it was probably a typo and I want  </s>
<s> to know about it right away, instead of it getting swept under the carpet to sit embarrassingly on my web page for months.  </s>
<s> So, neatening the blanks, wrapping, etc. is fine and I don't need to be told about that.  </s>
<s> However, let's say the postman is so nice that he corrects addressing mistakes and adds extra stamps needed for my letters, but is too courteous to tell me.  </s>
<s> I want to be told!  </s>
<s> Add an option!  </s>
<s> 's .  </s>
<s> If a  gets through then it was probably a typo and I want  </s>
<s> There is another reason for a tidy comment to be helpfull here: Often the string br or p were meant to be html tags but a typo occured.  </s>
<s> A  </s>
<s> similar thing can be said for entities where &amp;amp is transformed to  </s>
<s> &amp;amp;amp ... Here, a tidy comment could be usefull.  </s>
<s> For me I would like  </s>
<s> to have an option which I can switch on that tells me when tidy parses entities in one coding but prints them out in a second coding.  </s>
<s> Cheers alex Alexander Biron Support the ban of Dihydrogen Monoxide: http://www.dhmo.org/  </s>
<s> /"\ ASCII ribbon campaign \ / --------------------- http://www-zeuthen.desy.de/~biron/  </s>
<s> X against HTML mail Tel (+49)33762-7-7516 / \ and postings mailto:alexander.biron@desy.de  </s>
<s> If it comes to a vote, I would also like this option please.  </s>
<s> Peter Vince Home: Barney.Wol@noctua.demon.co.uk Work: Peter.Vince@bbc.co.uk Web: http://www.noctua.demon.co.uk/ Barn Owls and more at http://www.owlsanctuary.co.uk/ PGP id = 0x332B72C0, &amp; fp = 3535 9AD9 C0EA 3606 0DE4 3811 422E 10B4 332B 72C0 PGP encryption software available free from: http://www.pgpi.org  </s>
<s> br or p would actually get translated to for XHTML output, or for HTML output, with warnings about unknown attributes "or" and "p".  </s>
<s> Tidy already issues a warning when converting &amp; to &amp;amp;: Warning: unescaped &amp; or unknown entity "&amp;whatever" Klaus Johannes Rusch KlausRusch@atmedia.net  </s>
