Hi all, We must be getting close to completion because it only took an hour to tweak the document this time, including the changes suggested today by Petteri Stenius and TAMURA Kent as well as prior feedback from Jonathan Marsh about removing the serialization as an addition to the function library. 
TAMURA-san: You posted a question about order of namespace nodes. 
The paragraph about serializing the namespace and attribute axes states that the 
primary key for lex order of nodes on these axes is the namespace URI, so I 
don't know what the problem is. 
Do you see a problem with using namespace URI (e.g. are you thinking we need to always add the default definition for 
xmlns to the initial evaluation context)? 
All: Is it an urgent issue that the parsing requirements still specify the need for retaining the namespace prefix from the input document? 
We can actually change the serialization process so that this is not required, but I'd rather not do that if there is wide availability of parsers that retain the original QName of elements, etc. Editors: Please consider this new draft of the XPath transform specification for the candidate recommendation. 
The changes are based on last-call feedback from the WG. Thanks, John Boyer Software Development Manager PureEdge Solutions, Inc. (formerly UWI.Com) Creating Binding E-Commerce jboyer@PureEdge.com 
In message "XPath Transform, 3rd version" 
A namespace declaration has no namespace, that is to say, there is no namespace binding on "xmlns" prefix. 
A URI as the value of a namespace declaration is not its namespace. 
So, there are two interpretations: a) Namespace declaration has no namespace URI. 
The primary key is empty. 
The secondary key is a local name (the declared prefix.) b) Regards the value of a namespace declaration as namespace URI. 
The primary key is the URI. 
The secondary key is a localname (the declared prefix.) TAMURA Kent @ Tokyo Research Laboratory, IBM 
In message "XPath Transform, 3rd version" 
li b Namespace and Attribute Nodes- /b a space, the node's QName, an equals sign, an open double quote, the modified string value, and a close double quote. 
The string value of the node is modified by replacing all ampersands (&amp;amp;) with code &amp;amp;amp; /code , and all double quote characters with code &amp;amp;quot; /code . 
/li li b Text Nodes- /b the string value, except all ampersands are replaced by code &amp;amp;amp; /code , and all open angle brackets () are replaced by code  /code . 
/li 
For the attribute value, we have to replace U+000D (CARRIAGE RETURN), U+000A (LINE FEED) and U+0009 (HORIZONTAL TABULATION) by character references because an XML processor nomalizes these character to U+0020 (SPACE). 
(See 3.3.3 
Attribute-Value Normalizatoin in XML1.0.) For the text node, we have to replace U+000D by the character reference because an XML processor normalizes U+000D to U+000A. 
(See 2.11 End-of-Line Handling in XML 1.0.) TAMURA Kent @ Tokyo Research Laboratory, IBM 
Hi TAMURA-san, 
In section 5.4 of the XPath spec, the namespace URI for all namespace nodes is declared to be NULL, so the comparison as defined always works (the primary key is always the same). 
Another way to put this is that I intend option A below. 
I haven't seen option B used elsewhere, and I don't think there would be any benefit in deriving one here. 
Thanks, John Boyer Software Development Manager PureEdge Solutions, Inc. (formerly UWI.Com) Creating Binding E-Commerce jboyer@PureEdge.com 
[mailto:w3c-ietf-xmldsig-request@w3.org]On 
Behalf Of TAMURA Kent In message "XPath Transform, 3rd version" 
the 
I 
for 
A namespace declaration has no namespace, that is to say, there is no namespace binding on "xmlns" prefix. 
A URI as the value of a namespace declaration is not its namespace. 
So, there are two interpretations: a) Namespace declaration has no namespace URI. 
The primary key is empty. 
The secondary key is a local name (the declared prefix.) b) Regards the value of a namespace declaration as namespace URI. 
The primary key is the URI. 
The secondary key is a localname (the declared prefix.) TAMURA Kent @ Tokyo Research Laboratory, IBM 
Ok, I have understood. 
TAMURA Kent @ Tokyo Research Laboratory, IBM 
