<s> I think a key point is the one Greg made at the end of this message, namely that this use case can be achieved without allowing etags in the If header.  </s>
<s> In particular, you just try the PUT with the LOCK request, and if that fails because you no longer have the lock, you retry the PUT with the appropriate etag in an If-Match header.  </s>
<s> I think it is very reasonable to require an extra round trip in an  </s>
<s> exceptional case like this (i.e. losing your lock).  </s>
<s> So until a use case is identified that cannot be easily handled by other machinery, I suggest we limit the If header to just lock tokens.  </s>
<s> Cheers, Geoff RFC2518 open issues)  </s>
<s> Am Montag den, 22. April 2002, um 18:36, schrieb Lisa Dusseault: If headers with ETags do not add any value to the protocol.  </s>
<s> For GET rfc2616 already defines If-Match and friends.  </s>
<s> Since the ETag only captures content changes (property changes have undefined effect on ETags), IF headers for ETag lack a use case.  </s>
<s> An etag in an If: header can be used to assert that a file has been unchanged since you last fetched it.  </s>
<s> Specifically, that you still have the locktoken *or* (you lost it and) it is unchanged.  </s>
<s> This is to cover the case where lock a file, fetch it, and then attempt to PUT the file back.  </s>
<s> The PUT should succeed if you have the locktoken *or* if you lost your lock but the etag matches what you GET'd (thus: nobody else changed it).  </s>
<s> Arguably, the semantic could be manufactured with other combinations, but I'd suggest that is your use case.  </s>
<s> Cheers, -g Greg Stein, http://www.lyra.org/  </s>
<s> The original rationale for including entity tags in the If header was to make the If header a general purpose mechanism for evaluating method preconditions (specifically, for evaluating preconditions concerning whether the resource's state still matched the state expected by the client, where the client's current understanding of the state is expressed using a state token, like an Etag or a LockToken).  </s>
<s> We were reacting against the closed design of the existing If-[None-]Match headers, which didn't allow expansion to include other state tokens.  </s>
<s> Our hope was that the If header would eventually replace the existing If-[None-]Match mechanism.  </s>
<s> One scenario that you can accomplish with the If header, and that you cannot accomplish with other mechanisms, is to perform an operation like a MOVE on a collection hierarchy, where the MOVE can only succeed if the client has the right lock token and all of the resources have the Etag expected by the client (i.e., they haven't been modified, which may be the case with shared locks).  </s>
<s> If the main concern about the feature is interoperability, then let's make testing of this feature an issue at the next interoperability event, and add a few tests concerning it to the Litmus test suite.  </s>
<s> - Jim  </s>
<s> Well, using also ETag verification allows consistency check.  </s>
<s> If you still have your lock and the ETag has changed, then it's because something nasty happened on the server side (as the ETag represents more or less a version tag of the resource).  </s>
<s> As it won't cost anything, I don't understand why you want to remove a consistency check.  </s>
<s> Yves Lafon - W3C  </s>
<s> From: w3c-dist-auth-request@w3.org [mailto:w3c-dist-auth-request@w3.org]On  </s>
<s> Behalf Of Yves Lafon Sent: Friday, April 26, 2002 4:23 AM Subject: RE: etags in If: headers (was: 54th IETF Meeting Information, and RFC2518 open issues)  </s>
<s> That would be an internal server error -- I don't think the *protocol* needs to allow discovery of problem like these...  </s>
<s> Well, that's exactly the point: every feature that's hard to implement, of questionable use *does* cost (in implementation/debugging time).  </s>
<s> So the feature should stay if - it gives us something that can't be easily done otherwise - we have proven interoperability.  </s>
