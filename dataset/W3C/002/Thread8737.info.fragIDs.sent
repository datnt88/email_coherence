<s> There seems to be a bunch of confusion about the role of KeyInfo clauses and suppositions about particular environments in which XML-DSIG is expected to operate.  </s>
<s> I'm combining responses to Peter and Carl here in the hope of pulling things back together.  </s>
<s> Apologies in advance for the length.  </s>
<s> Brian, Sorry for the confusion.  </s>
<s> I misspoke in my email.  </s>
<s> I meant KeyValue, not KeyInfo.  </s>
<s> KeyInfo is very valuable.  </s>
<s> KeyValue is a specific form of KeyInfo.  </s>
<s> Mandating that the KeyValue type of KeyInfo is required to implement is not good.  </s>
<s> That's because KeyValue is the "actual key(s) used to validate the signature.  </s>
<s> If the key is sent in protected form, the MgmtData element should be used."  </s>
<s> So what I'm saying is that sending an unprotected key by using the KeyValue mechanism does little good in a trust-management environment, such as an X.509 or PKIX environment.  </s>
<s> I'm concerned that (A) by populating KeyValue, I might encourage users to simply verify the signature based on the contents of KeyValue without even attempting to validate my certificate or certificate path, and (B) by making my implementation accept KeyValue, I open myself up to accepting signatures that I shouldn't trust.  </s>
<s> Since neither A or B is acceptable in a PKI environment, I would rather just not bother with KeyValue at all.  </s>
<s> Thus we'd like to see it not be a MUST implement.  </s>
<s> --Peter I think the problem here may stem from the wording Peter highlights and a confusion of two separate operations: (1) cryptographic signature validation, and (2) trust management determinations about a particular key pair.  </s>
<s> These are two fundamentally separate concepts within XML-DSIG; we explicitly separate the process of "verifying" that a digital signature is well-formed (computationally correct) from determining whether to place any trust in the key pair that performed the digital signature operation or the semantic content of the properly-signed message.  </s>
<s> Our primary concern is with step (1), so we care that conformant implementations always have a way to communicate enough information to perform the cryptographic signature check.  </s>
<s> That's why KeyValue support is required; it guarantees that two XML-DSIG implementations have at least one method of communicating enough information to cryptographically validate the signature.  </s>
<s> Now, the wording quoted above from Section 4.4, that KeyValue contains the "actual key(s) used to validate the signature," seems to imply that the information in KeyValue *must* be used by the verifying application.  </s>
<s> This was never the intent of anything contained within KeyInfo, so the language in the draft clearly needs to be revised.  </s>
<s> There is no requirement that the verifying implementation use the specific information contained within KeyInfo in the actual signature validation, although (as in CMS) we expect that for efficiency reasons implementations will likely try the included key information first before hitting a database to look for other potential keys to use to validate the signature.  </s>
<s> Once the signature has checked out, trust management models come into play (step (2)).  </s>
<s> Here XML-DSIG makes no statement about how individual applications may choose to perform step (2), or even what information that may use to make such determinations.  </s>
<s> We provide a place, KeyInfo, in which applications may choose to communicate information that may be useful for step (2), but again there's no requirement that that mechanism be used.  </s>
<s> I agree with you that "sending an unprotected key by using the KeyValue mechanism does little good in a trust-management environment;" but that's not an issue here because we're not trying to convey trust to the trust management engine via the KeyValue clause.  </s>
<s> As for your two other concerns: I'm concerned that (A) by populating KeyValue, I might encourage users to simply verify the signature based on the contents of KeyValue without even attempting to validate my certificate or certificate path, and This statement doesn't make sense because it combines steps (1) and (2), which are explicitly separate.  </s>
<s> For performance reasons it's quite likely that verifiers will try the provided key information first to satisfy step (1).  </s>
<s> That doesn't help with step (2), though, and clearly implementers of XML-DSIG must understand the difference between these two steps and what information they get out of each of them.  </s>
<s> As an aside, I assume that your use of "certificate or certificate path" is simply a stand-in for whatever evidence your trust management engine chooses to accept.  </s>
<s> (B) by making my implementation accept KeyValue, I open myself up to accepting signatures that I shouldn't trust.  </s>
<s> Again, this statement confuses signature validation from trust management processing.  </s>
<s> Perhaps we need more explicit language in the draft calling out the fundamental difference between the two.  </s>
<s> Thanks to Brian's comments I understand now the idea is for KeyInfo to serve as a "hint" and little/nothing more.  </s>
<s> However, I still fail to see where KeyValue provides anything in the way of "base interoperability" where a PKI application receives a key via KeyValue from a non-PKI application and thus fail to see why KeyValue is required.  </s>
<s> It seems only to provide enough interoperability for a non-PKI application to deliver a key that cannot be validated to a PKI application.  </s>
<s> I don't understand the distinction Carl's trying to draw here between "PKI" and "non-PKI" applications.  </s>
<s> I believe there may be some confusion because in PKIX applications keys are always delivered as part of the PKIX evidence (i.e. PKIX certificates) used as input to PKIX trust management processors (i.e. PKIX chain builders &amp; path validation logic).  </s>
<s> There is no assumption in XML-DSIG that any particular trust management engine will use particular forms of evidence that embed keys.  </s>
<s> PKIs, in the abstract sense, deal primarily with making the trust management decisions that form step (2) above.  </s>
<s> Since we cannot assume the existence of any particular form of PKI in XML-DSIG, let alone one that always conveys keys inside trust management evidence, XML-DSIG must provide the base interop for doing cryptographic signature checks.  </s>
<s> I hope this helps clear things up, --bal  </s>
<s> Armed with an understanding of the intent, which is, as you point out, not apparent in the text, I think what you are saying is this: KeyValue provides mathematical interoperability.  </s>
<s> This appears to be the gist of your comment: "XML-DSIG must provide the base interop for doing cryptographic signature checks."  </s>
<s> If this is so how is your following statement true: "there is no requirement that the verifying implementation use the specific information contained within KeyInfo in the actual signature validation."  </s>
<s> What interoperability is achieved if I can populate KeyValue with anything other than the "actual key(s) used to validate the signature?"  </s>
<s> Or do you simply mean that I may use other means to retrieve the same keying material for actual use?  </s>
<s> Note that my distinction between PKI and non-PKI has nothing to do with PKIX.  </s>
<s> I was simply stating that when given a raw key from a non-PKI environment that a PKI app will fail to validate a signature generated using  </s>
<s> that key because a satisfactory certification path cannot be built.  </s>
<s> KeyValue does not change this fact.  </s>
<s> And apparently KeyValue is not intended  </s>
<s> to do this.  </s>
<s> In any event, the parameters are superfluous and should rate a  </s>
<s> minOccurs=0.  </s>
<s> While the mathematical interoperability facilitated by KeyValue is important  </s>
<s> I think the text describing it creates the illusion of a interoperability at a higher level where there really isn't interoperability.  </s>
<s> By not addressing specific trust management schemes, we cannot deny their existence nor the fact that interoperability issues exist between them.  </s>
<s> Perhaps text changes shall clarify the issue.  </s>
<s> I await the next draft.  </s>
<s> -Carl  </s>
<s> I've inlined my comments below, prefixed with [bal]... Armed with an understanding of the intent, which is, as you point out, not apparent in the text, I think what you are saying is this: KeyValue provides mathematical interoperability.  </s>
<s> This appears to be the gist of your comment: "XML-DSIG must provide the base interop for doing cryptographic signature checks." [bal] Correct.  </s>
<s> "Mathematical interop" is the process of cryptographically validating the signature, and KeyValue helps with this.  </s>
<s> If this is so how is your following statement true: "there is no requirement that the verifying implementation use the specific information contained within KeyInfo in the actual signature validation."  </s>
<s> What interoperability is achieved if I can populate KeyValue with anything other than the "actual key(s) used to validate the signature?"  </s>
<s> Or do you simply mean that I may use other means to retrieve the same keying material for actual use?  </s>
<s> [bal] Your second statement is accurate; conforming applications may use other means to retrieve the same keying material.  </s>
<s> In fact, part of the reason KeyInfo is OPTIONAL is that the precise key to use may be implied by  </s>
<s> other means.  </s>
<s> One can easily envision protocols built on top of XML-DSIG that would take advantage of this option.  </s>
<s> Note that my distinction between PKI and non-PKI has nothing to do with PKIX.  </s>
<s> I was simply stating that when given a raw key from a non-PKI environment that a PKI app will fail to validate a signature generated using  </s>
<s> that key because a satisfactory certification path cannot be built.  </s>
<s> [bal] Can you help me understand why these two sentences are not contradictory?  </s>
<s> Your second sentence implies that signature validation is dependent on making a particular trust management decision about the key, and further that the trust management decision requires building a chain of  </s>
<s> certificates with some particular property.  </s>
<s> Certificates, chain building, and qualifying signature validation in this way are not fundamental to PKIs  </s>
<s> in general, although they are properties of PKIX in particular.  </s>
<s> KeyValue does not change this fact.  </s>
<s> And apparently KeyValue is not intended  </s>
<s> to do this.  </s>
<s> In any event, the parameters are superfluous and should rate a  </s>
<s> minOccurs=0.  </s>
<s> [bal] This last statement is false.  </s>
<s> If you don't include the DSA parameters  </s>
<s> then you have not fully qualified the key; without knowing the group parameters how can you mathematically validate the signature using the remaining info?  </s>
<s> Remember that the parameters are not included anywhere in the SignatureValue element.  </s>
<s> While the mathematical interoperability facilitated by KeyValue is important I think the text describing it creates the illusion of a interoperability at a higher level where there really isn't interoperability.  </s>
<s> By not addressing specific trust management schemes, we cannot deny their existence nor the fact that interoperability issues exist between them.  </s>
<s> Perhaps text changes shall clarify the issue.  </s>
<s> I await the next draft.  </s>
<s> -Carl  </s>
<s> [bal] Ah, I understand now, you are expecting from XML-DSIG statements on items that are specifically beyond its charter (see the Constraints subsection under Scope in http://www.w3.org/Signature/charter-20000105.html, and Design Principles &amp; Scope items 3.1 and 3.2 in please identify what text in the draft led you to this expectation?  </s>
<s> It needs to be cleaned up.  </s>
<s> --bal  </s>
<s> My comments are inline and I've snipped away a great deal of text.  </s>
<s> by  </s>
<s> This is the core of my initial question.  </s>
<s> KeyInfo is OPTIONAL.  </s>
<s> Why require those wishing to use a form of KeyInfo to implement KeyValue?  </s>
<s> The fact that it is optional undermines "base interoperability".  </s>
<s> The fact that KeyValue may be protected may further undermine base interop.  </s>
<s> using  </s>
<s> of  </s>
<s> PKIs  </s>
<s> I think we are arguing the semantics of the terms "validation" and "verification".  </s>
<s> Let's not.  </s>
<s> intended  </s>
<s> a  </s>
<s> parameters  </s>
<s> This depends on your point of view.  </s>
<s> If you accept that the parameters should never be used directly from the message without outside confirmation, due to parameter substitution, then it is logical to think that the parameters could simply be obtained from the outside source and need not be present in the message.  </s>
<s> Having them there invites misuse.  </s>
<s> Some verbage may  </s>
<s> clarify this issue, but minOccurs=0 would permit implementations to avoid including them where unnecessary just to claim "compliance".  </s>
<s> Perhaps an explicit statement of the intent of KeyValue.  </s>
<s> Perhaps some elaboration/example of MgmtData and its relationship with KeyValue.  </s>
<s> Perhaps watch the use of the term validate which is used to describe both KeyValue and X509Data since it has different meaning in each location.  </s>
<s> Perhaps use verify instead when discussing KeyValue.  </s>
<s> Lost is this has been the question whether or not the DTD/Schema is sufficient to support stated usage of KeyInfo.  </s>
<s> -Carl  </s>
<s> Carl: I understand that you don't want to implement KeyValue.  </s>
<s> The fact that KeyInfo is OPTIONAL and KeyValue is the one subclause of KeyInfo that is mandatory-to-implement.  </s>
<s> This is consistent with other IETF RFCs.  </s>
<s> The idea here is that if you DO include KeyInfo, then there must be a mandatory-to-implement form.  </s>
<s> Do you have a suggested alternative for KeyValue that is semantically neutral?  </s>
<s> I agree that we need some explanatory text on DSA parameters, but the parameters cannot be omitted from KeyValue for cryptographic reasons discussed previously.  </s>
<s> There is no scenario using KeyValue in which the parameters can be left out.  </s>
<s> In terms of your issue with schema, I don't understand that.  </s>
<s> Maybe you would also like to include an example of what you think needs to change.  </s>
<s> --Barbara My comments are inline and I've snipped away a great deal of text.  </s>
<s> by  </s>
<s> This is the core of my initial question.  </s>
<s> KeyInfo is OPTIONAL.  </s>
<s> Why require those wishing to use a form of KeyInfo to implement KeyValue?  </s>
<s> The fact that it is optional undermines "base interoperability".  </s>
<s> The fact that KeyValue may be protected may further undermine base interop.  </s>
<s> using  </s>
<s> of  </s>
<s> PKIs  </s>
<s> I think we are arguing the semantics of the terms "validation" and "verification".  </s>
<s> Let's not.  </s>
<s> intended  </s>
<s> a  </s>
<s> parameters  </s>
<s> This depends on your point of view.  </s>
<s> If you accept that the parameters should never be used directly from the message without outside confirmation, due to parameter substitution, then it is logical to think that the parameters could simply be obtained from the outside source and need not be present in the message.  </s>
<s> Having them there invites misuse.  </s>
<s> Some verbage may clarify this issue, but minOccurs=0 would permit implementations to avoid including them where unnecessary just to claim "compliance".  </s>
<s> Perhaps an explicit statement of the intent of KeyValue.  </s>
<s> Perhaps some elaboration/example of MgmtData and its relationship with KeyValue.  </s>
<s> Perhaps watch the use of the term validate which is used to describe both KeyValue and X509Data since it has different meaning in each location.  </s>
<s> Perhaps use verify instead when discussing KeyValue.  </s>
<s> Lost is this has been the question whether or not the DTD/Schema is sufficient to support stated usage of KeyInfo.  </s>
<s> -Carl  </s>
