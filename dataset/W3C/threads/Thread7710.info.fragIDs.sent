<s> Many of the new methods being defined for WebDAV versioning have an XML document as the value of their request and/or response body.  </s>
<s> While designing the protocol, I am continually faced with the question: Should an input parameter to the method be represented as a new XML element in the request body or as a new request header?  </s>
<s> Similarly, should an output parameter to the method be represented as a new XML element in the response body or as a new respose header?  </s>
<s> In each case, there is backward compatibility, since downlevel clients would just not generate the header/element, and downlevel servers would just ignore the unknown header/element.  </s>
<s> An argument for the XML element is that the contents of the XML element can hold a much wider range of data, and can have its structure defined, at least in a coarse syntactic fashion, with a DTD.  </s>
<s> Another argument for the XML element is that you don't have to worry about proxies stripping off headers they don't recognize.  </s>
<s> The only argument I can think of for using a header is that it is the only technique applicable when the body is being used for some other purpose (such as GET/PUT).  </s>
<s> One possible rule of thumb: If the request/response body is an XML document, then the request/response parameters should be specified as XML elements.  </s>
<s> Only if the body is not an XML document should parameters be specified as headers.  </s>
<s> Comments? Cheers, Geoff Geoffrey M. Clemm Chief Engineer, Configuration Management Business Unit Rational Software Corporation (781) 676-2684 geoffrey.clemm@rational.com  </s>
<s> http://www.rational.com  </s>
<s> The body of an HTTP request/response is payload.  </s>
<s> If it contains anything significant to the semantics of the operation or result, aside from a representation of data as defined by those semantics, then it isn't HTTP.  </s>
<s> It is something else tunneling inside HTTP, which is a waste of bytes.  </s>
<s> In general, if you find yourself with many new methods and request header fields, then it means there is something fundamentally wrong with the protocol design.  </s>
<s> Usually the fix is to do the same thing with far fewer extensions simply by using a redirect to a different resource rather than using new methods/fields to act indirectly.  </s>
<s> This is from experience -- I haven't looked at the WebDAV versioning stuff at all.  </s>
<s> ....Roy  </s>
<s> I discussed some of these marshalling issues in a workshop paper I wrote for the HTTP Future workshop held at WWW7 last year -- it complements Yaron's header/body rationale post.  </s>
<s> The paper is titled, "Lessons from WebDAV for the Next Generation Web Infrastructure", and covers the topics of parameter marshalling, multi-resource operations, operations on resource hierarchies, status reporting, and built-in lock support.  </s>
<s> The paper was written to try and separate out the "take-home" lessons from WebDAV which would be of interest to future protocol authors, specifically for HTTP-NG.  </s>
<s> The position paper is available at: - Jim  </s>
<s> Roy already responded to this from an HTTP protocol point of view, based on hs rules of thumb for extension design.  </s>
<s> I'd like to make a few points based on XML document and DTD design.  </s>
<s> Roy and I both think that Geoff's proposed bundling is a bad idea, but we have different reasons for thinking it.  </s>
<s> I haven't had a chance to read Jim's paper, so apologies if I'm duplicating any of his points.  </s>
<s> AS Roy says, the body is "payload".  </s>
<s> For some of our operations we treat some parameters as "payload".  </s>
<s> He might not like that part of the protocol design but it's at least logical I think.  </s>
<s> However, there are some other reasons to use headers (that I'll get to).  </s>
<s> This rule of thumb might bo OK, but should _never apply_ to methods like GET/PUT, since the document being modified should not have parameters added into it, even if it were an XML document.  </s>
<s> For other messages that _already_ need to take XML encoded request bodies, your hand is also not as free as it might be.  </s>
<s> You must use a header for any information that could make sense for a GET/PUT (now, and probably also if it could ever make sense in any future extension of these methods).  </s>
<s> In general since Headers are part HTTP (the base protocol) protocol information should use headers unless it's very obviously _method specific_.  </s>
<s> If it might not always be method specific, putting it in an XML request body is dangerous, as some future method might need it in a header because the method's body is pure "payload" in an arbitrary media-type.  </s>
<s> Of course a new header (potentially) interacts with _all_ other methods, and that increases spec complexity, and (even if the effects are very local and simple) increases the time for an implementor to comprehend the spec.  </s>
<s> and implement it.  </s>
<s> So Roy is also right that minimizing the use of headers is a good idea.  </s>
<s> Of course,the versioning spec.  </s>
<s> must inherently deal with a lot of complex data objects like revision histories, and configuration specifications, and so forth.  </s>
<s> These need to be expressed in XML, but where they must be referred to in methods they should probably have URIs or some other names that can fit sensibly in headers.  </s>
<s> The Property mechanism is one way to deal with some of these, but as Yaron has pointed out, properties should not be abused as a way to create new HTTP methods... Still, I think there actually needs to be a presumptive preference for headers, unless data format, character-encoding, or protocol complexity prevent it.  </s>
<s> As Roy says, a profusion of new headers (and thus header/method interactions) is probably telling you something important that should not be ignored.  </s>
<s> -- David David Durand dgd@cs.bu.edu \ david@dynamicDiagrams.com  </s>
<s> Boston University Computer Science \ Sr. Analyst --------------------------------------------\ http://www.dynamicDiagrams.com/  </s>
<s> MAPA: mapping for the WWW \__________________________  </s>
