<s> Hi all, While testing an HTTP/1.1 proxy server I am working on, I found a page on a major site that returns the following response on a conditional GET:  </s>
<s> HTTP/1.0 304 Not Modified Content-type: image/gif Content-length: 4672 Expires: Thu, 15 Apr 2010 20:00:00 GMT Last-modified: Fri, 15 Apr 1994 00:00:00 GMT  </s>
<s> The response didn't contain a body, but the presence of a Content-Length threw off the proxy.  </s>
<s> I'll be fixing that in the name of tolerance in any case.  </s>
<s> But I was wondering if including a Content-Length on a response that must NOT include a body and which isn't produced by a HEAD request should be considered a bug?  </s>
<s> That is, should I point out to the site operator that his/her server is generating bad HTTP or is this OK since 304 tells us there won't be a body anyway?  </s>
<s> Any opinions?  </s>
<s> Wham! wham_bang@yahoo.com  </s>
<s> Do You Yahoo!? Get your free @yahoo.com  </s>
<s> address at http://mail.yahoo.com  </s>
<s> In a previous episode Wham Bang said... :: While testing an HTTP/1.1 proxy server I am working on, :: I found a page on a major site that returns the following :: response on a conditional GET: ::  HTTP/1.0 304 Not Modified ::  Content-type: image/gif ::  Content-length: 4672 ::  Expires: Thu, 15 Apr 2010 20:00:00 GMT ::  Last-modified: Fri, 15 Apr 1994 00:00:00 GMT :: :: The response didn't contain a body, but the presence :: of a Content-Length threw off the proxy.  </s>
<s> I'll be fixing :: that in the name of tolerance in any case.  </s>
<s> But I was :: wondering if including a Content-Length on a response :: that must NOT include a body and which isn't produced by :: a HEAD request should be considered a bug?  </s>
<s> That is, my reasonably literate (but not super expert) reading makes this look  </s>
<s> like a lose-lose (you're both wrong ;).. story of my life some days..) as for your proxy: 4.4 Message Length The transfer-length of a message is the length of the message-body as it appears in the message; that is, after any transfer-codings have been applied.  </s>
<s> When a message-body is included with a message, the transfer-length of that body is determined by one of the following (in order of precedence): 1.Any response message which "MUST NOT" include a message-body (such as the 1xx, 204, and 304 responses and any response to a HEAD request) is always terminated by the first empty line after the header fields, regardless of the entity-header fields present in the message.  </s>
<s> so ignoring content-length isn't just tolerant, it's required.  </s>
<s> and as for the content provider: 14.13 Content-Length The Content-Length entity-header field indicates the size of the entity-body, in decimal number of OCTETs, sent to the recipient or, in the case of the HEAD method, the size of the entity-body that would have been sent have been sent had the request been a GET.  </s>
<s> they're definitely in the wrong as their entity body is size 0 and they aren't responding to a HEAD.  </s>
<s> -P  </s>
<s> Hello again, Hmmmm, in retrospect I'm a little disapointed at myself for troubling the list with stuff that turns out to be pretty clearly spelled out in the spec... Sorry.  </s>
<s> Yes, the quote makes it quite clear.  </s>
<s> Hey, at least I was going to fix it.  </s>
<s> :)  </s>
<s> Someone disagreed with this opinion via email, but I'd tend to agree.  </s>
<s> The language is (again) quite clear.  </s>
<s> Putting in Content-Length: 0 would've been OK though.  </s>
<s> Thanks for the clarifications!  </s>
<s> Wham! wham_bang@yahoo.com  </s>
<s> Do You Yahoo!? Get your free @yahoo.com  </s>
<s> address at http://mail.yahoo.com  </s>
