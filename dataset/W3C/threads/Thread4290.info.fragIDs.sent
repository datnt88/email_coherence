<s> fn:distinct-values does not say how values of type xdt:untypedAtomic are handled.  </s>
<s> I suggest we use the same rule that we use for aggregate functions, namely "Values of type xdt:untypedAtomic are cast to the type of the other items in $arg.  </s>
<s> If all values in $arg are of type xdt:untypedAtomic they are converted to xs:string."  </s>
<s> But we have other threads that point out that this is a really bad rule, because it prevents a pipelined implementation.  </s>
<s> It must be possible to  </s>
<s> process untypedAtomic values without looking ahead to discover the types of  </s>
<s> all other items in the sequence.  </s>
<s> This means that each aggregate function  </s>
<s> must have a "default type", and untypedAtomic values should be converted to  </s>
<s> the default type.  </s>
<s> For fn:distinct-values, the only sensible default type is string.  </s>
<s> Michael Kay  </s>
<s> I think the rules for fn:distinct-values should be:  </s>
<s> * untypedAtomic values are cast to string  </s>
<s> * non-comparable values are allowed, and treated as distinct  </s>
<s> Michael Kay  </s>
<s> -----Original Message----- From: Ashok Malhotra Sent: Sunday, August 10, 2003 8:30 AM Subject: RE: MS-FO-LC1-100: Promotion of untyped values in  </s>
<s> fn:distinct-  </s>
<s> are  </s>
<s> handled.  </s>
<s> I suggest we use the same rule that we use for aggregate functions, namely "Values of type xdt:untypedAtomic are cast to the  </s>
<s> of the other items in $arg.  </s>
<s> If all values in $arg are of type xdt:untypedAtomic they are converted to xs:string."  </s>
<s> All the best, Ashok  </s>
<s> -----Original Message----- From: public-qt-comments-request@w3.org  </s>
<s> [mailto:public-qt-comments-  </s>
<s> request@w3.org] On Behalf Of  </s>
<s> Michael Rys  </s>
<s> Sent: Wednesday, July 09, 2003 2:33 AM Subject: MS-FO-LC1-100: Promotion of untyped values in  </s>
<s> fn:distinct-  </s>
<s> Class: Technical Section 15.1.11:  </s>
<s> Are values of type xdt:untypedAtomic promoted?  </s>
<s> If  </s>
<s> so  </s>
<s> how?  </s>
<s> *untypedAtomic values are cast to string Just for comparison or also in the result?  </s>
<s> Good question.  </s>
<s> Since the most likely scenario is that if any values are untyped, then all values are untyped, it probably makes most sense to leave them as untyped in the result.  </s>
<s> Michael Kay Michael From: Kay, Michael [mailto:Michael.Kay@softwareag.com]  </s>
<s> Subject: RE: MS-FO-LC1-100: Promotion of untyped values in fn:distinct-values?  </s>
<s> I think the rules for fn:distinct-values should be: * untypedAtomic values are cast to string * non-comparable values are allowed, and treated as distinct Michael Kay  </s>
<s> -----Original Message----- From: Ashok Malhotra Sent: Sunday, August 10, 2003 8:30 AM Subject: RE: MS-FO-LC1-100: Promotion of untyped values in  </s>
<s> fn:distinct-  </s>
<s> handled.  </s>
<s> I suggest we use the same rule that we use for aggregate functions, namely "Values of type xdt:untypedAtomic are cast to the  </s>
<s> of the other items in $arg.  </s>
<s> If all values in $arg are of type xdt:untypedAtomic they are converted to xs:string."  </s>
<s> All the best, Ashok  </s>
<s> -----Original Message----- From: public-qt-comments-request@w3.org  </s>
<s> [mailto:public-qt-comments- mailto:public-qt-comments-  </s>
<s> request@w3.org] On Behalf Of  </s>
<s> Michael Rys  </s>
<s> Sent: Wednesday, July 09, 2003 2:33 AM Subject: MS-FO-LC1-100: Promotion of untyped values in  </s>
<s> fn:distinct-  </s>
<s> Class: Technical Section 15.1.11:  </s>
<s> Are values of type xdt:untypedAtomic promoted?  </s>
<s> If  </s>
<s> so  </s>
<s> how?  </s>
