<s> keshlam@us.ibm.com scripsit:  </s>
<s> If someone hands a parser a badly-formed HTML file without the HTML wrapper, does the DOM assume that an HTML element will be synthesized to be the single content root (DocumentElement)?  </s>
<s> Or should an HTML DOM accurately record the multiple-root structure of the broken file?  </s>
<s> There is no such thing as an HTML document without an HTML element.  </s>
<s> HTML, like HEAD and BODY and a few other elements, allows omission of  </s>
<s> both the start-tag and the end-tag.  </s>
<s> So a (minimal) HTML document:  </s>
<s> TITLE Foo /TITLE Bar  </s>
<s> has in fact the structure John Cowancowan@ccil.org  </s>
<s> e'osai ko sarji la lojban.  </s>
<s> Paste the above into a file and bring it up in Netscape.  </s>
<s> No complaints.  </s>
<s> This is certainly not valid HTML 4.0 (or any other version of the standard I can imagine), but it is "HTML-ish" in the sense that it looks enough like  </s>
<s> HTML for the browsers to make sense out of it, and thus (I'm sad to say) for many, many people to happily write documents in "HTML-ish" and put them out on the Web.  </s>
<s> Mike Champion  </s>
<s> Mike Champion scripsit:  </s>
<s> Naturally not.  </s>
<s> Well, you're right, but not for the reason being discussed.  </s>
<s> The  </s>
<s> following small variant: TITLE Foo /TITLE P Bar *is* valid HTML 4.0 (assuming you add an appropriate DOCTYPE declaration).  </s>
<s> It is equivalent to: You can confirm this with the W3C HTML Validator Service.  </s>
<s> I have put up http://www.ccil.org/~cowan/foo.html as a sample; the Validator Service is at http://validator.w3.org .  </s>
<s> Character data is not permitted directly within a BODY element, which is what was wrong with my previous example.  </s>
<s> But my points about HTML, HEAD, and BODY all being present in all HTML documents,  </s>
<s> even if both start-tags and end-tags are omitted, is correct.  </s>
<s> See the HTML 4.0 DTD.  </s>
<s> John Cowancowan@ccil.org  </s>
<s> e'osai ko sarji la lojban.  </s>
<s> Ahhh, I see your point.  </s>
<s> I shouldn't have quibbled with you, but just  </s>
<s> wanted to make the point that all sorts of HTML-ish tagged content gets  </s>
<s> passed off as HTML on the Web, and the DOM does NOT attempt to specify how that stuff gets represented to the DOM user.  </s>
<s> In the example under discussion, it's probably obvious what the DOM processor should and will do, but I wanted to make the larger point clear to this mailing list since it is a VERY frequently asked question.  </s>
<s> Mike  </s>
<s> So there are basically two points: 1.  </s>
<s> The DOM Rec doesn't say what a DOM builder should do with invalid HTML, and a conforming DOM implementation is allowed to make demons fly out of your nose, and all that.  </s>
<s> 2. All valid HTML documents contain HTML, HEAD, and BODY elements even if no such tags are present, and therefore conforming DOM implementations must represent them explicitly as nodes.  </s>
<s> (TBODY, which is a container  </s>
<s> for table rows, obeys the same rules: it appears implicitly in every  </s>
<s> TABLE element.)  </s>
<s> John Cowancowan@ccil.org  </s>
<s> e'osai ko sarji la lojban.  </s>
<s> I've been following your thread with much intrest, and need a little clarification.  </s>
<s> Would the adding of these tags be the job of the builder or the DOM  </s>
<s> implementation?  </s>
<s> If it is the job of the DOM implementation, when should these  </s>
<s> be added?  </s>
<s> In the example giving earlier, I imagine it would be the job of the  </s>
<s> builder to make sure the DOM structure represents a valid 4.0 document even if  </s>
<s> what it is parsing is not completely valid (missing the HTML tag or such).  </s>
<s> However, should d = someFactory.createHTMLDocument();  </s>
<s> d.setTitle('A New Title') add a HTML and a HEAD (and of course a TITLE) to the document?  </s>
<s> or should: d = someFactory.createHTMLDocument();  </s>
<s> d.getBody(); create a BODY tag and then return it?  </s>
<s> What if the user really wants frames??  </s>
<s> Much thanks  </s>
<s> Mike Olson Member Consultant FourThought LLC  </s>
<s> "No program is interesting in itself to a programmer.  </s>
<s> It's only interesting as  </s>
<s> long as there are new challenges and new ideas coming up."  </s>
<s> --- Linus Torvalds  </s>
<s> Building DOM nodes for elements that logically must exist in an HTML  </s>
<s> document but may not actually exist as tags in the source text *is* the job  </s>
<s> of a DOM implementation.  </s>
<s> I don't think it matters if these fixups are done  </s>
<s> "eagerly" when the document is created or "lazily" when someone asks for one of the elements that were implied.  </s>
<s> I don't follow the implication of "what if the user really wants frames?".  </s>
<s> Mike Champion  </s>
<s> these  </s>
<s> the  </s>
<s> even if  </s>
<s> interesting as  </s>
<s> In a schematic way of thinking, you can say that the HTML document goes  </s>
<s> through the HTML parser, which adds all the omitted tags, default attribute values, etc and is turned into the structure model (that internal representation of the document which the DOM implementation uses).  </s>
<s> The DOM functions, methods, etc then act on this structure model, not on the source document.  </s>
<s> So by the time the DOM gets to the document, all the missing pieces have already been filled in by the parser.  </s>
<s> Rules for omitted tags are strict and there will be no problems if these  </s>
<s> are omitted following the strict rules.  </s>
<s> Where problems come in is with broken documents which don't follow these rules.  </s>
<s> For example, omitting the HTML and /HTML tags shouldn't cause any problems, because an HTML user agent that understands HTML 4.0 will know to put these in.  </s>
<s> But overlapping tags, for example, do cause problems, because they are not valid in HTML 4.0.  </s>
<s> Many HTML tools try to fix up broken documents, and do it in varying ways.  </s>
<s> The DOM will act on the document after it has been fixed up, which means you will get varying results in different HTML tools.  </s>
<s> Lauren  </s>
<s> The attribute 'body' in the HTMLDocument is supposed to return the element that contains the content for the document.  </s>
<s> This could either be a 'BODY' or 'FRAMESET' tag.  </s>
<s> So in the following code, should a body or a fraemset be returned, or niether?  </s>
<s> d = someFactory.createHTMLDocument();  </s>
<s> d.getBody();  </s>
<s> Mike Olson Member Consultant FourThought LLC "No program is interesting in itself to a programmer.  </s>
<s> It's only interesting as long as there are new challenges and new ideas coming up."  </s>
<s> --- Linus Torvalds  </s>
