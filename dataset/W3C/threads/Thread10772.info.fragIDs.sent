<s> On 23 October 1996, the ERB will vote to decide the following question.  </s>
<s> A straw poll indicates the ERB is leaning to yes.  </s>
<s> C.9 Should XML forbid use of the '&amp;' connector in content models (11.2.4.1)?  </s>
<s> Well, this is a peculiar reversal for me, but since we are going to keep the weird semantics of SGML content models, &amp; does not seem too burdensome.  </s>
<s> And it is useful in some contexts.  </s>
<s> I don't feel strongly about it, but  </s>
<s> we've already given up the hope that anyone can apply well known theory, or  </s>
<s> common knowledge in implementing the feature, and &amp; is easy when you just parse against the parse tree (which is what people will do).  </s>
<s> Maybe that's an instance of another straw for the implementor's back, but since we're throwing in a brick, I don't see that baking the brick with  </s>
<s> straw in it is going to make that much difference.  </s>
<s> -- David RE delenda est.  </s>
<s> David Durand dgd@cs.bu.edu \ david@dynamicDiagrams.com  </s>
<s> Boston University Computer Science \ Sr. Analyst --------------------------------------------\ http://dynamicDiagrams.com/ MAPA: mapping for the WWW \__________________________  </s>
<s> I don't recall seeing this resolution passed by the ERB, did I miss something :-)?  </s>
<s> What "brick" are you talking about?  </s>
<s> Since we've dropped OMITTAG, and will probably drop inclusion and exclusion exceptions, '&amp;' groups are the only feature remaining that are beyond the scope of what anyone with a copy of the Dragon Book can handle in a day's work.  </s>
<s> (The ambiguity restriction does not matter here: unambiguous content models are a strict subset of regular expressions; any algorithm for matching against general REs will also work for unambigous ones.  </s>
<s> In fact, the ambiguity rule can make things *easier* for implementors.)  </s>
<s> I don't see that '&amp;' is _easy_, but as long as we keep the ambiguity restriction it's at least tractable.  </s>
<s> --Joe English jenglish@crl.com  </s>
<s> Way back when, Tim Bray posted the following, in the "Report from the SGML ERB meeting of Oct. 9th":  </s>
<s> A.27 XML will behave like SGML as regards behavior and precedence of occurrence indicators and connectors in content models (11.2.4.1, 11.2.4.2). (Whether to abolish the AND connector will be decided separately.)  </s>
<s> Passed, Unanimous.  </s>
<s> That means the whole ball of wax, to me.  </s>
<s> If I had to implement SGML's  </s>
<s> ambiguity I'd implement and ambiguity check and match against the parse tree for the model.  </s>
<s> If I'm parsing that way, what's a single bit of additional state per moel token?  </s>
<s> As I say, I'm not emotional about kereping &amp;, just don't see why not.  </s>
<s> Yeah, once the check is over.  </s>
<s> It's doing the check that is unpleasant and non-standard.  </s>
<s> Still, your point about hust using RE is a good one.  </s>
<s> You just keep a flag as to whether the &amp; group is used up yet or not.  </s>
<s> Gross, but servicable and easy....  </s>
<s> -- David RE delenda est.  </s>
<s> David Durand dgd@cs.bu.edu \ david@dynamicDiagrams.com  </s>
<s> Boston University Computer Science \ Sr. Analyst --------------------------------------------\ http://dynamicDiagrams.com/ MAPA: mapping for the WWW \__________________________  </s>
<s> theory, or  </s>
<s> A.27 XML will behave like SGML as regards behavior and precedence of occurrence indicators and connectors in content models  </s>
<s> No. It means that to the extent that we have () and | and , and * and PCDATA and so on in XML content models, they mean the same thing as they mean when they appear in SGML content models.  </s>
<s> Between the things that we've turfed and the things that we're going to turf, there is going to be A LOT LESS allowed in XML content models.  </s>
<s> With the explicit aim, as reflected in our design goals, of making parsers easy and in particular susceptible to standard formal methods.  </s>
<s> And specifically, let's lose the &amp;.  </s>
<s> Not that it isn't useful... but the ROI is negative.  </s>
<s> Cheers, Tim Bray tbray@textuality.com  </s>
<s> http://www.textuality.com/  </s>
<s> +1-604-488-1167  </s>
<s> You don't have to perform the check though, even in a validating parser: "4.329 validating SGML parser: A conforming SGML parser that can find and report a reportable markup error if (and only if) one exists.  </s>
<s> 4.267 reportable markup error: A failure of a document to conform to this International Standard [...] other than a semantic error [...] or: a) an ambiguous content model b) [...]" [ 9.3, "Conforming Systems", p. 215]  </s>
<s> In other words, 8879 (for better or worse) places the burden of ensuring non-ambiguity on the DTD designer, not the parser.  </s>
<s> Also note that checking for ambiguity is straightforward -- as long as there are no '&amp;' groups.  </s>
<s> That only works if the content model is unambiguous: consider '( (a,(b|c)) &amp; (a,(b|d)) )' after seeing 'ab...'  </s>
<s> Since '&amp;' groups are the only feature that makes the ambiguity restriction difficult to test for, and it's also the only feature (other than OMITTAG [1]) that makes the restriction desirable from the implementor's point of view, the logical conclusion would be to drop '&amp;' groups.  </s>
<s> (Not that I am advocating that position -- I think XML should keep both '&amp;' groups and the ambiguity restriction, but should not require validating parsers to check the latter.)  </s>
<s> [1] Final note: OMITTAG, in particular start-tag omission, *cannot work* unless content models are unambiguous and deterministic.  </s>
<s> This is because of the way "contextually require element" is defined in the standard.  </s>
<s> --Joe English jenglish@crl.com  </s>
<s> I don't think we should emulate the policy of having errors that may break some parsers and documents, but are not reportable.  </s>
<s> I agree.  </s>
<s> But it's not something you can look up in a book.  </s>
<s> This seems to me to support removing the unambiguity distinction.  </s>
<s> More reason to drop unambiguity, as that feature died an unlamented death practically at the inception of the project.  </s>
<s> You have convinced me though, that both features should be dropped, &amp; and  </s>
<s> unambiguity.  </s>
<s> We should take advantage of the slack allowed in the standard,  </s>
<s> and hope that SGML parser writers who care about XML will adapt.  </s>
<s> -- David David Durand dgd@cs.bu.edu \ david@dynamicDiagrams.com  </s>
<s> Boston University Computer Science \ Sr. Analyst --------------------------------------------\ http://dynamicDiagrams.com/ MAPA: mapping for the WWW \__________________________  </s>
<s> Not exactly.  </s>
<s> The standard just doesn't require ambiguity checking as a requirement of every validating parser.  </s>
<s> We expected that products would differentiate themselves in this (and other) respects, as indeed they have.  </s>
<s> But it is true that, with or without parser assistance, a document type can't have any ambiguous content models.  </s>
<s> (Even without start-tag omission, unambiguous content models are typically easier for a user to understand, and therefore to determine which element types are allowed at a given juncture.) Charles F. Goldfarb * Information Management Consulting * +1(408)867-5553 13075 Paramount Drive * Saratoga CA 95070 * USA International Standards Editor * ISO 8879 SGML * ISO/IEC 10744 HyTime Prentice-Hall Series Editor * CFG Series on Open Information Management  </s>
<s> Agreed.  </s>
<s> There is another option though: XML could enforce a stricter -- and easier to implement -- ambiguity restriction than 8879.  </s>
<s> (Removing the restriction altogether would make XML incompatible with SGML, so that is not an option as I see it.) The main difficulty in testing content models with AND groups for ambiguity comes from (pathological?) cases like: ((foo &amp; bar), foo), i.e., AND groups whose first- and follow- sets are not disjoint.  </s>
<s> If XML extends the notion of "ambiguity" to include these cases as well, then AND groups can be treated just like repeatable OR groups for purposes of detecting violations of the rule.  </s>
<s> (This might be a good idea in any case, based on the primary rationale behind the ambiguity restriction in the first place: "human beings must also perform context checking when creating the document, and they are more likely to do this successfully if the regular expressions are kept simple."  </s>
<s> [Annex H] I realize that many people disagree with this rationale, but keep in mind that those of us who understand the issue well enough to disagree with it are not the sort of human beings that Annex H is talking about in the first place.)  </s>
<s> So we put it in the XML spec.  </s>
<s> A formal definition of what isn't allowed should suffice, as long as the language is mathematical in nature (a la 10179) and not legalese (a la 8879).  </s>
<s> I think you misunderstood.  </s>
<s> The algorithm you suggested for parsing AND groups -- set a flag after matching each subgroup -- only works for non-ambiguous content models.  </s>
<s> Otherwise you can't tell "which" subgroup was matched ("which" in quotes since the question is meaningless for general regular expressions).  </s>
<s> To me that suggests that the ambiguity restriction should be _retained_: it makes AND groups easier to handle.  </s>
<s> I really must work on my exposition then, since that's the exact opposite of what I had hoped to convince you :-) I think XML should keep '&amp;' (since it's useful, despite being hard to implement); and it must keep the ambiguity restriction (for compatibility with 8879).  </s>
<s> OMITTAG means that 8879:199X will most likely not be able to allow ambiguity either, so XML can't even remove the restriction in anticipation of a revised standard.  </s>
<s> --Joe English jenglish@crl.com  </s>
