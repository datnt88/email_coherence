<s> I propose here corrective wording for open issue RANGEDELIM (described in http://www.ics.uci.edu/pub/ietf/http/hypermail/1998q2/0141.html ).  </s>
<s> RFC 2046 defines multipart messages.  </s>
<s> In section 5.1.1, it says, The boundary delimiter MUST occur at the beginning of a line, i.e., following a CRLF, and the initial CRLF is considered to be attached to the boundary delimiter line rather than part of the preceding part.... Now, HTTP introduces an interesting ambiguity, because the first line of an entity body could well be considered the beginning of a line, and it follows a CRLF.  </s>
<s> However, since we must ignore the CRLF that  </s>
<s> separates the headers from the body, the body does not really begin with a CRLF.  </s>
<s> So by my reading of RFC 2046, an HTTP multipart entity would have to include an extra CRLF preceding the boundary.  </s>
<s> I have amended Section 19.2 of the HTTP spec.  </s>
<s> accordingly, along with the example.  </s>
<s> Dave Kristol 19.2 Internet Media Type multipart/byteranges When an HTTP 206 (Partial Content) response message includes the content of multiple ranges (a response to a request for multiple non-overlapping ranges), these are transmitted as a multipart message-body (RFC 2046).  </s>
<s> The media type for this purpose is called "multipart/byteranges".  </s>
<s> The multipart/byteranges media type includes two or more parts, each with its own Content-Type and Content-Range fields.  </s>
<s> The required boundary parameter specifies the boundary string used to separate each body-part.  </s>
<s> Media Type name: multipart Media subtype name: byteranges Required parameters: boundary Optional parameters: none Encoding considerations: only "7bit", "8bit", or "binary" are permitted Security considerations: none For example: HTTP/1.1 206 Partial Content Date: Wed, 15 Nov 1995 06:25:24 GMT Last-modified: Wed, 15 Nov 1995 04:58:08 GMT Content-type: multipart/byteranges; boundary=THIS_STRING_SEPARATES [Note: two CRLF's above.  </s>
<s> Second one is new.  </s>
<s> :-)] --THIS_STRING_SEPARATES Content-type: application/pdf Content-range: bytes 500-999/8000 ...the first range... --THIS_STRING_SEPARATES Content-type: application/pdf Content-range: bytes 7000-7999/8000 ...the second range --THIS_STRING_SEPARATES-- Cautions: 1) Although RFC 2046 mandates that a CRLF precede each boundary, some existing implementations omit the mandated CRLF that precedes the first boundary in the body.  </s>
<s> 2) Although RFC 2046 permits the boundary string to be quoted, some existing implementations handle a quoted boundary string incorrectly.  </s>
<s> 19.2.1 Multipart/x-byteranges Note to Jim Gettys: need to add reference to RFC 2046: Freed, N., and N. Borenstein.  </s>
<s> "Multipurpose Internet Mail Extensions (MIME) Part Two: Format of Internet Message Bodies." RFC 2046, Innosoft, First Virtual, November 1996.  </s>
<s> After discussions over the weekend, especially exchanges with Ned Freed, co-author of RFC 2046, I am amending my proposed changes.  </s>
<s> In particular, most of them go away.  </s>
<s> It turns out that a careful reading of RFC 2046 shows that an extra leading CRLF is unnecessary, and that  </s>
<s> the HTTP example was correct.  </s>
<s> (Details: the multipart-body grammar  </s>
<s> begins "[preamble CRLF]", which makes the cruft that often precedes multipart bodies, plus the CRLF that ends it, optional.)  </s>
<s> Thus the only changes that remain are to reference RFC 2046, to caution about quoted boundary strings, and to add 2046 to the reference section.  </s>
<s> Dave Kristol 19.2 Internet Media Type multipart/byteranges When an HTTP 206 (Partial Content) response message includes the content of multiple ranges (a response to a request for multiple non-overlapping ranges), these are transmitted as a multipart message-body (RFC 2046).  </s>
<s> The media type for this purpose is called "multipart/byteranges". [Following the example:] Caution: Although RFC 2046 permits the boundary string to be quoted, some existing implementations handle a quoted boundary string incorrectly.  </s>
<s> 19.2.1 Multipart/x-byteranges Note to Jim Gettys: need to add reference to RFC 2046: Freed, N., and N. Borenstein.  </s>
<s> "Multipurpose Internet Mail Extensions (MIME) Part Two: Format of Internet Message Bodies." RFC 2046, Innosoft, First Virtual, November 1996.  </s>
<s> Enough people have been confused by this that it is important to have an explicit warning that the leading CRLF is allowed and optional.  </s>
<s> John Franks john@math.nwu.edu  </s>
<s> I agree it's confusing, and subtle.  </s>
<s> How about if there are two cautions: Cautions: 1) Additional CRLFs may precede the first boundary string in the entity.  </s>
<s> 2) Although RFC 2046 permits the boundary string to be quoted, some existing implementations handle a quoted boundary string incorrectly.  </s>
<s> Dave Kristol  </s>
