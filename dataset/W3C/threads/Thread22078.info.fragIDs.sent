<s> Hi, The java stylesheet produces variable declarations within the runTest() method.  </s>
<s> When defining filters you don't have access to the outer class variables from within the produced inner class.  </s>
<s> Is there a way to define class level variables ?  </s>
<s> As a workaround I tried to locally declare variables within the inner class by doing: This produces a java test as follows: public class DOMBuilderFilterTest extends DOMTestCase { public DOMBuilderFilterTest(DOMTestDocumentBuilderFactory factory){ super(factory); private class DOMBuilderFilterN1E extends DOMTestInnerClass implements DOMBuilderFilter { String name; int SHOW_ELEMENT; short FILTER_ACCEPT; short FILTER_REJECT; short FILTER_SKIP; public DOMBuilderFilterN1E(DOMTestCase test, int SHOW_ELEMENT, short FILTER_ACCEPT, short FILTER_REJECT, short FILTER_SKIP) { super(test); this.SHOW_ELEMENT = SHOW_ELEMENT; this.FILTER_ACCEPT = FILTER_ACCEPT; this.FILTER_REJECT = FILTER_REJECT; this.FILTER_SKIP = FILTER_SKIP; public short startElement(Element elt) { public void runTest() throws java.lang.Throwable { DOMBuilderFilter myfilter = new DOMBuilderFilterN1E(this, 1, 1, 2, 3 );  </s>
<s> The problem with this workaround is that the variables that are passed to the constructor of the inner class are not properly typed.  </s>
<s> DOMBuilderFilter myfilter = new DOMBuilderFilterN1E(this, 1, 1, 2, 3 ); should be: DOMBuilderFilter myfilter = new DOMBuilderFilterN1E(this, (int)1, (short)1, (short)2, (short)3 );  </s>
<s> Since 1 is by default int.  </s>
<s> Jeroen  </s>
<s> ---- lines omitted  </s>
<s> That is not a workaround, that was the intended use of that construct.  </s>
<s> They only issue is that I did not anticipate the need to cast integer literals to shorts on the constructor.  </s>
<s> I'll update the transform.  </s>
<s> In the interim, if you define the class variables as 'int', you should avoid the inner class constructor issue and any casting to short inside the inner class body should occur automatically.  </s>
<s> Alternatively, you could assign literals to test scoped variables before the inner class definition and use the test scoped variables as the values for the inner class variables.  </s>
<s> var name='SHOW_ELEMENT' type='int' value='SHOW_ELEMENT'/ var name='FILTER_ELEMENT' type='short'  </s>
<s> value='FILTER_ELEMENT'/  </s>
<s> test-to-java.xsl has now been updated to cast numeric literals passed to inner class constructor short parameters.  </s>
<s> Also, the inner class method and attribute production now recurses into the supertype if the definition is not found in the derived type which should enable DOMWriterFilter.acceptNode to be correctly produced.  </s>
