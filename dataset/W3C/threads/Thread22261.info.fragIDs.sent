<s> Please see http://bclary.com/dom-ts/readme.html for an example of using jsUnit 1.3.0 in the DOM Test Suites.  </s>
<s> This online example contains the full tests for DOM Core 1, DOM Core 2 and DOM HTML 2 as of June 21 and can be run in either Mozilla or Internet Explorer.  </s>
<s> It has been tested on Windows 2000 using Mozilla 1.0.1 and Internet Explorer 6.  </s>
<s> You can select the implementation to use, the content type, several parser options and either a test suite or individual tests.  </s>
<s> You can browse the directories and tests by visiting http://bclary.com/dom-ts/ .  </s>
<s> The script DOMTestCase.js, the transforms test-to-ecmascript.xsl and test-to-jsunit.xsl  </s>
<s> were patched as well as several tests.  </s>
<s> The readme contains the details and rational behind the changes.  </s>
<s> http://bclary.com/dom-ts/changes.diff contains a diff showing all the changes.  </s>
<s> I created jsUnit Test Suites (by hand) to replace the 'all' versions of the tests.  </s>
<s> I did not attempt to modify the transforms to produce these suites although that should be relatively easy for someone with more skill in XSL.  </s>
<s> A few comments about testing results/strategies  </s>
<s> Mozilla will have problems with the Applet tests if you try to run the DOM HTML Level 2 tests as text/xml.  </s>
<s> You can either disable Java or you can choose the non-Applet/non-Object test suite if you wish to test DOM HTML Level 2 as text/xml.  </s>
<s> There is no problem when testing DOM HTML Level 2 as text/html.  </s>
<s> Internet Explorer may have problems with the Applet tests if you try to  </s>
<s> run the DOM HTML Level 2 tests as text/html.  </s>
<s> (IE fails all the DOM HTML Level 2 tests if you run them as text/xml and it does not matter if you have Java enabled or not).  </s>
<s> Again you can either disable Java or choose the non-Applet/non-Object test suite.  </s>
<s> Bob  </s>
<s> Just to confuse things, I've been busy the last few days too.  </s>
<s> Hopefully, Bob can reconcile these, but right now we are diverging.  </s>
<s> I wasn't satisified with the test format in Bob's previous offering since it didn't look much like a JUnit test and possible involved putting stuff in JSUnit that was DOM Test suite aware (not sure about that).  </s>
<s> JUnit had (but JSUnit didn't) have the concept of a TestCase class.  </s>
<s> In most cases, you just let the framework create TestCase objects that invoked your "test" methods by reflection.  </s>
<s> However, you could create your own classes derived from TestCase as we do in the Java tests.  </s>
<s> In my variant of Bob's previous JSUnit, I've added an equivalent to the JUnit TestCase class.  </s>
<s> The generated tests override the setUp, runTest and tearDown methods of the test class.  </s>
<s> The tweaks I added are the ability for the setUp method to mark the test as ignored (for example, if the test requires entity expansion and the implementation doesn't support it) or not ready (for async loading).  </s>
<s> Here is a sample of a test body: function attrname_runTest() { var doc; var addressList; var testNode; var attributes; var streetAttr; var name; doc = this.builder.load(this.doc,  </s>
<s> "doc", "staff"); addressList = doc.getElementsByTagName("address");  </s>
<s> testNode = addressList.item(1);  </s>
<s> attributes = testNode.attributes;  </s>
<s> streetAttr = attributes.getNamedItem("street");  </s>
<s> name = streetAttr.nodeName;  </s>
<s> assertEquals("nodeName","street",name); name = streetAttr.name;  </s>
<s> assertEquals("name","street",name); function attrname_setUp() { var attrs = [ ]; var features = [ ]; this.builder = getBuilder(this, null, attrs, features); if (!this.ignored) { this.ready = this.ready  </s>
<s> &amp;&amp; !this.builder.async;  </s>
<s> this.doc = this.builder.startLoad("doc",  </s>
<s> "staff"); function attrname_tearDown() { this.builder.close(this.doc);  </s>
<s> this.doc = null; function suite() { var test = new DOMTestCase("attrname"); test.runTest  </s>
<s> = attrname_runTest; test.tearDown  </s>
<s> = attrname_tearDown; test.setUp  </s>
<s> = attrname_setUp; return test; The getBuilder() will cause the test to be ignored if the attributes and features are not compatible with the builder.  </s>
<s> I've written a few different builder implementations (MSXML, DOM 3 LS, Mozilla document.load  </s>
<s> and an iframe loader).  </s>
<s> To change builders currently you have to modify DOMTestSuite.js.  </s>
<s> function getBuilder(test, contentType, attributes, features) { // return new MSXMLBuilder(test, contentType, attributes, features, "MSXML2.DOMDocument.3.0"); // return new DOM3XMLBuilder(test, contentType, attributes, features); // return new MozillaXMLBuilder(test, contentType, attributes, features);  </s>
<s> return new IFrameBuilder(test, "text/html", attributes, features); This setting uses the IFrameBuilder to load .html  </s>
<s> documents.  </s>
<s> Replace "text/html" with contentType to load .xml  </s>
<s> documents.  </s>
<s> I was not able to get notified when I trying to add an iframe  </s>
<s> dynamically with document.writeln(),  </s>
<s> however it seems simpler to just generate the iframe elements into the test HTML files.  </s>
<s> Document loading is performed by two calls, startLoad() in setUp and load() in runTests.  </s>
<s> I've also added jsUnitCore.js to the files included in testRunner.html.  </s>
<s> That allows tests that want to avoid path dependencies to access jsUnitCore methods by using top.assertEquals(), etc.  </s>
<s> I've run the DOM L1 Core and L1 HTML tests with Mozilla 1.0 for both XML and HTML documents.  </s>
<s> Currently DOMTestSuite.js is hacked to suppress tests that use the extended interfaces (now marked with hasFeature("XML",""), since Mozilla XML doesn't attempt to parse the document type declaration.  </s>
<s> The majority of failures are due to failing to throw an exception.  </s>
<s> Unfortunately, I was not able to run the tests on Microsoft Interface Explorer.  </s>
<s> When the first test failed, I would get an exception not captured message even though the runTest method was clearly within the scope of a try/catch block.  </s>
<s> It is possible that I dorked something on my machine settings that is causing it to act that way.  </s>
<s> Modifications to the tests fell into these categories: DOM L1 Core tests that depended on extended interfaces (CDataSection, Entity, EntityReference, etc) were marked as requiring hasFeature("XML","") as true.  </s>
<s> Changed ignoreCase to "auto" on L1 Core hc_* tests and L1/L2 HTML tests where HTML implementations are expected to return uppercase.  </s>
<s> Changed some bad expected values on HTMLParam01 and 02.  </s>
<s> My hacked version of JSUnit is http://home.houston.rr.com/curta/jsunit.zip  </s>
<s> I've been running the DOM HTML Level 2 tests and have discovered that running the tests on IE6 takes approx 3 minutes while running the same tests on Mozilla takes approx 22 minutes.  </s>
<s> Has anyone else had similar results?  </s>
<s> Is there something I need to set/change within the Mozilla browser to make it run faster?  </s>
<s> Be sure you are running the DOM HTML 2 tests as text/html.  </s>
<s> My comparisons on a local webserver show on a PIII 700/Win2k box: IE6 [214 seconds, text/html], [1238 seconds, text/xml] Moz 1.0.1 [834 seconds, text/html], [1124 seconds, text/xml]  </s>
<s> I tried to run Bob's tests on my Windows XP and didn't have lots of success unfortunately.  </s>
<s> I wasn't able to try with Mozilla 1.0.1 but both Mozilla 1.0 and 1.1 didn't run the tests.  </s>
<s> IE6 becomes unstable when running the tests for Core (it crashed after 2 or 3 retries) but I managed to obtain a result for DOM level 2 HTML (see attachment).  </s>
<s> That is interesting data for the WG since it shows that some types in IE6 don't match the ones in the CR of DOM level 2 HTML.  </s>
<s> There are some uppercase/lowercase issue as well and some of them are probably errors in the tests themselves.  </s>
<s> A tagName will "BODY" if the document was HTML 4, and "body" if the document was XHTML 1.  </s>
<s> If someone has the output results from Mozilla 1.0.1, I'd like to have a look at them.  </s>
<s> Curt mentioned that createHTMLDocument and contentDocument tests were missing so I started to work on them.  </s>
<s> I have 2 for createHTMLDocument but are not able to test them for the moment unfortunately.  </s>
<s> Philippe  </s>
<s> I ran the tests again on a Pentium 4 1400MHz/Windows 2000 box.  </s>
<s> native implementation text/html alltests-suite-no-applets IE6 147 seconds Mozilla 1.1a 1095 seconds  </s>
<s> Philippe, When you run the test with Mozilla, try it with a fresh profile to make sure you haven't disabled features that are required for the framework such as opening windows, setting status bar, etc.  </s>
<s> To create a new profile, start mozilla like this: mozilla -profileManager After you create a fresh profile, can you run the standard jsUnit tests at If you can not run the standard tests, open the JavaScript Console (Tools- Web Developer- JavaScript Console) and copy/paste the error messages into an email and send them to me please.  </s>
<s> If you can run the standard jsUnit tests, please try the demo dom ts with Mozilla again.  </s>
<s> If it fails to run, please use the JavaScript Console and send me the error messages.  </s>
<s> When you ran the DOM Core 1/2 tests with IE6 which implementation did you use?  </s>
<s> native?  </s>
<s> MSXML 3 or 4? Which suite did you run?  </s>
<s> What version of MSXML do you have installed?  </s>
<s> You can find the msxml*.dll  </s>
<s> files in c:\winnt\system32\.  </s>
<s> Right click them and choose properties then the version tab.  </s>
<s> If no one else has the test results available, I will post them later today.  </s>
<s> Bob  </s>
<s> from the http://www.mozilla.org/  </s>
<s> home page Mozilla 1.1 Alpha Released Mozilla 1.1 Alpha is our bleeding edge alpha release which is meant to get wider testing for all the changes that happened on the trunk since we branched for Mozilla 1.0.  </s>
<s> See the release notes to find out what's new.  </s>
<s> The trunk is not really the best place to be testing at the moment.  </s>
<s> :-) you can find zip files and installers for Mozilla 1.0.1 at: I usually dl a zip version and unzip it into a separate location.  </s>
<s> It is usually easiest when running multiple versions.  </s>
<s> Bob  </s>
<s> Are you experiencing the same performance issues with my variant of JSUnit from earlier this week.  </s>
<s> A quick test this morning was about 350 seconds for text/html on Mozilla 1.0 on a Pentium III 700.  </s>
<s> Could not provide numbers for IE since any exception was stopping the tests on my machine.  </s>
<s> I did fix up a number of capitalization issues in the tests at that time that may not be reflected in Bob's demo.  </s>
