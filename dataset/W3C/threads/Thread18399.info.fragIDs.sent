<s> During the joint March 2001 f2f meeting, the DOM WG agreed to to add a way to enumerate the listeners attached to a Node: However, we are still not convinced on how this new property is useful for Authoring Tools and would like to see some use cases.  </s>
<s> See also [1] for an other proposal.  </s>
<s> Regards, Philippe [1] http://lists.w3.org/Archives/Public/www-dom/2001JulSep/0299.html  </s>
<s> Ray, It appears that you are complaining about issues that are a direct result of the DOM working group including only part of the requirements I had placed on you for PF. What would you have me say?  </s>
<s> Stop shooting yourself with the arrows?  </s>
<s> How does the user select these, by binary address?  </s>
<s> Again, when I wrote the requirements for the PF group, I had asked that the event type be available.  </s>
<s> How does the application construct the proper event, by trial and error?  </s>
<s> First, an authoring tool ought be able to do this.  </s>
<s> How might you expect a person to create an application without this capability?  </s>
<s> I also believe this may be implementation dependent.  </s>
<s> What if the user chooses to invoke functions that should never be user accessible, such as mutation events.  </s>
<s> If you new the "type" of event you could selectively pick those which you fire.  </s>
<s> So what might happen if the mutation event was fired.  </s>
<s> ... probably nothing since the application would look to see what changed.  </s>
<s> How does the DOM Level 3 script know which event type definition applies to the function, or which listeners must only be invoked in concert?  </s>
<s> Another requirement that I had placed on DOM 3 for PF was to be able to have a description for each event.  </s>
<s> Currently, there is no mechanism in script to store a description of the event function executed so I when I met with PF for DOM 3 I had asked that the function name be stored.  </s>
<s> Lauren Wood thought this was not an unreasonable request at the time.  </s>
<s> These are all fine questions.  </s>
<s> The bottom line here is that the DOM working group only implemented part of the requirements.  </s>
<s> There is not much I can do about that except that that if DOM 3 needs to be an interim step to where we want to go then lets take it.  </s>
<s> I would love to have had the DOM working group include all the PF requirements but you are going to do what you are going to do.  </s>
<s> What the DOM WG needed to do is: Enumerate all events by type For each event provide a description for future script writers to be able to store a text description.  </s>
<s> For now DOM implementers should store the function name here.  </s>
<s> (We had discussed this when I met at the face to face) Allow the user to be able to fire each event based on the information received from the type and description.  </s>
<s> What WCAG needs to do is: Define industry standard techniques for storing functional descriptions in web content.  </s>
<s> Come up with standard descriptions for common functions.  </s>
<s> Document a way for DOM implementers to retrieve them.  </s>
<s> Work with standards bodies, like that for ECMA script, to hav them accepted.  </s>
<s> People working in accessibility have had to fight for every beach head they can get.  </s>
<s> If the DOM working group implements part of what we asked in level 3 then it is easier to get the rest in 4.  </s>
<s> Rich Rich Schwerdtfeger Senior Technical Staff Member IBM Accessibility Center Research Division EMail/web: schwer@us.ibm.com "Two roads diverged in a wood, and I - I took the one less traveled by, and that has made all the difference.",  </s>
<s> Frost rayw@netscape.  </s>
<s> Whitmer) cc: "Ian B. Jacobs" ij@w3.org , Philippe Le Hegaret plh@w3.org , w3c-wai-ua@w3.org, w3c-wai-ua-request@w3.org,  </s>
<s> www-dom@w3.org  </s>
<s> 12/12/2001 Subject: Re: Enumeration of EventListeners in DOM Level 3 Events 11:39 AM  </s>
<s> Ian and Philippe, Fantastic!  </s>
<s> From an authoring tools perspective this is very useful.  </s>
<s> It allows a content developer to programmatically exercise the listeners individually so this has advantages to disabled as well as non-disabled users.  </s>
<s> From a disabled user perspective, the input device used to simulate the activate of each listener may be voice recogntion or some other  </s>
<s> specialized  </s>
<s> input device such as an onscreen keyboard combined with: big switch specialized keyboard (Don Johnston) Assistive technologies such as HPR could enumerate the listeners and allow the user to select which one to activate.  </s>
<s> This would aid with users creating web sites as well as accessing them.  </s>
<s> From a UI perspective a pop-up window showing the available functions to be executed in response  </s>
<s> to  </s>
<s> each event could be activated allowing the user to hear and speak which  </s>
<s> one  </s>
<s> to be activated ... and then of couse activate the appropriate one.  </s>
<s> How does the user select these, by binary address?  </s>
<s> How does the application construct the proper event, by trial and error?  </s>
<s> What if the user chooses to invoke functions that should never be user accessible, such as mutation events.  </s>
<s> If the WCAG group could do more with Script (require addition of function descriptions) it would be nice to have the ability to store the function description executed in response to a given event in which case a script developer could create a function description for those functions executed in response to an event that could be stored and access through the DOM.  </s>
<s> Currently DOM 3 is limited to providing the type definition.  </s>
<s> ... Perhaps for DOM 4 we could add this.  </s>
<s> How does the DOM Level 3 script know which event type definition applies to the function, or which listeners must only be invoked in concert?  </s>
<s> Ray Whitmer rayw@netscape.com  </s>
<s> I have removed www-dom because I believe you have referred to discussions that are not public.  </s>
<s> I added instead w3c-dom-ig.  </s>
<s> Adding the event type enumeration only fixes a small part of the fact that it is broken.  </s>
<s> There is no justification to ignore the other issues that have been repeated here.  </s>
<s> Enumeration of types leads to broken thinking about listeners, and enumeration of listeners is even worse because there are already methods for properly dispatching an event of any given type at a given node and the only reason to enumerate them would be to invoke them improperly.  </s>
<s> The place to get a list of possible types is from a specification, not from an enumeration, because you cannot dispatch previously-unknown types.  </s>
<s> The proper way to dispatch events to the listener is to call the dispatch function.  </s>
<s> And best way to know whether a listener responding to a specific type that you know and care about is present would be to ask specifically.  </s>
<s> Enumerating the types at a single node doesn't tell you the listeners that will respond to events on that node, and gives you more information that is useless and likely to be harmful.  </s>
<s> In all of this, there is no real justification for enumeration of types or listeners.  </s>
<s> The use cases we have seen only require knowing whether handlers will receive specific events of known types of a given node (notice that I did not say at a given node, because that is not the same as of, which is another part of what is broken with the enumeration).  </s>
<s> Since DOM Level 2, you can fire an event, and not in the haphazard way that is most likely to result if someone is manually invoking listeners, that will break the assumptions of the script writer about delivery of events according to the specification.  </s>
<s> We had no problem with our requirements -- only with those represented as coming to us "from WAI", which are broken and do not support use cases.  </s>
<s> I was told that the requirement that this feature was based upon was "let us enumerate listeners".  </s>
<s> If you had emphasized "let us enumerate listener types" instead of "let us enumerate listeners", I suspect that we would have been happier to do that instead.  </s>
<s> But either enumeration is broken when dictated as a requirement, because it ignores the real problems that needs to be solved and insists on a broken solution that doesn't even solve the problem at hand.  </s>
<s> Applications can only do this about event types they know about.  </s>
<s> Enumeration of event types you do not know about is useless at best.  </s>
<s> The ability to deal with a specific event type comes from an application following a specification.  </s>
<s> Events which are implementation dependent without subscribing to a standard specification cannot be properly invoked by an application.  </s>
<s> This is the fallacy of the thinking (that lead to the current situation) that you can blindly: 1. enumerate the events 2. list them on the menu 3. invoke them from the menu A far more real description would be: 1. Identify certain user-based event types that certain classes of users cannot generate due to an alternative UI -- this has nothing to do yet with what has been registered.  </s>
<s> 2. Carefully construct handling with alternate user interface for these types.  </s>
<s> For example, a keystroke requires a code, a mouse requires a position and button state, etc. 3. Permit the user to fire the carefully constructed events at the node in question.  </s>
<s> Presumably requiring the user to numerically speak the key codes or mouse coordinates is a bad thing so there is a significant amount of effort to design a suitable alternative UI for firing many UI events.  </s>
<s> The ability to do this is already completely available from DOM as it exists today.  </s>
<s> All that is missing is 4. Permitting these known specific event types to be omitted from the accessibility menu if there are no known listeners.  </s>
<s> This neither requires nor suggests as a good solution enumeration of listeners, which there is no reason for, nor even enumeration of event types registered on a particular node.  </s>
<s> It is quite possible to send bad info and crash the application by giving it a previously-impossible situation, such as a null reference.  </s>
<s> Willy-nilly invoking of handlers is not a good idea.  </s>
<s> Any application which permits events to be erroneously fired is badly broken.  </s>
<s> The application discussed here should only fire well-designed UI events, and enumerating lots of handlers it is clueless about is worse than useless.  </s>
<s> Far better to ask a question, "are events of this specific type that I can generate well handled by a listener"?  </s>
<s> That's easy.  </s>
<s> The function name is "handleEvent".  </s>
<s> Look at the IDL.  </s>
<s> You can make it a constant in your program, but it solves no problems.  </s>
<s> Javascript implementations may make a wrapper outside of DOM of an arbitrarily-named function, but according to the DOM specification, the IDL fixes the name, and if you give Netscape an object, as the specification states and do not rely on this wrappering, it must be named handleEvent.  </s>
<s> Also, it is flawed to present this name as a menu item to a user, because it implies that he can invoke the single handler individually, and it would be broken to do so, because handlers of a specific type work in concert.  </s>
<s> One key handler may handle the letter "Q" to quit a specific mode.  </s>
<s> The parent may handle all other keystrokes.  </s>
<s> The only way to properly invoke the key handlers is together.  </s>
<s> Even if it says "QuitState", it will not quit the state of the program unless it gets the Q and the proper way to fire a keystroke is at all applicable handlers until one cancels.  </s>
<s> They are likely to rely on each other.  </s>
<s> These PF requirements are very poor and broken.  </s>
<s> Hacks at best that won't work well a majority of the time.  </s>
<s> We have talked to you for quite some time about your specifying semantic events (that would make sense to enumerate and would be able to automatically appear on a menu, etc.) but you haven't done them, and "you are going to do what you are going to do".  </s>
<s> This is much better than the hacks you are pursuing today, IMO.  </s>
<s> The bottom line is several of the DOM group objected to the requirements -- as we did at the time -- because they said "enumerate listeners", which was obviously broken and had already been repeatedly rejected for similar reasons.  </s>
<s> But it kept getting left in because it came from WAI, ignoring a discussion of the merits.  </s>
<s> It needs to be fixed or eliminated.  </s>
<s> If the requirements had had anything to do with the real accessibility use cases and had acknowledged the existing state and design of DOM, then we would be a lot further along today.  </s>
<s> An event is something that is delivered to a listener.  </s>
<s> There are never any events attached to a node to enumerate.  </s>
<s> Enumerating listeners is a very broken approach, because the code itself is the most concise description of what a handler will do.  </s>
<s> As much as you would like them to be semantic, they are not.  </s>
<s> Just adding a semantic description does not help in the least.  </s>
<s> The function name is a constant.  </s>
<s> And if you had access to it, it would be improper at several levels, as I have explained, to present it to the user.  </s>
<s> The DOM implementation knows no function name, because according to the DOM specification, the name of the handler is always the same.  </s>
<s> Even if it did, it would be completely wrong to present it to the user except in a few limited circumstances that you have not advocated a way of detecting.  </s>
<s> I will strongly oppose the ability to individually fire events -- not in concert as the DOM specification requires -- because it breaks compatibility with DOM level 2 and breaks the assumptions people make when they write scripts -- that they work in concert.  </s>
<s> If you want that type of model,design it.  </s>
<s> Don't blame other non-semantic systems for not being semantic.  </s>
<s> You can keep trying to shift blame, but the problem is that the WAI group has not produced semantic events, which has been ignored for quite some time.  </s>
<s> Then, the accessibility guidelines can require that for accessibility purposes, non-semantic events should restrict themselves to dealing with the UI and then invoking semantic events.  </s>
<s> This is entirely wrong.  </s>
<s> Even if you could store a functional description of what a particular mouse click handler would do, it would be nearly impossible for an accessibility provider to intelligently use a description of what many, and likely most, typical UI event handlers do.  </s>
<s> You need to simplify, and use semantic events to establish a level that can be intelligently invoked from alternative UIs.  </s>
<s> This is way more than you need to do, and the result is not as useful as simple semantic events.  </s>
<s> What you are fighting for here is useless.  </s>
<s> Start listening.  </s>
<s> Hacking UI events will never be a good solution, no matter how you decorate them.  </s>
<s> Especially as you begin adding new requirements on the script writer, why maintain the hackish approach when you can move towards a simple semantic design that will be easier for everyone.  </s>
<s> As I have said, the ability to ask about the presence of a specific type of listener in the hierarchy of a particular node is something we could discuss, but you have a lot of broken ideas in this writeup to overcome, so don't blame us that you didn't do symantic events.  </s>
<s> They are not that hard.  </s>
<s> Ray Whitmer rayw@netscape.com  </s>
