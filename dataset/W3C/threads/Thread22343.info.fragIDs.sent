<s> [ the following suggestions are based on WD-DOM-Level-2-19990222. ] Event Flow this paragraph suggest that there is a top-down dispatch of events, but this dispatch mechanism is not specified.  </s>
<s> Plus, although it seems quite natural for UI events, because you can defined how theses events are dispatched down the DOM tree, using x,y coordinates, or knowing which Node has the focus, I'm not sure what this means for other kind of events (logical &amp; mutation events).  </s>
<s> Maybe 'dispatching' should be defined only for x,y related events  </s>
<s> I think Event Flow should describe both 'Dispatching' and 'Bubbling', and both of these should be detailed like bubbling is.  </s>
<s> Capturing: Once you've described how dispatching works, you realize that the capturing stuff is not well defined anymore.  </s>
<s> In fact (especially since this is currently using the same interfaces) 'capturing' simply means 'dispatching cancellation', just like you have 'bubbling cancellation'.  </s>
<s> I think this should be symmetrical: you should either have a reserved term for 'bubbling cancellation', or you should not talk about 'capturing'.  </s>
<s> I also have one special grief against Event.cancelCapture, which is a poor name for specifying 'please do not propagate this event to my descendents'.  </s>
<s> I'd rather see something like 'cancelDispatch', which would be more consistent to 'cancelBubble'.  </s>
<s> The bottom line is that I think the event flow should talk more about dispatching, and dispatching and bubbling should be more symmetrical.  </s>
<s> Event Cancellation what's the rationale behind using a property for cancellation instead of a method ?  </s>
<s> this seems more a risk than a feature to me, because it forbids to specify cancellation policy when more than one listener are set.  </s>
<s> Typically, using the existing mechanism, you cannot predict what happens if one listener sets this attribute to true and the other sets it to false.  </s>
<s> I can see two different options that would be much easier to specify: - use a method (cancelBubble() or cancel()), and specify that bubbling is cancelled if at least one of the listeners calls this method.  </s>
<s> - use handleEvent return value to specify that bubbling is cancelled if at least one of the listeners return 'true'  </s>
<s> Listening vs. Capturing Right now, if I set a listener on a given Node, there is no way to know if the listener is triggered during the dispatch phase, or the bubbling phase (well, you implicitly know it, because you set the useCapture flag accordingly to what you want this listener to do - but nothing prevents you to try to use a listener designed for capture as a bubbling listener).  </s>
<s> This also prevents you to set one Listener both as 'capturer' and 'listener', since the same method is going to be called in both contexts.  </s>
<s> I think there should be a distinction somewhere for these different contexts.  </s>
<s> I can see two different options: - define different Listener types (you would add Filters for listening to the dispatch phase, and you would add Listeners for listening to the the bubbling phase).  </s>
<s> so EventTarget would be: interface EventTarget { void addEventFilter(in DOMString type, in boolean postProcess, in EventFilter listener); void removeEventFilter(in DOMString type, in boolean postProcess, in EventFilter listener); void addEventListener(in DOMString type, in boolean postProcess, in EventListener listener); void removeEventListener(in DOMString type, in boolean postProcess, in EventListener listener); so we could have: interface EventListener { void handleEvent(in Event event); interface EventFilter { void filterEvent(in Event event); and Event could simply have a cancel() method, specified as 'cancelling the event flow (both dispatching and bubbling) as soon as one listener calls it.  </s>
<s> - have two methods on Listeners, one for capturing, and one for listening.  </s>
<s> interface EventListener { void handleEvent(in Event event); void filterEvent(in Event event); But this would imply calling the filtering method many times when it's not required.  </s>
<s> EventTarget.removeEventListener the spec should say what happens if a listener removes itself, while it is handling an event.  </s>
<s> On the same topic, it should also say what happens to the Event Flow if you remove the dispatching node (or any ancestor) inside an event handler.  </s>
<s> addEventListener / postProcess I'd like to understand what's behind this.  </s>
<s> My feeling is that when you write a script, you are relying on an unknown DOM implementation.  </s>
<s> So how would you know if you should set postProcess to true or not ?  </s>
<s> Actions these objects are mentioned when describing.  </s>
<s> I think this is linked to my question about postProcessing: whether we have an idea what a DOM implementation is doing (what the default actions are), and the spec should mention where/when and how these actions take in the event flow, or actions are not well defined, and the spec shouldn't mention them.  </s>
<s> My feeling is that something's missing here, maybe it's just an entry in the terminology.  </s>
<s> Mutating Events the spec should say if events can be mutated (their properties can be changed) by a filter or a handler, and what effect this has on the event flow.  </s>
<s> Typically, what happens if I, as an event filter, modify the X,V coordinates of an event ?  </s>
<s> Does this modifies subsequent dispatch or not ?  </s>
<s> Misc questions can a script generate an event from a given node ?  </s>
<s> jm.  </s>
<s> Downward propagation during capturing follows the tree structure down to the event target just as bubbling follows the tree structure upward.  </s>
<s> Coordinates are not brought into play as the DOM is unware of such things.  </s>
<s> So let me sum up my comments to all of the above here.  </s>
<s> I know I need to clarify the text of capturing and bubbling.  </s>
<s> This is on my to do list.  </s>
<s> But let me try to explain a bit here, anyway.  </s>
<s> Capturing is intended to be the symmetrical opposite of bubbling.  </s>
<s> The  </s>
<s> use of the word dispatching may be being used in an improper context within the spec but it has no special meaning.  </s>
<s> Dispatching an event to a given Node simply implies that the event listeners on that Node will be called.  </s>
<s> The term is equally applicable within the context of either bubbling or capturing.  </s>
<s> I believe, however, , most of your above statements agree with out intent once you substitute 'capture' for 'dispatch'.  </s>
<s> I believe the initial rationale (based on carryover from IE4) was that, during bubbling, higher Nodes in tree could query and/or override the value set by lower Nodes.  </s>
<s> That is true.  </s>
<s> And if we were maintaining the old policy of a single listener per Node I'd say that was fine.  </s>
<s> But you have a point.  </s>
<s> If we allow multiple unordered listeners per Node (which is the current plan) then the behavior is totally unpredictable.  </s>
<s> If we were to allow ordering (still on the table) then we might want to keep this, again.  </s>
<s> I'll raise these with the group.  </s>
<s> Another option would be to provide the user sufficient information to know if they're being called in the capturing or bubbling phase.  </s>
<s> Okay. Offhand I'd say it completes its handling.  </s>
<s> The existence of the event handler would only need to be checked when the event is trying to find the next listener to be called.  </s>
<s> Good question.  </s>
<s> This has come up before and we don't have a good answer yet.  </s>
<s> Well postProcess isn't based too much on implementation.  </s>
<s> In the case of mutation events its easy.  </s>
<s> If a Node is being added, I can react either before or after the addition.  </s>
<s> In the case of UI events, its less clear.  </s>
<s> And in some cases, invalid.  </s>
<s> We've discussed that some event might need to be handled as preProcessed only and that such would be noted on the event description but this hasn't made it into the spec yet.  </s>
<s> No, unfortunately you are somewhat correct.  </s>
<s> We do not plan on defing the default actions and they will likely vary by implementation.  </s>
<s> As far as where they fit in terms of event flow, yes can be more clear.  </s>
<s> I'll try to make it so.  </s>
<s> But the actions themselves are left to the implementation.  </s>
<s> We've had discussion both ways on this.  </s>
<s> That's largely why its undefined.  </s>
<s> That essentially deals with the same subject as changing the event properties.  </s>
<s> There has been discussion of allows creation and dispatch of events.  </s>
<s> This is one of the reasons the Event objects properties are read/write.  </s>
<s> However, its unknown whether this will be in the spec or not.  </s>
<s> If not, we could possibly make the Event object properties read-only and solve the above question as well.  </s>
<s> In that case, perhaps it should be called trickling?  </s>
<s> John Cowanhttp://www.ccil.org/~cowancowan@ccil.org  </s>
<s> You tollerday donsk?  </s>
<s> N.  </s>
<s> You tolkatiff scowegian?  </s>
<s> Nn.  </s>
<s> You spigotty anglease?  </s>
<s> Nnn.  </s>
<s> You phonio saxo?  </s>
<s> Nnnn.  </s>
<s> Clear all so! 'Tis a Jute.... (Finnegans Wake 16.5)  </s>
