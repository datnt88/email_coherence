<s> (moved from the comments list) Peter suggests following the IRI wording from "Namespaces in XML 1.1" rather than the current wording in concepts.  </s>
<s> This is essentially editorial, although Peter raises a substantive issue to do with control characters.  </s>
<s> Personally my preference would be to follow Martin Durst's advice ... [here  </s>
<s> at least :) ].  </s>
<s> Jeremy  </s>
<s> From: Peter F. Patel-Schneider [mailto:pfps@research.bell-labs.com]  </s>
<s> Sent: 09 September 2003 12:15 Subject: Re: escaping % in RDF URI references My reading on this issue indicates that it is a mess.  </s>
<s> My guess is that the intent is to make RDF URI references be absolute IRIs with optional fragment identifiers.  </s>
<s> This intent is, however, almost impossible to decipher, even with the ``compatability with IRI'' note.  </s>
<s> The wording in the ``Namespaces in XML 1.1'' document is *much* preferable.  </s>
<s> It lays out the intent, gives reasons why the intent cannot be specified with just a pointer, provides a temporary solution, and finally gives a way towards a permanent solution.  </s>
<s> Why isn't the same route taken in RDF concepts?  </s>
<s> I don't view the current test in RDF Concepts as acceptable.  </s>
<s> peter PS: It appears to me that the translation in RDF Concepts is different from the translation in Namespaces in XML 1.1.  </s>
<s> In particular, RDF concepts allows control characters whereas Namespaces in XML 1.1 does not.  </s>
<s> From: Jeremy Carroll jjc@hpl.hp.com Subject: Re: escaping % in RDF URI references Date: Mon, 8 Sep 2003 17:52:44 +0300  </s>
<s> It appears to me that RDF Concepts does not require % to be  </s>
<s> %-escaped in  </s>
<s> RDF URI references (Section 6.4).  </s>
<s> Surely this is a bug.  </s>
<s> Hi Peter In response to your message The requirement to not escape % is derived from the the other  </s>
<s> specifications  </s>
<s> from which the text you mention is taken.  </s>
<s> See, which links to The grammar in is perhaps the most useful, this indicates that % is only  </s>
<s> allowed in IRIs when  </s>
<s> part of an escape sequence, and not otherwise.  </s>
<s> Thus rdf:RDF rdf:Description rdf:about="http://example.org/bar%foo" eg:prop val /eg:prop /rdf:Description /rdf:RDF is not legal, whereas rdf:RDF rdf:Description rdf:about="http://example.org/foo%bar" eg:prop val /eg:prop /rdf:Description /rdf:RDF is legal (but does not represent an IRI in UTF-8 encoding).  </s>
<s> In a discussion of your comment, the RDF Core WG was inclined  </s>
<s> to add one or  </s>
<s> more test cases (e.g. these two) and make no other changes.  </s>
<s> Would that satisfy you?  </s>
<s> If so I will formally propose these  </s>
<s> tests and get back  </s>
<s> to you once they have been added to the RDF test suite.  </s>
<s> If you believe that the design choice is fundamentally mistaken  </s>
<s> I believe that  </s>
<s> it would be more effective to take that up with the IRI  </s>
<s> editors, perhaps on  </s>
<s> uri@w3.org or w3c-i18n-ig@w3.org  </s>
<s> Jeremy  </s>
<s> Are you suggesting soliciting further advice?  </s>
<s> Brian  </s>
<s> Jeremy:  </s>
<s> [here  </s>
<s> Brian:  </s>
<s> Yes - Martin any comments, would it be better to go with our current text 6.4 RDF URI References A URI reference within an RDF graph (an RDF URI reference) is a Unicode string [UNICODE] that would produce a valid URI character sequence (per RFC2396 [URI], sections 2.1) representing an absolute URI with optional fragment identifier when subjected to the encoding described below.  </s>
<s> The encoding consists of: 1. encoding the Unicode string as UTF-8 [RFC-2279], giving a sequence of octet values.  </s>
<s> %-escaping octets that do not correspond to permitted US-ASCII characters.  </s>
<s> 2. The disallowed octets that must be %-escaped include all those that do not correspond to US-ASCII characters, and the excluded characters listed in Section 2.4 of [URI], except for the number sign (#), percent sign (%), and the square bracket characters re-allowed in [RFC-2732].  </s>
<s> Disallowed octets must be escaped with the URI escaping mechanism (that is, converted to %HH, where HH is the 2-digit hexadecimal numeral corresponding to the octet value).  </s>
<s> Two RDF URI references are equal if and only if they compare as equal, character by character, as Unicode strings.  </s>
<s> Note: RDF URI references are compatible with the anyURI datatype as defined by XML schema datatypes [XML-SCHEMA2], constrained to be an absolute rather than a relative URI reference.  </s>
<s> Note: RDF URI references are compatible with International Resource Identifiers as defined by [XML Namespaces 1.1].  </s>
<s> Note: The restriction to absolute URI references is found in this abstract syntax.  </s>
<s> When there is a well-defined base URI, concrete syntaxes, such as RDF/XML, may permit relative URIs as a shorthand for such absolute URI references.  </s>
<s> or text based on Work is currently in progress to produce an RFC defining Internationalized Resource Identifiers (IRIs).  </s>
<s> Since this work is not yet complete, in this section we give a syntactic definition of IRIs for the purposes of this specification.  </s>
<s> We expect to issue an erratum replacing this section with a reference to the RFC when it is published.  </s>
<s> Users defining namespaces are advised to restrict namespace names to URIs until software supporting IRIs is in common use.  </s>
<s> For a more general definition and discussion of IRIs see [IRI draft] (work in progress).  </s>
<s> URI references are restricted to a subset of the ASCII characters; IRI references allow some of the disallowed ASCII characters as well as most Unicode characters from #xA0 onwards.  </s>
<s> [Definition: The additional characters allowed in IRIs are: ] + space #x20 + the delimiters  #x3C,  #x3E and " #x22 + the unwise characters { #x7B, } #x7D, | #x7C, \ #x5C, ^ #x5E and ` #x60 + the Unicode plane 0 characters #xA0 - #xD7FF, #xF900-#xFDCF, #xFDF0-#xFFEF + the Unicode plane 1-14 characters #x10000-#x1FFFD ... #xE000-#xEFFD [Definition: An IRI reference is a string that can be converted to a URI reference by escaping all additional characters as follows: ] 1.  </s>
<s> Each additional character is converted to UTF-8 [Unicode 3.2] as one or more bytes.  </s>
<s> 2. The resulting bytes are escaped with the URI escaping mechanism (that is, converted to %HH, where HH is the hexadecimal notation of the byte value).  </s>
<s> The original character is replaced by the resulting character sequence.  </s>
<s> Noting that RDF Core WG has declined a comment suggesting using the term IRI thoughout, so that the definition would remain a definition of "RDF URI references".  </s>
<s> A specific question is ctrl characters - should they be allowed or not?  </s>
<s> Jeremy  </s>
<s> Hello Jeremy, Sorry for not responding back to you earlier, I was traveling for the last two weeks, and will be on vacation until up and including next Monday.  </s>
<s> Control characters should not be allowed in URIs/IRIs.  </s>
<s> The potential of control characters got into RDF I think from the fact that The XML text was carefully crafted with the restrictions (actually now to some extent removed in XML 1.1) of XML in mind.  </s>
<s> In addition, there has been a prolonged discussion about whether to allow spaces and other ASCII characters not allowed in URIs (such as ' ' and ' ',...).  </s>
<s> After feedback from XML Schema (re.  </s>
<s> space), rather strong mails to the TAG and clear opinions at the IETF in San Francisco, we have had to removed these characters again from the definition.  </s>
<s> For details, please see http://www.w3.org/International/iri-edit.  </s>
<s> The current text still allows for specifications to allow such characters before a transform to IRIs.  </s>
<s> But in particular for RDF, this is not really advisable, because either this complicates the parser (defining that the parser changes " " to "%20", and so on), or it will create differences for comparison of IRIs across specs (because with character-by-character comparison,  </s>
<s> and "%20" do not compare equally).  </s>
<s> As for the texts, I think both of them have advantages and disadvantages.  </s>
<s> The best thing is to hurry up with the IRI spec and remove these problems.  </s>
<s> Regards, Martin.  </s>
