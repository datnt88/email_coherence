Hi Tidyers, I need some help / advice please. 
TidyCom is a COM wrapper for HTML Tidy (this just means you can use Tidy 
from within programming languages for Windows) and it's based on the 
2000-08-04 version of HTML Tidy. 
TidyCom is no longer being developed or maintained. 
I'm using TidyCom from dotnet's C# programming language and generally it works fine. 
However the 2000-08-04 version of Tidy does not implement the "repeated-attributes" option and this is something I now need as certain pages that my software must dynamically Tidy have several elements with repeated attributes in them. 
Is there another way of getting rid of these repeated attributes or getting rid of any section / element that contains them; it would be fine if -say- the entire element, that contains a repeated attribute, were to be just completely left out of the Tidied document? 
Is there an alternative to TidyCom? 
In other words some way of Tidying a html file from a programming language that allows me to output in xml. 
Why does the 2000-08-04 version of Tidy not output proper XML when you set "output-xml" to be true? 
Anyone who's interested can find TidyCom @ TidyCom: http://perso.wanadoo.fr/ablavier/TidyCOM/ 
Many thanks and regards, ..matthew 
My only thought is that it might not be much work to update TidyCOM with the current CVS at http://sf.net/projects/tidy/. 
I believe the diffs of the source files for the tidylib component of TidyCOM are small (diffs to 2000-08-04, that is). 
I would save those diffs in a separate file. 
Replace the tidylib sources from SourceForge and re-apply the changes. 
I think there are just a couple. 
At any rate, I did this once and it took an hour. 
hope this helps, Charlie 
Julian, 
You are welcome to my code but -at present- it just uses TidyCom. 
I now need Tidy options not implemented in TidyCom and so, over the next few days, I am going to try and sort this out, probably by converting JTidy source to C# using one of the utilities. 
You would be welcome to the code for this too. 
IMPORTANT: Are you running Visual Studio dotnet? 
Or just dotnet? 
Regards, ..matthew 
Hi Matthew, Sorry to bother you, but I have just spotted your posting on the HtmlTidy mailing list. 
I need to use Tidy within a C# ASP.net app that I am creating and was wondering if you were willing to share your implementation code? 
I have looked briefly at TidyCom, but was concerned that it was an old build and that the developer was no longer developing it. 
If you are feeling generous...... Cheers, Julian Voelcker The Virtual World (UK) Limited Cirencester, United Kingdom 
Wow. If you convert Tidy to C#, you would be my hero forever. 
:) But looking at the JTidy page, it *looks* like it's a port of the Aug. 2000 code. 
I also want the recent options. 
Does JTidy keep current with the ongoing tidy.sf.net development? 
/Jelks 
Hi Matthew, 
I'm using VS.net - does that matter? 
That would be excellent if you did provide a copy of the code - have you thought about putting it on the sourceforge site for others to work on? 
My background is with ASP.old, but have been working with C# non stop since the beginning of the year and would be happy to help out if necessary. 
I also have a friend who co-authored some of the Wrox ASP.net books and is currently working on a book on developing server controls - he is very keen to use Tidy for an editor component he has written so may also be a valuable source of info. 
Do let me know what I can do to help. 
Cheers, Julian Voelcker The Virtual World (UK) Limited Cirencester, United Kingdom 
Because I'm not, I just have dotnet installed no VS.net. 
There is a VS.net utility called JUMP, still in beta, for VS.net (URL below) which converts Java to C#. I have no idea if it works well or not. 
If you'd be prepared to convert the JTidy source using JUMP I'll take the C# Jtidy code (lets call it CSTidy) and try to get it working. 
When it works I'll email you the code and we can make it publicly available via the Tidy/JTidy web pages. 
What do you think? 
JUMP is @ Regards, ..matthew 
No problem doing the conversion. 
I have downloaded the Addin for VS.net and the JTidy code, but cannot access the readme for the addin to work out how to use it. 
Can you get it from your end? 
I'll have a look, but what exactly do you want me to find. 
Just to warn you, I'm trying to merge the TidyCOM source with the latest Tidy source to get the latest options working from TidyCOM. 
If I succeed then the JTidy to C# will have to take the back burner till I have more time available - unless it's easy in which case I'll sort it out immediately. 
I am worried by Jelks's email to the mailing list, to refresh your memory Wow. 
If you convert Tidy to C#, you would be my hero forever. 
:) But looking at the JTidy page, it *looks* like it's a port of the Aug. 2000 code. 
I also want the recent options. 
Does JTidy keep current with the ongoing tidy.sf.net development? 
/Jelks If JTidy is not based on a later version of Tidy than TidyCom then there's little point in going ahead from my point of view. 
I need the latest options. 
Can you (or anyone) shed some light on this. 
BTW - Where are you? 
London. 
I haven't been to Cirencester in 10 years, but a good friend grew up near there and I used to stay with him and his family for weekends in the country, so I used to know the area a bit - I grew up in Oxford, not a 1,000,000 miles away. 
Thanks and regards, ..matthew 
Julian, Many thanks for using JUMP to do the conversion of JTidy java source to C# and emailing me the files. 
Unfortunately JUMP does not seem capable of handling 'complex' Java programs. 
I compiled the C# code and got lots of errors, I was expecting this though. 
However the following message appeared 165 times in the converted code: "//UPGRADE_TODO: The equivalent in .NET for ... will be considered in a future release." 
This informs you that methods, expressions, classes, etc. have different behaviour in .net 
from Java or simply have no equivalent (EG. 
Java Beans) and that they may sort this out in a future release. 
On the up-side 142 of the errors are the same error and refer to a specific GetString() method. 
I will investigate how easily these 'errors' can be manually fixed and if I think I can do it, I'll give it a go. 
I'm also trying to update TidyCOM but have a few unresolved external symbol linking errors (the worst error as it doesn't show you very well where the problem occurs). 
At the moment updating TidyCOM seems the simplest option. 
By the way although I have no idea which version of Tidy JTidy is based on it seems to handle post TidyCOM options (EG. 
'repeated_attribute', 'doctype'). 
Which version of the JTidy source did you convert? 
You will be kept informed of my progress. 
I got back from a meeting to see both your request for my phone number and the source code, so assumed it was too late for the phone call. 
Many thanks for doing the JUMP conversion, I appreciate it. 
Regards, ..matthew 
Thanks Matthew. 
One of things that came up in the conversion was that I had to setup the java files in a J++ project and then convert - I set it up as COM dll - I assume that was right. 
The JTidy source I used was based on the Aug 2000 version of Tidy, which should be the same as TidyCom. 
Let me know if you need me to do any more. 
Cheers, Julian Voelcker The Virtual World (UK) Limited Cirencester, United Kingdom 
