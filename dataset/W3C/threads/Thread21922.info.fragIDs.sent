<s> A few quick observations: Xalan loads its parser via JAXP.  </s>
<s> It normally ships with, and defaults to using, Xerces, but should be able to work with others.  </s>
<s> Xalan requires that xml-apis.jar  </s>
<s> be on the classpath.  </s>
<s> This is a first step toward factoring DOM, SAX, JAXP, TRAX, and related standardized code out of the individual Apache projects and into a shared library.  </s>
<s> See also the XML-COMMONS project at Apache for more information.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> Copying xalan.jar,  </s>
<s> xerces.jar,  </s>
<s> xml-apis.jar  </s>
<s> and xsltc.jar to the Ant 1.4.1 bin directory allowed the style task to run, but it still fails for alltests.xml  </s>
<s> and for random other tests either with a can't load document or Unknown error in XPath.  </s>
<s> The Unknown error in XPath thing (delete tests/level1/core/alltests.xml to move to other tests) is strange in that it does not occur when invoking Xalan from the command line, but does occur from Ant.  </s>
<s> The build process is a good stress test for Xalan, but currently 2.2D14 is not a viable option for domts building.  </s>
<s> Last time I successfully built the DOM TS was with Xalan 2.2D11.  </s>
<s> However, even with these binaries, I now get similar results to those that Curt indicates, either failing to load documents or unknown XPath errors (usng both Ant 1.4 and Ant 1.4.1).  </s>
<s> In the verbatims below, I've used Ant 1.4.  </s>
<s> As one of Joe's emails indicated that xml-apis.jar  </s>
<s> needs to be on the classpath, but given that previous emails indicate that nothing except for xalan.jar and xerces.jar  </s>
<s> needs to be known by Ant (by putting them in the ant/lib directory) in order to build, can someone who manages to build the most current checkout from the CVS send to the list an exact setup for Ant, xalan and xerces?  </s>
<s> For example, here is my current setup: Ant 1.4, ANT-HOME properly set, lib directory consists of xalan.jar  </s>
<s> (from the 2.2D11 distribution) xerces.jar  </s>
<s> (from the 2.2D11 distribution) jakarta-ant-1.4-optional.jar  </s>
<s> README ant.jar with the xalan2.2D11  </s>
<s> binaries on the Path gives the following results: [localhost:DOMTStest/2001/DOM-Test-Suite] dimitris% ant dom1-core-jar Buildfile: build.xml  </s>
<s> init: common-javac: [javac] Compiling 7 source files to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/java dom1-init: [get] Getting: http://www.w3.org/TR/1998/REC-DOM- Level-1-19981001/DOM.zip [get] Not modified - so not downloaded [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/DOM.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1 [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml-source.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/Level-1 [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/definitions/level-one-core/element.xml dom1-interfaces: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/dom1-interfaces.xml [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/extract.xsl dom1-dtd: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/dom1.dtd [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/dom-to-dtd.xsl [copy] Copying 1 file to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/tests/level1/core dom1-core-gen-java: [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/test-to-java.xsl [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Failed to process /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/tests/level1/core/attrparentnodenull.xml BUILD FAILED /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build.xml:528: javax.xml.transform.TransformerException:  </s>
<s> Unknown error in XPath Total time: 41 seconds Identical setup, not including the xalan2.2D11  </s>
<s> binaries on the path (as has been reported a proper setup, this is what the build document currently says): [localhost:DOMTStest/2001/DOM-Test-Suite] dimitris% ant dom1-core-jar Buildfile: build.xml  </s>
<s> init: common-javac: [javac] Compiling 7 source files to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/java dom1-init: [get] Getting: http://www.w3.org/TR/1998/REC-DOM- Level-1-19981001/DOM.zip [get] Not modified - so not downloaded [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/DOM.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1 [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml-source.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/Level-1 [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/definitions/level-one-core/element.xml dom1-interfaces: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/dom1-interfaces.xml [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/extract.xsl dom1-dtd: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/dom1.dtd [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/dom-to-dtd.xsl [copy] Copying 1 file to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/tests/level1/core dom1-core-gen-java: [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/test-to-java.xsl [style] Transforming into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/java/org/w3c/domts/level1/core [style] Failed to process /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/tests/level1/core/attrprevioussiblingnull.xml BUILD FAILED /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build.xml:528: javax.xml.transform.TransformerException:  </s>
<s> Unknown error in XPath Total time: 41 seconds In both cases, the [style] task fails, has not done so before, so either the style has changed and locks xalan up, or the setup is wrong.  </s>
<s> In both cases, I've used directions sent to this list (that have previously worked, last time two weeks ago at the DOM WG F2F demo).  </s>
<s> Using similar setup, keeping the original crimson.jar and jaxp.jar from the Ant distribution and only adding the ant-optional.jar  </s>
<s> file and xalan.jar from xalan2.2D11 (which has been reported to lock xalan up previously): [localhost:DOMTStest/2001/DOM-Test-Suite] dimitris% ant dom1-core-jar Buildfile: build.xml  </s>
<s> init: common-javac: [javac] Compiling 7 source files to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/java dom1-init: [get] Getting: http://www.w3.org/TR/1998/REC-DOM- Level-1-19981001/DOM.zip [get] Not modified - so not downloaded [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/DOM.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1 [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml-source.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/Level-1 [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/definitions/level-one-core/element.xml dom1-interfaces: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/dom1-interfaces.xml [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/extract.xsl [style] Using original entity definition for "". [style] Using original entity definition for "". [style] Using original entity definition for "&amp;amp;".  </s>
<s> [style] Using original entity definition for "&amp;apos;".  </s>
<s> [style] Using original entity definition for "". [style] Failed to process /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml BUILD FAILED /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build.xml:279: javax.xml.transform.TransformerException: java.net.UnknownHostException: Users Total time: 8 seconds And, putting the xalan2.2D11  </s>
<s> binaries back on the path: [localhost:DOMTStest/2001/DOM-Test-Suite] dimitris% ant dom1-core-jar Buildfile: build.xml  </s>
<s> init: common-javac: [javac] Compiling 7 source files to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build/java dom1-init: [get] Getting: http://www.w3.org/TR/1998/REC-DOM- Level-1-19981001/DOM.zip [get] Not modified - so not downloaded [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/DOM.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1 [unzip] Expanding: /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml-source.zip into /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/lib/specs/Level-1 [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml [patch] patching file /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/definitions/level-one-core/element.xml dom1-interfaces: [style] Processing /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml to /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/build/dom1-interfaces.xml [style] Loading stylesheet /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/transforms/extract.xsl [style] Using original entity definition for "". [style] Using original entity definition for "". [style] Using original entity definition for "&amp;amp;".  </s>
<s> [style] Using original entity definition for "&amp;apos;".  </s>
<s> [style] Using original entity definition for "". [style] Failed to process /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test- Suite/lib/specs/Level-1/xml/wd-dom.xml BUILD FAILED /Users/dimitris/Desktop/DOMTStest/2001/DOM-Test-Suite/build.xml:279: javax.xml.transform.TransformerException: java.net.UnknownHostException: Users Total time: 10 seconds Which doesn't seem to help much, even though xalan's binaries are there.  </s>
<s> Could it be that the Ant.jar in xalan's bin directory messes things up?  </s>
<s> Or is it something else?  </s>
<s> Again, please report your current (working) setup to the list so that I can update the build documentation accordingly and get our environments to work.  </s>
<s> As a side question, when checking out as dom-ts-1 I get a cvs [checkout aborted]: end of file from server (consult above messages if any) error, whoch does not happen when I check out as anonymous.  </s>
<s> Either I've done strange things to my machine or something's wrong.  </s>
<s> Can someone try to checkout and see if it works?  </s>
<s> /Dimitris  </s>
<s> Grumph.  </s>
<s> I know almost nothing about how Ant invokes Xalan, but I'll talk to folks here and see if we can figure this out.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> Actually, since xalan includes ant binaries, it may be a good idea.  </s>
<s> Thanks, Joe.  </s>
<s> /Dimitris  </s>
<s> I noticed that xml-apis.jar is not part of the xalan2.2D11  </s>
<s> distribution, but it's there in D13 and D14.  </s>
<s> Is this the way it should?  </s>
<s> And if so, does it mean (for us) that we put not only xalan, but also xml-apis.jar  </s>
<s> (and perhaps others as well) in the ant/lib directory?  </s>
<s> /Dimitris  </s>
<s> On Tuesday, 12/04/2001 at 06:43 CET, Dimitris Dimitriadis  </s>
<s> Yes. This was introduced in D13 (after dithering about it for many versions...).  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> Some of the class files in xalan and xerces are moved to xml-apis.jar.  </s>
<s> I think Build.xml should be changed accordingly so that it points to the correct location and also include xml-apis.jar  </s>
<s> in the ant/lib directory.  </s>
<s> Sivakiran Tummala  </s>
