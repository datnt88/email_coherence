<s> Regarding the advantages of persistent connections listed in section 8.1.1, under heading "Persistent HTTP connections have a number of advantages", one is missing (latency), and one is not always true (memory savings).  </s>
<s> I therefore suggest 2 changes.  </s>
<s> 1) Add a bullet between current 3rd and 4th bullet:  </s>
<s> . Latency is reduced because network congestion is reduced, so less retransmissions are needed, so the elapsed transmission time is shorter.  </s>
<s> 2) Replace: .  </s>
<s> By opening and closing fewer TCP connections, CPU time is saved, and memory used for TCP protocol control blocks is also saved.  </s>
<s> with: .  </s>
<s> By opening and closing fewer TCP connections, CPU time is saved in routers and hosts (clients, servers, proxies, gateways, tunnels, or caches), and memory used for TCP protocol control blocks can be saved in hosts.  </s>
<s> Regarding memory savings, the original statement is not true in its generality.  </s>
<s> The number of TCP control blocks using up memory at any point  </s>
<s> in time depends on many parameters, among which we find: * timeout value of persistent connections * average number of simultaneous users * activity of users: - whether they typically retrieve lots of objects (pages, inline images) and then become quiet - whether they typically download a few objects every N minutes with N inferior to the TCP connection timeout value - whether they typically download a few objects every N minutes with N superior to the TCP connection timeout value - whether they typically poll a server (e.g., to get the latest results of a sporting event) * etc.  </s>
<s> By varying these values, one can easily show that the number of TCP control blocks can be higher with persistent connections in some cases, smaller in others.  </s>
<s> Persistent connections often allow to save memory, but not always.  </s>
<s> Jean-Philippe Martin-Flatin  </s>
<s> While it may not be explicitly stated, I think the real latency improvement is due to #2. Indirect network health improvement by use of persistent connections will lead to many things like reduced congestion and therefore less latency, but from the perspective of the user of a browser, for example, it is the avoidance of the re-establishment of connections which contributes to the reduction of latency.  </s>
<s> So, from the server side, the big win is the CPU, memory and system call reduction which allows it to scale better.  </s>
<s> From the client side, it is the latency reduction by not having to do a 3way handshake for every request which makes it a faster user experience.  </s>
<s> If we are to specifically highlight latency reduction in the draft, I think it should be described in terms of the connection re-use and 3way handshake avoidance, not the general network health example.  </s>
<s> I am not sure exactly what is meant by CPU time, but as pointed out persistent connections do not correlate with opening and closing fewer TCP connections.  </s>
<s> In fact persistent connections may result in greater search times for protocol control blocks as the number of active protocol control blocks in many sorts of typical types of web use will increase with persistent TCP connections.  </s>
<s> Telford Tools does a lot of work in optimizing web server performance.  </s>
<s> We have the impression that the use of persistent TCP connections for HTTP was addressing the problem of the excessive cost of opening a TCP connection in certain TCP implementations.  </s>
<s> As the use of persistent TCP connections is not guaranteed to decrease the number of TCP connections opened per second in typical web server or usage (although the number of connections opened per second in certain performance tests may decrease), the persistent TCP connection feature while relatively harmless is irrelevant to Web Server or Web Client performance except in certain contrived situations.  </s>
<s> In many situations persistent TCP connections will not decrease the number of connections opened per second but will decrease the number of http transactions per second of which a given servier is capable because at any given time the time to find a protocol control block may in crease because the number of active protocol control blocks at any given moment is likely to increase with the use persistent TCP connections.  </s>
<s> In the general case, if better Web Server or Web Client performance is desired, the correct approach is to bite the bullet and improve the performance of the TCP virtual circuit open code.  </s>
<s> Joachim Martillo  </s>
<s> From: Telford001@aol.com  </s>
<s> Resent-From: http-wg@hplb.hpl.hp.com Date: Sun, 14 Jun 1998 23:08:24 EDT Subject: Re: Advantages of persistent connections  </s>
<s> Not true; please see Jeff Mogul's research in this area; since there are many fewer connections used, you have many fewer PCB's in time-wait state after the connections close, so research (using traces) indicates that fewer total PCB's are needed.  </s>
<s> I have no problems with optimizing code, wherever....  </s>
<s> I think you'll find others who've been looking into this problem carefully hold other opinions to those you state in this message... Joachim, I think you need to read some of the research papers that made the case for HTTP/1.1; you'll find them referenced at the end of the HTTP spec.  </s>
<s> They include simulations of the effects of persistent connections on TCP PCB's, and some running code work that we've done as well.  </s>
<s> - Jim  </s>
