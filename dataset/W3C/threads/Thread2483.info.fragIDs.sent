<s> I've just submitted the following to the I-D repository as: draft-lawrence-http-noclock-00.txt  </s>
<s> At the Memphis meeting, I briefly discussed the fact that many systems where our 1.1 server implementation will be used do not (and will not) have clocks, so sending the Date header is problematic.  </s>
<s> This draft attempts to address this issue.  </s>
<s> Much thanks to Jeff and Richard for helping put this together; any obvious mistakes are probably mine in preparing the final edits.  </s>
<s> Scott Lawrence EmWeb Embedded Server lawrence@agranat.com  </s>
<s> Agranat Systems, Inc. Engineering http://www.agranat.com/  </s>
<s> Internet Draft Scott Lawrence draft-lawrence-http-noclock-00.txt  </s>
<s> Agranat Systems, Inc. Expires: October 1997 Jeffrey Mogul Digital Equipment Corp. Richard Gray International Business Machines Corp. April 22, 1997 HTTP/1.1 Operation without a Clock Status of this Memo This document is an Internet-Draft.  </s>
<s> Internet-Drafts are working documents of the Internet Engineering Task Force (IETF), its areas, and its working groups.  </s>
<s> Note that other groups may also distribute working documents as Internet-Drafts.  </s>
<s> Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  </s>
<s> It is inappropriate to use Internet- Drafts as reference material or to cite them other than as ``work in progress.'' To learn the current status of any Internet-Draft, please check the ``1id-abstracts.txt''  </s>
<s> listing contained in the Internet- Drafts Shadow Directories on ftp.is.co.za (Africa), nic.nordu.net  </s>
<s> (Europe), munnari.oz.au (Pacific Rim), ds.internic.net  </s>
<s> (US East Coast), or ftp.isi.edu (US West Coast).  </s>
<s> 1. Abstract This memo describes a problem with the current Proposed Standard for HTTP/1.1 found as a result of implementation experience.  </s>
<s> A web server may be implemented in an embedded system as a network user interface.  </s>
<s> Often the embedded system is one which has no other use for a real-time clock, and/or the web interface is being added to an existing device which has no clock.  </s>
<s> Without a clock, no accurate HTTP Date header can be generated.  </s>
<s> This memo examines the implications of this situation for the operation of HTTP/1.1 origin servers, proxies, and clients, and proposes changes to the HTTP/1.1 specification to permit compliant operation in such systems.  </s>
<s> draft-lawrence-http-noclock-00.txt  </s>
<s> Page 2/5 2. Background Web browsers provide a powerful set of user interface primitives, which are rapidly being applied to a wide range of applications; the browser has become a de-facto network user interface standard.  </s>
<s> One area of such application is the embedded system: a computer system built into a device that serves some purpose other than just being a computer.  </s>
<s> Including a clock in an embedded system design both adds cost and requires that the clock be accurately set, adding system complexity.  </s>
<s> For many embedded systems, a clock is not otherwise required, and many existing embedded systems that are otherwise capable of providing a web interface do not have a clock.  </s>
<s> The HTTP/1.1 Proposed Standard requires that an origin server always include a Date header ([RFC 2068], section 14.19).  </s>
<s> This requirement was strengthened from a SHOULD in the HTTP/1.0 specification to a MUST in the HTTP/1.1 specification, apparently in order to support the correct operation of caching both in proxies and clients.  </s>
<s> The HTTP/1.1 Proposed Standard specifies a number of headers for mechanisms to affect the operation of caches, including: - Date - Last-Modified - Expires - Cache-Control - Etag it also documents usage of the 'Pragma: no-cache' header for backward compatible cache control with some pre-HTTP/1.1 implementations.  </s>
<s> An important characteristic of an embedded web server implementation is that the content of such a server is well defined at the time the system is built, and each potential response is either: - A Static response, which changes only when the firmware of the system is changed.  </s>
<s> Examples include: pages of help information, cosmetic elements, and external links to the manufacturers web site.  </s>
<s> - A Dynamic response, which may change on any access.  </s>
<s> Examples include: pages which include information on the current state of the device.  </s>
<s> It is desirable that Static responses be cachable, and that Dynamic responses never be cached.  </s>
<s> The authors' contention here is that this can be achieved by correct usage of the other headers already specified by HTTP/1.1, without the requirement that the Date header always be sent by origin servers.  </s>
<s> draft-lawrence-http-noclock-00.txt  </s>
<s> Page 3/5 3. Proposed Change for HTTP/1.1 Requirements Section 14.19 of [RFC 2068] be replaced with (delimited by the '=' lines): 14.19 Date The Date general-header field represents the date and time at which the message was originated, having the same semantics as orig-date in RFC 822.  </s>
<s> The field value is an HTTP-date, as described in section 3.3.1.  </s>
<s> Date = "Date" ":" HTTP-date An example is Date: Tue, 15 Nov 1994 08:12:31 GMT Origin servers MUST include a Date header field in all responses, except in these cases: 1.  </s>
<s> If the response status code is 100 (Continue) or 101 (Switching Protocols), the response SHOULD NOT include a Date header field.  </s>
<s> 2. If the response status code conveys a server error, e.g. 500 (Internal Server Error) or 503 (Service Unavailable), and it is inconvenient or impossible to generate a valid Date. 3. If the server does not have a clock that can provide a reasonable approximation of the current time, its responses MUST NOT include a Date header field.  </s>
<s> In this case, the rules in section 14.19.1 MUST be followed.  </s>
<s> A received message that does not have a Date header field MUST be assigned one by the recipient if the message will be cached by that recipient or gatewayed via a protocol which requires a Date.  </s>
<s> An HTTP implementation without a clock MUST NOT cache responses without revalidating them on every use.  </s>
<s> An HTTP cache, especially a shared cache, SHOULD use a mechanism, such as NTP[28], to synchronize its clock with a reliable external standard.  </s>
<s> Clients SHOULD only send a Date header field in messages that include an entity-body, as in the case of the PUT and POST requests, and even then it is optional.  </s>
<s> A client without a clock MUST NOT send a Date header field in a request.  </s>
<s> draft-lawrence-http-noclock-00.txt  </s>
<s> Page 4/5 The following subsection should be added: 14.19.1 Clockless Origin Server Operation Some origin server implementations may not have a clock available.  </s>
<s> An origin server without a clock MUST NOT assign Expires or Last-Modified values to a response, unless these values were associated with the resource by a system or user with a reliable clock.  </s>
<s> It MAY assign an Expires value that is known, at or before server configuration time, to be in the past (this allows "pre-expiration" of responses without storing separate Expires values for each resource).  </s>
<s> Section 10.3.5 ("304 Not Modified"), after: The response MUST include the following header fields: Replace o Date with o Date, unless its omission is required by section 14.19.1  </s>
<s> If a clockless origin server obeys these rules, and proxies and clients add their own Date to any response received without one (as already specified by [RFC 2068], section 14.19), caches will operate correctly.  </s>
<s> draft-lawrence-http-noclock-00.txt  </s>
<s> Page 5/5 4. Security Considerations The Date header is not an important part of any security mechanism; it is a component of the entity digest specified by [RFC 2069], but that document already specifies the behavior for all parties when no Date header is supplied.  </s>
<s> The author believes that the proposed changes have no security implications.  </s>
<s> 5. Author's Addresses Scott Lawrence Agranat Systems, Inc. 1345 Main St. Waltham, MA 02154 Jeffrey Mogul Western Research Laboratory Digital Equipment Corporation 250 University Avenue Palo Alto, California, 94305, USA Richard Gray International Business Machines Corp. 4205 S. Miami Blvd.  </s>
<s> RTP, NC 27709 6. References [RFC 2068] R. Fielding, J. Gettys, J. Mogul, H. Frystyk, and T. Berners-Lee.  </s>
<s> "Hypertext Transfer Protocol -- HTTP/1.1." RFC 2068, U.C. Irvine, DEC, MIT/LCS, January 1997.  </s>
<s> [RFC 2069] J. Franks, P. Hallam-Baker, J. Hostetler, P. Leach, A. Luotonen, E. Sink, and L. Stewart.  </s>
<s> "An Extension to HTTP : Digest Access Authentication" RFC 2069, Northwestern University, CERN, Spyglass Inc., Microsoft Corp., Netscape Communications Corp., Spyglass Inc., Open Market Inc., January 1997.  </s>
<s> While I understand and sympathize with the issue here (I've already got too many clocks in my home, I don't need more to reset twice a year!),  </s>
<s> I find it suprising that TCP can be implemented on a system that has no timing facilities.  </s>
<s> For that matter, don't many (most?) embedded systems have a real-time kernel, with a timer-based dispatcher?  </s>
<s> Or am I mistaking a timer for a time-of-day-and-date clock?  </s>
<s> Ross Patterson Sterling Software, Inc. VM Software Division  </s>
<s> Date: Tue, 22 Apr 97 18:17:14 EDT From: "Ross Patterson" Ross_Patterson@ns.reston.vmd.sterling.com  </s>
<s> While I understand and sympathize with the issue here (I've already got too many clocks in my home, I don't need more to reset twice a year!),  </s>
<s> I find it suprising that TCP can be implemented on a system that has no timing facilities.  </s>
<s> For that matter, don't many (most?) embedded systems have a real-time kernel, with a timer-based dispatcher?  </s>
<s> Or am I mistaking a timer for a time-of-day-and-date clock?  </s>
<s> Yes, there's a difference between a timer designed to help with mutlitasking and a timer which tells you the time of day.  </s>
<s> Assuming a completely standalone server which has no battery backup, which boots using DHCP and tftp or whatever (or has all its software in ROM--though then it still needs at least rarp), there's generally no need to have a clock to run a soda machine or a thermometer.  </s>
<s> Admittedly, a soda machine which logs times people get sodas is quite interesting.  </s>
<s> So is a thermomenter which generates nice graphs showing time.  </s>
<s> Admittedly, if you're going to all this trouble, you could ask another machine on the network for the time; but I bet there are other applications where you don't care about the time.  </s>
<s> (What about routers?  </s>
<s> Some of them can be configured from the web; but why would a router care about wall clock time?)  </s>
