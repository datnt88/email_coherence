Based on our discussion on the last call, here is my proposal to add a grouping mechanism to CPs and to clarify that CPs are to be used only as hints. 
Section 4 of the latest p3p1.1 wd describes compact policies. 
The first paragraph of 4. currently states: Compact policies are summarized P3P policies that provide hints to user agents to enable the user agent to make quick, synchronous decisions about applying policy. 
Compact policies are a performance optimization that is OPTIONAL for either user agents or servers. 
User agents that are unable to obtain enough information from a compact policy to make a decision according to a user's preferences SHOULD fetch the full policy. 
I propose changing it to say: Compact policies are summarized P3P policies that provide hints to user agents to enable the user agent to make quick, synchronous decisions about applying policy to cookies. 
Compact policies are a performance optimization that is OPTIONAL for both user agents and servers. 
They represent only a summary of a site's full P3P policy for a cookie; the full P3P policy is the authoritative statement of policy. 
However, a site MUST honor the commitments made in a compact policy. 
User agents that are unable to obtain enough information from a compact policy to make a decision according to a user's preferences SHOULD fetch the full policy. 
In addition, user agents that display information about a site's P3P policies to users SHOULD use the full P3P policy as the source of this information. 
I propose adding a section 4.2.10 Compact STATEMENT The STATEMENT element is represented in compact policies using the curly brace { } symbols. 
The { represents the opening STATEMENT tag and the } represents the closing statement tag. 
The syntax of the compact statement corresponds to the syntax of the full statement. 
Unless it surrounds a compact NON-IDENTIFIABLE element, each pair of braces MUST surround one compact RETENTION element and at least one of each of the following compact elements: PURPOSE, RECIPIENT, and CATEGORIES. 
Alternatively, a pair of braces may surround a compact NON-IDENTIFIABLE element; optionally any of the PURPOSE, RECIPIENT, and CATEGORIES elements; and optional a RETENTION element. 
A compact policy that has an improperly matching pair of curly braces or is missing one of the required statement elements MUST be treated as if no curly braces are present. 
A compact policy may contain one or more statements. 
A compact policy with no {} elements is considered to have a single implied statement element. 
[BNF] Section 4.5, fourth paragraph, change MUST to MAY (as in "All of the purposes, recipients, and categories that appear in multiple statements in a full policy MAY be aggregated in a compact policy...." Section 4.5 give two examples of valid translations. 
In addition to the one currently given, add: "NON DSP { ADM DEV PSD OUR IND PRE NAV } { IVDo OUR STP PHY PRE UNI }" Section 4.6 Transforming a Compact Policy to a P3P Policy should be dropped. 
This is a good trick. 
I like it. 
But curly braces don't carry attributes ;) This means the grouping mechanism of statement can't be applied. 
Your examples for grouping are good, but I would really like us to have a chunk of full policy in the example and the grouped compact representation that goes with it. 
Best, Rigo If we need attributes, we can use an alternate syntax that would allow it. 
But I'm not sure what statement attributes need to be represented in compact policies... 
There are no STATEMENT attributes other than those that are part of extensions. 
Lorrie Also, I did include an example in the text I sent in the last message. 
It is a grouped compact policy from the example that is already in the spec. 
Lorrie Here is my revised proposal based on today's call. 
Please send proposed changes to the mailing list BEFORE next week's call. 
I would like to finish this next week. 
Lorrie Section 4 of the latest p3p1.1 wd describes compact policies. 
The first paragraph of 4. currently states: Compact policies are summarized P3P policies that provide hints to user agents to enable the user agent to make quick, synchronous decisions about applying policy. 
Compact policies are a performance optimization that is OPTIONAL for either user agents or servers. 
User agents that are unable to obtain enough information from a compact policy to make a decision according to a user's preferences SHOULD fetch the full policy. 
I propose changing it to say: Compact policies are summarized P3P policies that provide hints to user agents to enable the user agent to make quick, synchronous decisions about applying policy to cookies. 
Compact policies are a performance optimization that is OPTIONAL for both user agents and servers. 
They represent only a summary of a site's full P3P policy for a cookie; the full P3P policy is the authoritative statement of policy. 
However, a site MUST make compact policy statements in good faith. 
User agents that are unable to obtain enough information from a compact policy to make a decision according to a user's preferences SHOULD fetch the full policy. 
User agents that use compact policies as part of their decision making MUST include a mechanism that allows users to determine that a particular decision was made based on a compact policy and to view that compact policy. 
However, user agents that provide general information about a site's P3P policies to users MUST use the full P3P policy and MUST NOT use the compact policy for this purpose. 
I propose adding a section 4.2.10 Compact STATEMENT The STATEMENT element is represented in compact policies using the curly brace { } symbols. 
The { represents the opening STATEMENT tag and the } represents the closing statement tag. 
The syntax of the compact statement corresponds to the syntax of the full statement. 
Unless it surrounds a compact NON-IDENTIFIABLE element, each pair of braces MUST surround one compact RETENTION element and at least one of each of the following compact elements: PURPOSE, RECIPIENT, and CATEGORIES. 
Alternatively, a pair of braces may surround a compact NON-IDENTIFIABLE element; optionally any of the PURPOSE, RECIPIENT, and CATEGORIES elements; and optionally a RETENTION element. 
A compact policy that has an improperly matching pair of curly braces or is missing one of the required statement elements MUST be treated as if no curly braces are present. 
A compact policy may contain one or more statements. 
A compact policy with no {} elements is considered to have a single implied statement element. 
[BNF] Section 4.5, fourth paragraph, change MUST to MAY (as in "All of the purposes, recipients, and categories that appear in multiple statements in a full policy MAY be aggregated in a compact policy...." Section 4.5 give two examples of valid translations. 
In addition to the one currently given, add: "NON DSP { ADM DEV PSD OUR IND PRE NAV } { IVDo OUR STP PHY PRE UNI }" Section 4.6 Transforming a Compact Policy to a P3P Policy should be dropped. 
Nice draft! 
Am Wednesday 24 March 2004 21:23 verlautbarte Lorrie Cranor : This sentence is ambiguous as it can read: 1/ a site MUST make compact policy statements 2/ if a site makes compact statements, it has to do so in good faith. 
The first requirement sounds really strange. 
It is raw access to the tokens as arrived at the user agent. 
This is normally done by experts using telnet or perl tools. 
But I think this was the consensus we had. 
We should be clear that it is really only raw access. 
Why transform? 
The whole paragraph does not make too much sense anymore. 
Another thing is, does P3P 1.1 use mandatory extensions? 
In this case, the third paragraph is an issue too: Full policies that include mandatory extensions MUST NOT be represented as compact policies. 
In the same direction, 4.7 could be integrated somewhere instead of having an own point. 
I also wonder why we said SHOULD NOT while the above indicates that by inference it is supposed to read MUST NOT. 
OK, how about: However, if a site makes compact policy statements, it MUST make these statements in good faith. 
I don't so much care about whether a user agent gives me an ascii string or whether it formats it in a pretty way, as long as all the information is there. 
I think the current wording captures that. 
In what way do you think it might be misinterpreted? 
For backwards compatibility, the aggregation is still legal. 
We could change this paragraph to say: The P3P 1.0 specification required that all purposes, recipients, and categories that appear in multiple statements in a full policy be aggregated in a compact policy, as described in section 3.3.1. 
With the addition of the compact STATEMENT element in P3P 1.1, this is no longer necessary, although it is still permitted. 
When performing the aggregation, a Web site MUST disclose all relevant tokens (for instance, observe Example 4.1, where multiple retention policies are specified.) 
I believe we only include optional extensions in P3P 1.1. 
If we used mandatory extensions it would introduce backwards compatibility problems. 
4.7 is entirely repeated as the first paragraph of section 6.4, so I think we could drop 4.7. 
(Rigo, here is one typo in 6.4 - a ] that should be removed.) At the time we wrote this we agreed to SHOULD NOT. 
However, I think MUST NOT may be appropriate given our other changes. 
So I would propose that the first paragraph of 6.4 say: P3P user agents MUST NOT rely on P3P compact policies that do not comply with the P3P 1.0 or P3P 1.1 specifications or are obviously erroneous. 
Such compact policies SHOULD be deemed invalid and the corresponding cookies should be treated as if they had no compact policies. 
The following guidelines are designed to reduce the chance that a P3P user agent will accept an invalid compact policy. 
