<s> I installed Amaya 7.1 DEC 20 2002 on Windows XP  </s>
<s> (Chinese version) in the default user (administrator).  </s>
<s> But if i log in to other users, i can't even open amaya.  </s>
<s> Is there a special XP installation?  </s>
<s> Thanks Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk  </s>
<s> Sorry, the amaya version should be: amaya - 7.1 Dec 12 2002  </s>
<s> Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk  </s>
<s> On Tue, 14 Jan 2003 16:26:31 +0800 (CST)  </s>
<s> No there is no special XP installation.  </s>
<s> Could you check execute/read/write accesses of the installed files.  </s>
<s> Irene.  </s>
<s> I have this problem too.  </s>
<s> It seems that Amaya looks for the configuration file in c:\winnt\profiles\user_name instead of the right directory (c:\Documents and Settings\user_name).  </s>
<s> I don't remember what is the right way to get the correct profiles directory under windows, but I remember there's some function that do that.  </s>
<s> Maur?cio  </s>
<s> The installed files is this one?  </s>
<s> C:\Program Files\Amaya\Windows\bin\amaya.exe  </s>
<s> Because I am using XP chinese version, I'll try to  </s>
<s> translate the "terms" in english the best i can.  </s>
<s> If I right click - property - General (1st tab) : (at the bottom) mode: Read only , Hide - both are unchecked Advanced... : everthing is unchecked So, is this the "execute/read/write access" you are talkinga about?  </s>
<s> Thanks all.  </s>
<s> Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk  </s>
<s> I made one of the normal (restricted) user into an administrator , and Amaya can be opened in that user.  </s>
<s> So i think amaya can only open in user with administrative privileges.  </s>
<s> May be some of the files needed is in restricted directory.  </s>
<s> If that is the case, is this easy to fix and when ? Thanks.  </s>
<s> The installed files is this one?  </s>
<s> C:\Program Files\Amaya\Windows\bin\amaya.exe  </s>
<s> Because I am using XP chinese version, I'll try to translate the "terms" in english the best i can.  </s>
<s> If I right click - property - General (1st tab) : (at the bottom) mode: Read only , Hide - both are unchecked Advanced... : everthing is unchecked So, is this the "execute/read/write access" you are talkinga about?  </s>
<s> Thanks all.  </s>
<s> Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk  </s>
<s> Do You Yahoo!? Get your free @yahoo.com.hk address at Yahoo! Mail.  </s>
<s> Hello Mauricio, Right now we don't have any special code for Windows XP.  </s>
<s> The default behavior for Windows NT is used throughout.  </s>
<s> That is, the users Amaya directory is considered to be windowsdir\profiles\username\appname Where windowsdir is returned by the GetWindowSDirectory() WIN32 system call.  </s>
<s> It is the syscall that is returning winnt and not something hardcoded into Amaya.  </s>
<s> If you get it, maybe you presevered your Amaya  </s>
<s> thot.rc file from a previous Windows (non XP)?  </s>
<s> Or maybe it's normal it returns this value.  </s>
<s> Can you tell me what is convention for Windows XP (or quote a reference).  </s>
<s> Also, if you know what is the syscall to get that directory, that could save us time!  </s>
<s> Many thanks, -jose application directory preferences directory is stored in  </s>
<s> Jose,  </s>
<s> I think the best thing to do would be to check for HOME environment variable, if the user has defined it.  </s>
<s> If he didn't, add environment variables HOMEDRIVE and HOMEPATH.  </s>
<s> They are defined for all users in NT, 2000 and XP.  </s>
<s> Maur?cio  </s>
<s> On Sat, 18 Jan 2003 01:23:53 +0800 (CST)  </s>
<s> Hi Marcy , You have to know that when Amaya is launched it generates temporary directories and files normally located in c:\temp I don't know if it's the cause of your problem but it could be if this temporary directory doesn't exist or cannot be modified?  </s>
<s> Irene.  </s>
<s> Ir?ne Vatton INRIA Rh?ne-Alpes INRIA ZIRST e-mail: Irene.Vatton@inria.fr 655 avenue de l'Europe  </s>
<s> I think I found what you want.  </s>
<s> Try GetUserProfileDirectory (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/policy/policy/getuserprofiledirectory.asp).  </s>
<s> Use the parameter hToken as NULL.  </s>
<s> Best, Maur?cio  </s>
<s> Hi, Amaya will launch if the user has administation privilege.  </s>
<s> I think this is what you are talking about here.  </s>
<s> A normal user do not have administrative privilege to write in c directory.  </s>
<s> As soon as I change the user privilege, Amaya runs ok.  </s>
<s> So , is there anyway that someone can change this setting?  </s>
<s> Try to create the temp directory/files in the user's directory in "Documents and settings".  </s>
<s> Just like Mozilla, it create a profile in user's directory.  </s>
<s> Bye.  </s>
<s> Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk  </s>
<s> Mauricio, Thanks for the tip.  </s>
<s> I looked at the code and tried it.  </s>
<s> However, there's a problem.  </s>
<s> It doesn't work on all the platforms.  </s>
<s> For using this function, you need to download a SDK update from Microsoft.  </s>
<s> And it may be that users need to apply a SP to their system to have the latest version of the userenv.dll  </s>
<s> library.  </s>
<s> The one we have in our NT box doesn't support this function.  </s>
<s> This seems like a lots of pain :-/ While waiting to resolve this, I'll comment the code I wrote and  </s>
<s> add an extra search to the "Documents and Settins" directory.  </s>
<s> If it's there, we'll consider the user dir to be around there.  </s>
<s> BTW, I'm not sure if the first parameter can be NULL.  </s>
<s> The documentation said otherwise.  </s>
<s> I'm confused.  </s>
<s> -jose  </s>
<s> Mauricio, Ah, I forgot to add this in my previous message.  </s>
<s> Yes, I also added this test and gave it the top priority for locating the home dir.  </s>
<s> This means that the Amaya home dir will change in the next version of Amaya, as the previous one was stored elsewhere (only for NT, 2K, XP platforms).  </s>
<s> -jose  </s>
<s> One last comment: USERPROFILE seems to be better than HOMEDRIVE + HOMEPATH.  </s>
<s> Home path sometimes is a "working dir", while USERPROFILE always give the directory for configuration files.  </s>
<s> Maur?cio  </s>
