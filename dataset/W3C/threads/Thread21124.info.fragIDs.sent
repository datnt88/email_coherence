I installed Amaya 7.1 DEC 20 2002 on Windows XP 
(Chinese version) in the default user (administrator). 
But if i log in to other users, i can't even open amaya. 
Is there a special XP installation? 
Thanks Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk 
Sorry, the amaya version should be: amaya - 7.1 Dec 12 2002 
Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk 
On Tue, 14 Jan 2003 16:26:31 +0800 (CST) 
No there is no special XP installation. 
Could you check execute/read/write accesses of the installed files. 
Irene. 
I have this problem too. 
It seems that Amaya looks for the configuration file in c:\winnt\profiles\user_name instead of the right directory (c:\Documents and Settings\user_name). 
I don't remember what is the right way to get the correct profiles directory under windows, but I remember there's some function that do that. 
Maur?cio 
The installed files is this one? 
C:\Program Files\Amaya\Windows\bin\amaya.exe 
Because I am using XP chinese version, I'll try to 
translate the "terms" in english the best i can. 
If I right click - property - General (1st tab) : (at the bottom) mode: Read only , Hide - both are unchecked Advanced... : everthing is unchecked So, is this the "execute/read/write access" you are talkinga about? 
Thanks all. 
Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk 
I made one of the normal (restricted) user into an administrator , and Amaya can be opened in that user. 
So i think amaya can only open in user with administrative privileges. 
May be some of the files needed is in restricted directory. 
If that is the case, is this easy to fix and when ? Thanks. 
The installed files is this one? 
C:\Program Files\Amaya\Windows\bin\amaya.exe 
Because I am using XP chinese version, I'll try to translate the "terms" in english the best i can. 
If I right click - property - General (1st tab) : (at the bottom) mode: Read only , Hide - both are unchecked Advanced... : everthing is unchecked So, is this the "execute/read/write access" you are talkinga about? 
Thanks all. 
Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk 
Do You Yahoo!? Get your free @yahoo.com.hk address at Yahoo! Mail. 
Hello Mauricio, Right now we don't have any special code for Windows XP. 
The default behavior for Windows NT is used throughout. 
That is, the users Amaya directory is considered to be windowsdir\profiles\username\appname Where windowsdir is returned by the GetWindowSDirectory() WIN32 system call. 
It is the syscall that is returning winnt and not something hardcoded into Amaya. 
If you get it, maybe you presevered your Amaya 
thot.rc file from a previous Windows (non XP)? 
Or maybe it's normal it returns this value. 
Can you tell me what is convention for Windows XP (or quote a reference). 
Also, if you know what is the syscall to get that directory, that could save us time! 
Many thanks, -jose application directory preferences directory is stored in 
Jose, 
I think the best thing to do would be to check for HOME environment variable, if the user has defined it. 
If he didn't, add environment variables HOMEDRIVE and HOMEPATH. 
They are defined for all users in NT, 2000 and XP. 
Maur?cio 
On Sat, 18 Jan 2003 01:23:53 +0800 (CST) 
Hi Marcy , You have to know that when Amaya is launched it generates temporary directories and files normally located in c:\temp I don't know if it's the cause of your problem but it could be if this temporary directory doesn't exist or cannot be modified? 
Irene. 
Ir?ne Vatton INRIA Rh?ne-Alpes INRIA ZIRST e-mail: Irene.Vatton@inria.fr 655 avenue de l'Europe 
I think I found what you want. 
Try GetUserProfileDirectory (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/policy/policy/getuserprofiledirectory.asp). 
Use the parameter hToken as NULL. 
Best, Maur?cio 
Hi, Amaya will launch if the user has administation privilege. 
I think this is what you are talking about here. 
A normal user do not have administrative privilege to write in c directory. 
As soon as I change the user privilege, Amaya runs ok. 
So , is there anyway that someone can change this setting? 
Try to create the temp directory/files in the user's directory in "Documents and settings". 
Just like Mozilla, it create a profile in user's directory. 
Bye. 
Do You Yahoo!? Get your free @yahoo.com.hk address at http://mail.english.yahoo.com.hk 
Mauricio, Thanks for the tip. 
I looked at the code and tried it. 
However, there's a problem. 
It doesn't work on all the platforms. 
For using this function, you need to download a SDK update from Microsoft. 
And it may be that users need to apply a SP to their system to have the latest version of the userenv.dll 
library. 
The one we have in our NT box doesn't support this function. 
This seems like a lots of pain :-/ While waiting to resolve this, I'll comment the code I wrote and 
add an extra search to the "Documents and Settins" directory. 
If it's there, we'll consider the user dir to be around there. 
BTW, I'm not sure if the first parameter can be NULL. 
The documentation said otherwise. 
I'm confused. 
-jose 
Mauricio, Ah, I forgot to add this in my previous message. 
Yes, I also added this test and gave it the top priority for locating the home dir. 
This means that the Amaya home dir will change in the next version of Amaya, as the previous one was stored elsewhere (only for NT, 2K, XP platforms). 
-jose 
One last comment: USERPROFILE seems to be better than HOMEDRIVE + HOMEPATH. 
Home path sometimes is a "working dir", while USERPROFILE always give the directory for configuration files. 
Maur?cio 
