<s> From: Tom Weinstein tomw@netscape.com  </s>
<s> Yes, a lot of existing protocols have lousy password mechanisms.  </s>
<s> But to integrate any sort of TLS password mechanism, you're going to have to change the protocol if for no other reason than to STOP sending the password in the clear.  </s>
<s> If you're going to do that, why not just fix the protocol?  </s>
<s> I take it that this is Tom's acknowledgement that there is justification for including shared-key authentication within TLS as long as an acceptable  </s>
<s> method can be found?  </s>
<s> Fix the protocol means "do it right", not "don't do  </s>
<s> it at all"?  </s>
<s> I believe that a sufficient business case has been made that shared-key auth (I'll call it SKA from here on) within TLS is desirable.  </s>
<s> My main area of discomfort with the current proposal is that the SKA messages are entertwined with the TLS handshake messages even though there doesn't seem to be a logical need for them to be.  </s>
<s> Since the handshake protocol is at the heart of TLS' security, it's not a good idea to add distracting functionality to it without a good reason.  </s>
<s> Aside from that complaint, the SKA proposal recently submitted by Barb Fox looks quite sound.  </s>
<s> For that reason, I submit the following thought for consideration of the WG: adopt the three SKA messages from the proposal, but instead of bundling them with the handshake exchange, separate them out into their own (new) record type: 1) define a new ContentType shared_key_auth(24).  </s>
<s> Reason: separate SKA from handshake messages.  </s>
<s> Although logically SKA supports application-layer functionality, the SKA messages can't go into application_data records because the protocol engine couldn't find them there.  </s>
<s> 2) add a new element to the connection state, generated during handshake phase.  </s>
<s> Add the following to section 8.2.2 (partitioning the key_block) after server_write_MAC_secret (or after server_write_key or server_write_IV as in the proposal - it doesn't matter where as long as it's specified in the protocol): client_write_SKA_secret[CipherSpec.hash_size]  </s>
<s> Reason: if SKA secrets are compromised, the master secret and other keys are not affected, assuming the key_block partition scheme is sound.  </s>
<s> Since the encryption and MAC keys are also derived this way, any flaw in the partition scheme would affect all of TLS, not just SKA. 3) add the proposed messages to the SKA record type, with the same structure as the handshake messages: enum { shared_keys(30), shared_key_request(31), shared_key_verify(32) } SharedKeyAuthType; struct { SharedKeyAuthType msg_type; uint24 length; select (SharedKeyAuthType) { case shared_keys: SharedKeys; case shared_key_request: SharedKeyRequest; case shared_key_verify: SharedKeyVerify; } body; } SharedKeyAuth; 4) calculate the SKA response as: SharedKeyVerify.shared_key_response hash (client_write_SKA_secret + pad2 + hash (client_write_SKA_secret + pad1 + SharedKeyVerify.auth_service.auth_service_hame + SharedKeyVerify.auth_service.display_string + SharedKeyVerify.auth_service.challenge + SharedKeyVerify.identity + shared_key) ) Reason: since SKA messages would be sent after handshake is finished, they are protected by the record layer MAC and the term hash(handshake_messages) isn't needed in the response calculation.  </s>
<s> Ideally, the SKA exchange should be "secure" without relying at all on protection provided by MAC or encryption, assuming only a good 128 bit client_write_SKA_secret.  </s>
<s> The above construction seems to meet that criteria, but could be modified if any holes are found.  </s>
<s> Potential questions: * Since SKA messages are not within the handshake exchange but after it, there's no longer a restriction of 1 SKA per handshake.  </s>
<s> This might be a feature, but it assumes that SKAs are protected against replay by the record MAC and/or by the freshness of the challenge.  </s>
<s> If this isn't a valid assumption, a new handshake could be triggered each time an SKA is requested, resulting in a new SKA_secret.  </s>
<s> * Others might object to adding a new record type.  </s>
<s> I think it's a cleaner, more obvious solution, but there's no accounting for taste :-).  </s>
<s> * I don't think it will add any round trips to the current proposal - the SKA request could appear immediately after server finished and before application data - similarly for SKA verify on the client end.  </s>
<s> From: Jeff Williams jwkckid1@ix.netcom.com  </s>
<s> Here here!  </s>
<s> I agree.  </s>
<s> The current password mechanism is definatly flawed or is te easely accessed.  </s>
<s> And chalange/response mechanism might also be included as well as an option or feature.  </s>
<s> I think that anyone who takes the time to read the shared-key proposal will find that it *does* specify a challenge-response mechanism.  </s>
<s> I also believe that reading the proposals should be a prerequisite for commenting on them.  </s>
<s> Date: Mon, 7 Oct 1996 16:06:54 -0700 From: david.brownell@Eng.Sun.COM (David Brownell - JavaSoft) [good list of issues snipped] I could raise more questions, but the fact that there are this many (after this much discussion!) says to me that the proposal should not be deemed "cooked" enough to incorporate into an IETF standard.  </s>
<s> From an IETF point of view, a Full Standard protocol must be specified in sufficient detail to allow independently-developed implementations to interoperate solely by reference to published specifications.  </s>
<s> I don't believe this applies to Proposed Standard RFCs, but it will be necessary to completely specify the contents and processing of the auth_service, identity, challenge, etc. fields before the RFCs can advance to Draft Standard.  </s>
<s> There might be a range of private-agreement codes reserved in the standard, but at least one interoperable SKA method must be fully defined and required to be supported in all implementations.  </s>
<s> I believe that the proposal is "cooked" enough to be adopted as a baseline, even though some details remain to be worked out.  </s>
<s> If shared-key auth can be separated from the handshake protocol, perhaps along the lines described above, I am "FOR" adopting it into TLS.  </s>
<s> If for some technical reason it cannot be disengaged from the handshake exchange, I'll remain on the fence.  </s>
<s> David, Please read below your comments.  </s>
<s> I am assuming that SharedKeyAuthType is 128 bit here, correct?  </s>
<s> No, I agree with you here.  </s>
<s> I think it would be much cleaner.  </s>
<s> Is this (Above) to be included or added to the current perposal?  </s>
<s> From: Jeff Williams jwkckid1@ix.netcom.com  </s>
<s> Here here!  </s>
<s> I agree.  </s>
<s> The current password mechanism is definatly flawed or is te easely accessed.  </s>
<s> And chalange/response mechanism might also be included as well as an option or feature.  </s>
<s> I guess you are infering that I have not read the spec.  </s>
<s> Well I have, thank you very much, David.  </s>
<s> It is not clearly indicated weather challenge-response mechanism is included, per say, hence my comment.  </s>
<s> Date: Mon, 7 Oct 1996 16:06:54 -0700 From: david.brownell@Eng.Sun.COM (David Brownell - JavaSoft) [good list of issues snipped] I could raise more questions, but the fact that there are this many (after this much discussion!) says to me that the proposal should not be deemed "cooked" enough to incorporate into an IETF standard.  </s>
<s> Jeffrey A. Williams SR.Internet Network Eng.  </s>
<s> CEO., IEG., INC., Representing PDS .Ltd. Web: http://www.pds-link.com  </s>
<s> Director of Network Eng. and Development IEG. INC.  </s>
<s> From: Tom Weinstein tomw@netscape.com  </s>
<s> Yes, a lot of existing protocols have lousy password mechanisms.  </s>
<s> But to integrate any sort of TLS password mechanism, you're going to have to change the protocol if for no other reason than to STOP sending the password in the clear.  </s>
<s> If you're going to do that, why not just fix the protocol?  </s>
<s> No, you've misunderstood me.  </s>
<s> I was referring to the particular protocol, such as telnet or HTTP that you wished to add password authentication to.  </s>
<s> I still believe that this sort of mechanism does not belong in TLS.  </s>
<s> You should only break rules of style if you can | Tom Weinstein coherently explain what you gain by so doing.  </s>
<s> | tomw@netscape.com  </s>
<s> Tom, Please read below your comments.  </s>
<s> From: Tom Weinstein tomw@netscape.com  </s>
<s> Yes, a lot of existing protocols have lousy password mechanisms.  </s>
<s> But to integrate any sort of TLS password mechanism, you're going to have to change the protocol if for no other reason than to STOP sending the password in the clear.  </s>
<s> If you're going to do that, why not just fix the protocol?  </s>
<s> In your opinion, what would be the problem adding extension for Telnet or HTTP for password authentication?  </s>
<s> I would think it is a logical inclusion.  </s>
<s> I am confused here?  </s>
<s> Help me out, ok?  </s>
<s> Reguards, Jeffrey A. Williams SR.Internet Network Eng.  </s>
<s> CEO., IEG., INC., Representing PDS .Ltd. Web: http://www.pds-link.com  </s>
<s> Director of Network Eng. and Development IEG. INC.  </s>
<s> My point was that if you already have to add a more secure password mechanism to these other protocols because they will be used without TLS, then it's redundant to add such a mechanism to TLS.  </s>
<s> You should only break rules of style if you can | Tom Weinstein coherently explain what you gain by so doing.  </s>
<s> | tomw@netscape.com  </s>
