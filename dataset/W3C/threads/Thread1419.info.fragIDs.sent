<s> (sorry for the long, and perhaps confusing title) On the versioning teleconference call, 6/29/01, the participating working group members reached consensus on the following approach to updating a version-controlled-resource on checkin of a working resource that was created by checking out the version-controlled-resource with DAV:apply-to-version. I would like get a sense if the rest of the working group agrees with this proposal.  </s>
<s> I think it makes sense as the result of checking out a VCR, modifying what you checked out, and checking it back in is the same regardless of where and how the state of the updated resource was managed, on the client or on the server, with or without a working resource.  </s>
<s> It does mean changes to the spec, but this seems to be within the boundary of what's reasonable to do now.  </s>
<s> What do you think?  </s>
<s> Here's the proposal from the teleconference: When you apply CHECKOUT directly to a version URL, the semantics of the protocol are unchanged (so if you liked the old semantics and didn't want any auto-update on checkin, you would always apply CHECKOUT directly to a version URL When you apply CHECKOUT with a DAV:apply-to-version flag to a VCR, you create a working resource whose DAV:checked-out version is the DAV:checked-in version of the VCR (as is required currently), but which now also has a protected DAV:auto-update property which contains the URL of the VCR that was checked out.  </s>
<s> (This requires one new postcondition for the CHECKOUT semantics in the working-resource feature).  </s>
<s> The MOVE operation is required to update the DAV:auto-update property if the VCR is moved (or it can fail the MOVE), so the DAV:auto-update property is always valid.  </s>
<s> (This requires one new postcondition for the MOVE semantics in the working-resource feature).  </s>
<s> When you CHECKIN a working resource with a DAV:auto-update property, the CHECKIN fails if the DAV:checked-out property of the working resource does not match the DAV:checked-in property of the VCR.  </s>
<s> If the CHECKIN succeeds, the VCR identified by the DAV:auto-update must have been updated to have the content and dead properties of the new version, and the DAV:checked-in version of the VCR must have been updated to identify the new version.  </s>
<s> (This requires one new precondition and one new postcondition for the CHECKIN semantics in the working-resource feature).  </s>
<s> So are we back to saying that supporting Working Resource feature requires also supporting UPDATE?  </s>
<s> That's what I'm trying to avoid.  </s>
<s> Is there a better way for these two features to not depend on each other?  </s>
<s> No I'm not saying that.  </s>
<s> I have an application in mind that creates versions and doesn't update any version-controlled resource.  </s>
<s> It always references the versions by their version URL.  </s>
<s> In this case there is no need for DAV:auto-update or an UPDATE method, so I would object to making them required.  </s>
<s> Furthermore, it's surprising to me, and perhaps to clients as well, that working resource checkins and in-place checkins work so differently: one ends up with the VCR pointing to the latest version at the end, and the other doesn't (by default).  </s>
<s> I would expect the default behaviour of both of these to be the same.  </s>
<s> In the case of a working resource created directly from a version, there is no version-controlled resource to update on CHECKIN.  </s>
<s> So it doesn't seem too surpising to me, but whatever.  </s>
<s> Perhaps Jim's proposal could instead be worded so that auto-update was the default, and "do not update" is the exceptional behaviour that the client must request.  </s>
<s> That would require setting the DAV:auto-update value, or passing in the URL of the version-controlled resource during CHECKIN.  </s>
<s> I prefer to leave the proposal as is.  </s>
<s> Regards, Tim  </s>
<s> So are we back to saying that supporting Working Resource feature requires also supporting UPDATE?  </s>
<s> That's what I'm trying to avoid.  </s>
<s> Is there a better way for these two features to not depend on each other?  </s>
<s> That really badly serves the purposes of non-versioning clients.  </s>
<s> The server can't interact with those clients in your scenario, because those clients would always just GET the VCR, and end up with the root version instead of the latest versions.  </s>
<s> Let me phrase the problem in these terms, I must find a solution to: How do I write a server implementation that - supports Working Resources - supports non-versioning clients Some of the assumptions I've made in framing this problem are that - UPDATE is not supported - I may not be able to rely on versioning-aware clients to use the auto-update flag in CHECKIN.  </s>
<s> I don't know how to send an error if they don't use this flag.  </s>
<s> - It's the wrong thing to always show non-versioning clients the root version.  </s>
<s> They will never have the opportunity to see the latest version.  </s>
<s> Lisa  </s>
<s> If the server supports WORKING-RESOURCE, how does the client know that it also supports CHECKOUT-IN-PLACE (other than trying to do a CHECKOUT on a VCR without apply-to-version and getting an undefined error?  </s>
<s> Note that WORKING-RESOURCE section #9 says that the OPTIONS must return "working-resource" but is silent on "checkout".  </s>
<s> How can that be right, when you must use the verb CHECKOUT to use WORKING-RESOURCE?  </s>
<s> Proposal: 4.5: MUST include "checkout-inplace", "checkin", "checkout".  </s>
<s> 9.5: MUST include "working-resource", "checkin", "checkout".  </s>
<s> From: John Hall [mailto:johnhall@evergo.net] If the server supports WORKING-RESOURCE, how does the client know that it also supports CHECKOUT-IN-PLACE (other than trying to do a CHECKOUT on a VCR without apply-to-version and getting an undefined error?  </s>
<s> By checking whether the checkout-in-place feature is supported.  </s>
<s> Note that WORKING-RESOURCE section #9 says that the OPTIONS must return "working-resource" but is silent on "checkout".  </s>
<s> How can that be right, when you must use the verb CHECKOUT to use WORKING-RESOURCE?  </s>
<s> This was why we renamed the "checkout" feature to be the "checkout-in-place" feature.  </s>
<s> Proposal: 4.5: MUST include "checkout-inplace", "checkin", "checkout".  </s>
<s> 9.5: MUST include "working-resource", "checkin", "checkout".  </s>
<s> OK, I see the problem.  </s>
<s> I missed a spot where "checkout" should have been replaced by "checkout-in-place" (i.e. in section 4.5).  </s>
<s> I'll fix that.  </s>
<s> Note that "checkin" is no longer a feature, and that "checkout" was never a feature (they are method names, not features).  </s>
<s> Cheers, Geoff  </s>
