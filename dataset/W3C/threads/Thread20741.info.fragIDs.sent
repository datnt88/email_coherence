<s> Hello Christoph,  </s>
<s> We implemented the \winnt\profiles\USERNAME target directory as this is what our other Windows NT users had advised us to do.  </s>
<s> Perhaps there is another way to do so that is more portable?  </s>
<s> We're open to suggestions.  </s>
<s> If I understood correctly, what you want to do is install the Amaya application in a server and have the users run it from other boxes.  </s>
<s> What you could do is to open the Amaya\config\win-thot.rc file and add the following line under the [thot_lib] section:  </s>
<s> APP_HOME=\path\to\the\dir\where\you\want\to\store\the\profile For example, you could use the name of a drive found on every computer.  </s>
<s> A drawback of this approach is that depending on what you select, users profiles may get mixed up if they are all stored in the same file.  </s>
<s> Tell us if it works OK or if you have other suggestions.  </s>
<s> Cheers, -jose  </s>
<s> From: "Christoph Hallerstede" Christoph.Hallerstede@zdv.uni-tuebingen.de  </s>
<s> we want to install Amaya at our students windows-NT pool.  </s>
<s> But we have a special situation: \winnt\profiles\USERNAME is write-protected for security reasons.  </s>
<s> Can you tell me a way, to work with Amaya without writing to \winnt\profiles\USERNAME At this time, amaya starts with a error-message and then quits.  </s>
<s> Morning Jose,  </s>
<s> Are you using hardcoded paths here?  </s>
<s> Under Win2k, the paths are different, again.  </s>
<s> There are functions within the Win environment that you can use to locate these paths, that may help out Christoph, assuming he has configured the paths to be picked up automagically.  </s>
<s> It has something to do with SpecialPaths, but I couldn't find it in MSDN this morning... But it is part of the scripting runtime, for sure.  </s>
<s> HTH, Gary Klesczewski Hello Christoph, We implemented the \winnt\profiles\USERNAME target directory as this is what our other Windows NT users had advised us to do.  </s>
<s> Perhaps there is another way to do so that is more portable?  </s>
<s> We're open to suggestions.  </s>
<s> If I understood correctly, what you want to do is install the Amaya application in a server and have the users run it from other boxes.  </s>
<s> What you could do is to open the Amaya\config\win-thot.rc file and add the following line under the [thot_lib] section: APP_HOME=\path\to\the\dir\where\you\want\to\store\the\profile For example, you could use the name of a drive found on every computer.  </s>
<s> A drawback of this approach is that depending on what you select, users profiles may get mixed up if they are all stored in the same file.  </s>
<s> Tell us if it works OK or if you have other suggestions.  </s>
<s> Cheers, -jose  </s>
<s> Hello Gary, We're using semi-hardcoded paths.  </s>
<s> We're using the Win32 GetUserName() and GetWindowsDirectory() system calls to build the path to the profiles directory.  </s>
<s> Here's an extract (from Amaya/thotlib/base/registry.c) dwSize = sizeof (username); status = GetUserName (username, &amp;dwSize); if (status) ptr = username; /* winnt: apphome is windowsdir\profiles\username\appname */ dwSize = MAX_PATH; GetWindowsDirectory (windir, dwSize); sprintf (app_home, "%s\\profiles\\%s\\%s", windir, ptr, AppNameW); app_home will point to the user home dir.  </s>
<s> Someone in the list had posted an alternate algorithm for Win2K, but we haven't yet been able to play with it.  </s>
<s> Mostly, if that algorithm is not portable under WinNT, we need to know how to identify that we're running under Win2K... We have a system call to do so, but not a Win2K box around here to know what it would return :) Any contribution is welcome and we still have time to integrate it before the next release.  </s>
<s> -jose  </s>
