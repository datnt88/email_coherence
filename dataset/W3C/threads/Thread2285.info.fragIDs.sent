<s> I believe NULL-Request was added to handle the lingering CRLF following a POSTed entity body.  </s>
<s> It may have an unexpected and unintended interaction with persistent connections: because the NULL-Request has no HTTP-Version and no Connection header, the server is obliged to close the connection after servicing the NULL-Request.  </s>
<s> Dave Kristol  </s>
<s> Well, Dave, I must say that you have a perverse way of reading specs that discovers problems I would never even dream of.  </s>
<s> ;-)  </s>
<s> Um, thanks, I guess.  </s>
<s> It comes from intense language lawyering for the ANSI C spec.  </s>
<s> I've noticed that some implementers manage to derive similar interpretations, so I'm glad you find them first.  </s>
<s> Well, I found it because indeed I was trying to figure out exactly how to implement null requests and noticed the presumed unintended side-effect.  </s>
<s> Any thoughts as to what/where words need to be added to prevent this unfortunate event?  </s>
<s> Not really.  </s>
<s> The NULL-Request idea seems attractive at first glance, but it makes me nervous that a server should silently eat and discard an arbitrary number of blank lines (assuming the persistent connection issue gets side-stepped).  </s>
<s> That opens the gate for a malicious client to mount a denial of service attack by pumping a stream of CRLF's at a server.  </s>
<s> I'm more inclined to deal with it as a special-case hack: - if there is a POST, and - if the connection is held open, - (and if the request is HTTP/1.0?), the server should look for, and silently discard, a CRLF that follows the entity body.  </s>
<s> Dave  </s>
<s> I went back to look at my implementation of this to see how I had handled it for Connection keep-alive.  </s>
<s> What I did was - if the connection is a continuation (i.e. has been held open), and - if the request line is just "CRLF" discard the request and keep open the connection - if the connection is a new one, and - if the request line is "CRLF" discard the request and close connection This is essentially the NULL-request idea with the provision that previous keep-alive + NULL-request = continue keep-alive I wasn't worried for my implementation about the attack you mention because I have a max number of requests per connection after which the connection is closed.  </s>
<s> But even without this I don't see the attack you mention as any worse than a stream of requests for persistent connection and a non-existent file.  </s>
<s> Wouldn't that have essentially the same effect?  </s>
<s> I think the simplest behavior when receiving a request line consisting of only CRLF is if (previous request was persistent) discard request and continue persistent connection else discard and close connection I have no real objection to also requiring that the previous connection be a POST, but then we have to say what happens if it wasn't a POST.  </s>
<s> Similarly if it is not HTTP/1.0 or not following a persistent connection we have to deal with an error.  </s>
<s> Does anyone have a sense whether or not it is realistic to get people to stop the POST + CRLF hack in HTTP/1.1?  </s>
<s> As I understand it, the point was to work around broken servers which would not read POST data if it did not end with a LF.  </s>
<s> Is this still a problem?  </s>
<s> John Franks Dept of Math.  </s>
<s> Northwestern University john@math.nwu.edu  </s>
