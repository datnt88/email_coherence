<s> How do I get Tidy to ignore my PHP code blocks A PHP code block is defined as Thanks in advance  </s>
<s> Richard Allsebrook Webmaster - Easysoft Limited * No 3 the Embankments, Leeds LS1 4BJ, UK *+44 0113 2220400 There seems to be a problem with the doctype handling in the July 7 release.  </s>
<s> My limited testing shows that if 1) I specify "doctype: strict" (or loose or transitional, but not omit, auto or "-//W3C//DTD HTML 4.0//EN") in a configuration file, and 2) the HTML document to be tidied begins with a !DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0//EN" line, Tidy outputs the normal messages to STDERR but only an "endless" repetition of doctype declarations to STDOUT (I became suspicious when my index.html  </s>
<s> file contained 2,695,007 ?  </s>
<s> doctype declarations (137,445,376 byte) but no HTML... ;-) ).  </s>
<s> There is, of course, the possibility that I am doing something wrong.  </s>
<s> Having four months old twins, you never seem to get enough sleep... Also baffling (to me, at least): When I tidy the following simple HTML: like this: tidy -config tidy.cfg try.html  try2.html and tidy.cfg contains: clean: yes doctype: strict char-encoding: latin1 I get: Tidy (vers 7th July 1999) Parsing "try.html" "try.html" appears to be HTML 2.0 no warnings or errors were found and try2.html looks like this: and I tidy try2.html, like this: tidy -config tidy.cfg try2.html  </s>
<s> I get: Tidy (vers 7th July 1999) Parsing "try2.html"  </s>
<s> line 6 column 1 - Warning: discarding unexpected /html "try2.html"  </s>
<s> appears to be HTML 2.0 1 warnings/errors were found!  </s>
<s> HTML &amp; CSS specifications are available from To learn more about Tidy see Please send bug reports to Dave Raggett care of Lobby your company to join W3C, see The 'tags' seem to be dereferenced dangling pointers (the string is "l\1\3").  </s>
<s> I am using the Win32 console .exe  </s>
<s> from the archive on a Win98 system.  </s>
<s> Recompiling with DJGPP for a DOS Protected mode executable gives the same results.  </s>
<s> Tidy recognizes ?  </s>
<s> ...? as an XML Processing instruction and preserves these, e.g. the test file p Hello ?brave  </s>
<s> new?  </s>
<s> world. is tidied to Do you want a means to strip processing instructions?  </s>
<s> Regards, -- Dave Raggett dsr@w3.org  </s>
<s> http://www.w3.org/People/Raggett World Wide Web Consortium (on assignment from HP Labs)  </s>
<s> Ah, yes but: ?  </s>
<s> echo "This ia a test "; echo "This is another test..."; ?  </s>
<s> gets mangled to:  </s>
<s> test ?  </s>
<s> echo "This ia a test?  </s>
<s> "; echo "This is another test..."; ?  </s>
<s> BTW, I'm using tidy through the excellent HTML kit (build 254).  </s>
<s> I talked with Chami (the programs author) and he put me on to you guys... Richard Allsebrook Webmaster - Easysoft Limited * No 3 the Embankments, Leeds LS1 4BJ, UK *+44 0113 2220400 blocks  </s>
<s> Tidy recognizes ?  </s>
<s> ...? as an XML Processing instruction and preserves these, e.g. the test file p Hello ?brave  </s>
<s> new?  </s>
<s> world. is tidied to Do you want a means to strip processing instructions?  </s>
<s> Regards, -- Dave Raggett dsr@w3.org  </s>
<s> mobile) World Wide Web Consortium (on assignment from HP Labs)  </s>
<s> Ah, I see the problem.  </s>
<s> The issue is that in SGML processing instructions end with the first ' ' character.  </s>
<s> XML 1.0 altered this to require processing instructions to end with ?  </s>
<s> I could modify Tidy to require ?  </s>
<s> as the terminator of all processing instructions, but this would break its ability to parse legal html.  </s>
<s> I guess a reasonable approach would to make this a new configuration option that is automatically set if the input is in XML.  </s>
<s> This would be easy to do for the next release.  </s>
<s> The patch is in the file lexer.c.  </s>
<s> The code to change is just after the case statement Old: case LEX_PROCINSTR: /* seen ?  </s>
<s> so look for ' ' */ if (c != ' ') continue; New: case LEX_PROCINSTR: /* seen ?  </s>
<s> so look for '? ' */ if (c != '?') continue; /* now look for ' ' */ c = ReadChar(lexer- in); if (c == EndOfStream) ReportWarning(lexer, null, null, UNEXPECTED_END_OF_FILE); UngetChar(c, lexer- in); continue; AddCharToLexer(lexer, c); if (c != ' ') continue; Regards, -- Dave Raggett dsr@w3.org  </s>
<s> http://www.w3.org/People/Raggett World Wide Web Consortium (on assignment from HP Labs)  </s>
<s> Thanks for replying so quickly Er, I'm not a C guy :-( - I don't even have a compiler!  </s>
<s> Can you let me know when the next binary will be available?  </s>
<s> Are you keeping in touch with Chami so he can update his Tidy related code for his superb HTML Kit?  </s>
<s> I'm not sure how Chami handles the Tidy collection, does he compile it into his executable?  </s>
<s> If so, do I pass on this mail to him so he can update his source or do you have another arrangement?  </s>
<s> What a lot of questions!  </s>
<s> Thanks again for your prompt response.  </s>
<s> Richard Allsebrook Webmaster - Easysoft Limited * No 3 the Embankments, Leeds LS1 4BJ, UK *+44 0113 2220400  </s>
<s> Chami gets an automated email message when a new release is posed.  </s>
<s> He then builds a DLL out of the Tidy sources and links it into his UI.  </s>
<s> I will try to make a new release early next week before I go on vacation - but I am currently rushe off me feet on other work, otherwise you will have to wait until late August.  </s>
<s> Regards, -- Dave Raggett dsr@w3.org  </s>
<s> http://www.w3.org/People/Raggett World Wide Web Consortium (on assignment from HP Labs)  </s>
<s> You can use the 'press here to register' Button to register for a NetMind email reminder.  </s>
<s> regards, Bjoern Hoehrmann Homepage: http://127.0.0.1/  </s>
