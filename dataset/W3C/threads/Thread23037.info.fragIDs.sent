<s> This is a repost since the original mail apperars to have slipped through unoticed.  </s>
<s> But I think this issue could be serious, so I am reposting.  </s>
<s> The DOM Level 3 XPath module allows single nodes to be selected, where the returned node can be either the first node in document order, or any node from the result set.  </s>
<s> The ability to select the first node in document order is certainly useful, but the second definition is definately not.  </s>
<s> The reason for this is that when a single node is selected from a node set, there is almost always a particular node in mind.  </s>
<s> If the node returned varies depending on the particular implementation used, then the method becomes worthless for implementation agnostic code.  </s>
<s> XPath itself does not specify how single nodes should be returned, since it does not cater for single node selections.  </s>
<s> XSLT and MSXML, however, both allow single node selections, and both provide them in a consistent manner.  </s>
<s> The node returned is always the first node in evaluation order.  </s>
<s> For example (in msxml), if I wanted to find the owner table of an arbitrary HTML element, I could query: ancestor::table And this would give me the first ancestor element that was of type table.  </s>
<s> Similarly, if I wanted to find the next table row group in an HTML table, I could query: following-sibling::tbody The XSLT spec defines this behaviour for it's xsl:value-of element http://www.w3.org/TR/xslt#value-of , but does not use the term 'evaluation order' specifically.  </s>
<s> It says: The following [example] precedes each procedure element with a paragraph containing the security level of the procedure.  </s>
<s> It assumes that the security level that applies to a procedure is determined by a security attribute on the procedure element or on an ancestor element of the procedure.  </s>
<s> It also assumes that if more than one such element has a security attribute then the security level is determined by the element that is closest to the procedure.  </s>
<s> xsl:template match="procedure" fo:block xsl:value-of select="ancestor-or-self::*[@security][1]/@security"/ /fo:block xsl:apply-templates/ /xsl:template Thanks, Dominic.  </s>
<s> Check Philippe  </s>
<s> I responded to this message on November 1, which is in the archives.  </s>
<s> Ray Whitmer  </s>
<s> The DOM Level 3 XPath module allows single nodes to be selected, where the returned node can be either the first node in document order, or any node from the result set.  </s>
<s> The ability to select the first node in document order is certainly useful, but the second definition is definately not.  </s>
<s> The reason for this is that when a single node is selected from a node set, there is almost always a particular node in mind.  </s>
<s> If the node returned varies depending on the particular implementation used, then the method becomes worthless for implementation agnostic code.  </s>
<s> XPath itself does not specify how single nodes should be returned, since it does not cater for single node selections.  </s>
<s> XSLT and MSXML, however, both allow single node selections, and both provide them in a consistent manner.  </s>
<s> The node returned is always the first node in evaluation order.  </s>
<s> For example (in msxml), if I wanted to find the owner table of an arbitrary HTML element, I could query: ancestor::table And this would give me the first ancestor element that was of type table.  </s>
<s> Similarly, if I wanted to find the next table row group in an HTML table, I could query: following-sibling::tbody The XSLT spec defines this behaviour for it's xsl:value-of element http://www.w3.org/TR/xslt#value-of , but does not use the term 'evaluation order' specifically.  </s>
<s> It says: The following [example] precedes each procedure element with a paragraph containing the security level of the procedure.  </s>
<s> It assumes that the security level that applies to a procedure is determined by a security attribute on the procedure element or on an ancestor element of the procedure.  </s>
<s> It also assumes that if more than one such element has a security attribute then the security level is determined by the element that is closest to the procedure.  </s>
<s> xsl:template match="procedure" fo:block xsl:value-of select="ancestor-or-self::*[@security][1]/@security"/ /fo:block xsl:apply-templates/ /xsl:template Thanks, Dominic.  </s>
