<s> Hello Dave!  </s>
<s> First a BIG BIG 'thank you' for making available such a great little tool, finally giving me the possibility to write *clean* HTML code with no proprietary stuff.  </s>
<s> Anyway, I've encountered a bug in current version: Just 'TIDY' my small html file I enclosed in my mail - this explains it all.  </s>
<s> Best regards, Andreas Eibach Germany [file]  </s>
<s> As it turns out, this came up a few weeks ago.  </s>
<s> Tidy is actually doing the right thing.  </s>
<s> The &amp;'s must be escaped as &amp;amp; according to the HTML spec.  </s>
<s> Check the thread in the mailing list archives at  </s>
<s> and search for "&amp; in hrefs".  </s>
<s> Hope this helps.  </s>
<s> --Randy  </s>
<s> As it turns out, this was *not* what I meant.  </s>
<s> I think it hasn't anything to do with my problem.  </s>
<s> Mine is that a site URL inside the HTML results in a warning message line 1 column xx - Warning: unescaped or unknown entity "&amp;p2" line 2 column yy - Warning: unescaped or unknown entity "&amp;p3" The thing the thread far below is talking about is a different thing.  </s>
<s> Andreas  </s>
<s> Sorry for not being clearer.  </s>
<s> Strictly speaking (which we do when it comes to Tidy's output :)), if you want an ampersand character in an attribute such as href, you are supposed to write it as &amp;amp; and not just &amp;.  </s>
<s> Writing ampersands this way is known as "escaping" the ampersand, hence Tidy's warning about an unescaped &amp;.  </s>
<s> (FYI, your Tidy warnings above have a critical typo.  </s>
<s> They should say:  </s>
<s> line 1 column xx - Warning: unescaped &amp; or unknown entity "&amp;p2" Tidy is saying that either a) you have an unescaped ampersand, which is true in your case, or b) you have an unknown entity named p2, which is  </s>
<s> not true in your case.  </s>
<s> Tidy doesn't know which possibility is true, so it lists them both.) Browsers, on the other hand, are lax.  </s>
<s> They let you write either &amp;amp; or &amp; to get an ampersand character.  </s>
<s> However, without getting into a lot of detail, there are some potentially confusing cases where a plain &amp; doesn't work as expected, so it's just as well that HTML has outlawed it.  </s>
<s> So Tidy is simply converting each unescaped &amp; into &amp;amp;  </s>
<s> Before Tidy (illegal href attribute):  </s>
<s> After Tidy (legal href attribute):  </s>
<s> Browsers will accept either href.  </s>
<s> Try it (but be sure to try it in an acutal HTML document; it might not work if you just type/paste it into  </s>
<s> your browser's Address/Location field).  </s>
<s> --Randy  </s>
<s> I just noticed -- if you're viewing this in Tidy's web-based mail archive, these two href's appear to be the same.  </s>
<s> Apparently the archive software isn't as smart as Tidy because it doesn't seem to have properly escaped the ampersands.  </s>
<s> How funny!  </s>
<s> The first href should contain: ?p1=1&amp;p2=2&amp;p3=3 and the second href should contain: ?p1=1&amp;amp;p2=2&amp;amp;p3=3  </s>
<s> (Hopefully that will come through OK.) --Randy  </s>
<s> [1] a href="http://www.bogus.com/script.asp?p1=1&amp;p2=2&amp;p3=3"  </s>
<s> [2] a href="http://www.bogus.com/script.asp?p1=1&amp;amp;p2=2&amp;amp;p3=3"  </s>
<s> So I plead for Tidy to NOT bug with the ampersands in hrefs anyway!  </s>
<s> I also dare to state that [1] is the normal way you see these hrefs in HTML documents, [2] is *very* seldom seen imho.  </s>
<s> I'm pushy, I know, but I don't have the will to change all my hrefs in my pages just because Tidy can't be taught to leave these href's alone.  </s>
<s> So I will live with that.  </s>
<s> Everyone did it this way ever since, why should I change this?  </s>
<s> I'm willing to use &amp;_a_m_p_; (note strange format because I want to prevent it from being converted) if I want to use ampersands in *texts* - that's normal behavior.  </s>
<s> But no one would ever convince me to change all ampersands in my asp calls to the above.  </s>
<s> This would be too much work - resulting in nothing but satisfaction that Tidy doesn't output warnings anymore.  </s>
<s> But I won't go so far for this 'satisfaction'.  </s>
<s> Andreas  </s>
<s> Aha. A reasonable request, especially since Dave has already implemented such a feature.  </s>
<s> :) Try the quote-ampersand configuration option.  </s>
<s> On the command line, it's --quote-ampersand no.  </s>
<s> I believe this affects ampersands in both text and attributes.  </s>
<s> --Randy  </s>
<s> The reason why Tidy complains about unescaped ampersand signs in HREFs is simply because they are not "legal" HTML, according to the DTD.  </s>
<s> Just type the example below into the textarea on it!" button.  </s>
<s> You'll get a result like this:  </s>
<s> You should not change all your hrefs because of Tidy, you should change all your hrefs because they are invalid HTML.  </s>
<s> The argument "everyone did it false ever since, why should I do it right now" is simply answered by "right is right and false is false".  </s>
<s> sebastian.  </s>
<s> Sebastian Lange Maybe the first chat site that validates as HTML 4.0 even though user input may contain HTML codes.  </s>
<s> Courtesy to Dave Raggett's HTML Tidy: Tidy your documents ONLINE:  </s>
<s> Sebastian Lange:  </s>
<s> I'd put it a bit differently: If you want to produce invalid HTML, HTML that does not follow the rules, then Tidy is not the tool for you.  </s>
<s> Tidy exists to correct bad HTML, not to produce it.  </s>
<s> Look for HTMLUnTidy somewhere... Bertilo Wennergren  </s>
<s> Your problem is, that you are writing sloppy HTML code.  </s>
<s> There are no entitys 'p2' and 'p3'.  </s>
<s> If you do not even whant 'p2' and 'p3' to be entitys, you have to encode your ampersand as an entity: This is correct HTML and good browsers will convert '&amp;amp;' back to '&amp;' before they request the referenced URL.  </s>
<s> See for a broader discussion and to see, that you actually write sloppy HTML code.  </s>
<s> regards, Bj?rn H?hrmann ?  </s>
<s> mailto:bjoern@hoehrmann.de ?  </s>
<s> http://www.bjoernsworld.de am Badedeich 7 ?  </s>
<s> Telefon: +49(0)4667/981ASK ?  </s>
<s> http://bjoern.hoehrmann.de  </s>
<s> 25899 Dageb?ll ?  </s>
<s> PGP KeyID: 0xA4357E78 ?  </s>
<s> http://learn.to/quote  </s>
<s> +{i}  </s>
<s> Mine is that a site URL inside the HTML results in a warning message line 1 column xx - Warning: unescaped or unknown entity "&amp;p2" line 2 column yy - Warning: unescaped or unknown entity "&amp;p3" And so it jolly well should.  </s>
<s> There *are* entity references &amp;p2 and &amp;p3 in that attribute value.  </s>
<s> They *do* need escaping.  </s>
<s> (There is also a missing closing quotation mark.) Legal HTML for this is Attribute value literals allow entity references so that you can get characters into them that are not otherwise easy to enter (like quotation marks).  </s>
<s> The price of that is that some of the characters you _can_ enter easily need escaping too.  </s>
