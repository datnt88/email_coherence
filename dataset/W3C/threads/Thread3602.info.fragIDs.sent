<s> The XML spec allows for Unicode characters from space (20) and above and #x9 | #xA | #xD.  </s>
<s> Various existing applications make use of "characters" below 20 for various reasons.  </s>
<s> Since they are not allowed in XML, what is the recommended way to represent them?  </s>
<s> Note the applications that use these chars want to efficiently write them out and read them in, and want to exchange the data with other apps easily.  </s>
<s> Escaping them as &amp;#xhhhh; is not an option, nor is cdata, as they both reference the production rules for char.  </s>
<s> Do they have to define some markup to represent them?  </s>
<s> Scanning data to catch these codes and map them to something else will be burdensome... ideas?  </s>
<s> perhaps a candidate for q&amp;A note.  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> Tex Texin a ?crit:  </s>
<s> I don't think there's any official recommendation, but a useful way to deal with this situation is to base64-encode the whole string (e.g. the content of a specific element) that may contain controls.  </s>
<s> Of course, the receiving application must know to decode the encoding to recover the intended content.  </s>
<s> XML 1.1 allows them as &amp;#xhhhh;, except for U+0000 NULL.  </s>
<s> See Fran?ois  </s>
<s> that's great, thanks Francois.  </s>
<s> base64 is probably not practical for this situation (records too large).  </s>
<s> but escaping is reasonable.  </s>
<s> tex  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> Depends on why you want to include these "characters".  </s>
<s> Most of the time these "characters" appear because people try to include pure binary data like bitmap images in their XML documents.  </s>
<s> In this case these are octets, not characters.  </s>
<s> The typical recommendation in this case is an additional encoding or escaping layer like Base64 or hex encoding (1C5FFF3C...) which are supported in XML Schema (i.e., XML Schema provides data types for them).  </s>
<s> The alternative is to avoid inclusion, but store the data in some external document and reference it from the XML document.  </s>
<s> Except for the form feed character, I've not yet heard of someone who really want's to use these as real characters.  </s>
<s> Hi, The question was prompted by a user that used binary "2" in his legacy data.  </s>
<s> He assigned it some meaning.  </s>
<s> It is not uncommon.  </s>
<s> For example, the 2, could represent a list separator, which won't conflict with any of the potential data.  </s>
<s> He ran into a problem when the data was saved out as XML.  </s>
<s> tex  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> Attached is my proposal for Q&amp;A on C0 Characters.  </s>
<s> It actually wasn't the topic I intended, but the question came up and I  </s>
<s> thought it would be quick and I might do a second one.  </s>
<s> But it ended up taking much more time than I thought.  </s>
<s> Anyway, for discussion at the next telecon.  </s>
<s> Feel free to email constructive comments before then.  </s>
<s> Thanks to Francois for the initial pointers.  </s>
<s> tex  </s>
<s> HTML 4 marks most control characters as UNUSED in the SGML declaration and are thus - according to Martin - invalid.  </s>
<s> The allowed c0 characters are CR LF FF and tab, just like in XML (except for the form feed character, of course).  </s>
<s> Bjoern, Thanks for this.  </s>
<s> I'll discuss with Martin.  </s>
<s> I believe it, but I don't see the justification from the standard.  </s>
<s> I created a test file and the W3C validator reports "reference to non-SGML character" on C0 characters confirming what you say.  </s>
<s> I am guessing the limitation derives from SGML rather than something explicit in the html spec.  </s>
<s> tex  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> Comments embedded below.  </s>
<s> Tex Texin a ?crit:  </s>
<s> Questions &amp; Answers: HTML, XHTML, XML and control code characters  </s>
<s> "control code characters" looks wrong to me.  </s>
<s> Should be "control codes" or "control characters".  </s>
<s> Question... Are there any differences in the way HTML, XML, and XHTML support the "control code" characters (U+0001-U+001F)?  </s>
<s> This shouldn't be restricted to the range U+0001-U+001F.  </s>
<s> As the title implies, it should also cover the C1 range.  </s>
<s> The issues and solutions are pretty much the same for C0 and C1, although details differ.  </s>
<s> See also my comment on Note 1 below.  </s>
<s> Really? Hmmm, yes, the spec seems to say that.  </s>
<s> Your mileage may vary though, especially with U+0000 NULL.  </s>
<s> If I put &amp;#x0000; in an HTML file, IE6 displays it as "&amp;#x0000;", litterally.  </s>
<s> It doesn't interpret it as an NCR.  </s>
<s> Other NCRs in the C0 and C1 ranges variously give a  </s>
<s> missing-glyph rectangle or nothing at all.  </s>
<s> &amp;#x0080; yields a euro sign!  </s>
<s> * XML 1.0 and XHTML do not allow these characters.  </s>
<s> The C1 range is allowed in XML 1.0.  </s>
<s> * XML 1.1 allows the characters to be represented by Numeric Character References (NCR) or Character Entity References.  </s>
<s> There are no such things as Character Entity References in XML.  </s>
<s> The controls are allowed *only* as NCRs.  </s>
<s> Solutions If you need to represent these characters in XML 1.0 or XHTML, you can create a convention to represent them and replace every occurence with that convention.  </s>
<s> An alternative is to encode the data.  </s>
<s> For example, encode the data as base64 or as hexadecimal values, to ensure only supported characters are used in the markup language text.  </s>
<s> (And of course, decoding the text when reading the files.) Note that XML Schema provides data types for these encodings.  </s>
<s> Another alternative is to store the data in an external document and reference it from the XML document.  </s>
<s> In XML 1.1, the simplest alternative is to represent any occurence of a C0 character with an NCR.  </s>
<s> For example, the character "ESCAPE" U+001B would be represented by either &amp;#x1B; (hexadecimal) or &amp;#27; (decimal).  </s>
<s> Doesn't work for U+0000 NULL.  </s>
<s> Not the latter, see above.  </s>
<s> NOTES: 1 There is a similar set of control codes in the range U+007F-U+009F, known as the C1 range.  </s>
<s> Since these are not excluded by any of the markup languages, they are not discussed here.  </s>
<s> XML 1.1 does exclude the C1 controls (except U+0085 NEL) as litteral characters, just like the C0.  </s>
<s> They are allowed as NCRs.  </s>
<s> 2 More details on the C0 range are available in the Unicode Code Chart: C0 Controls and Basic Latin http://www.unicode.org/charts/PDF/U0000.pdf .  </s>
<s> 3 The document Unicode in XML and other Markup Languages http://www.w3.org/TR/unicode-xml/ contains guidelines on the use of the Unicode Standard in conjunction with markup languages such as XML.  </s>
<s> Fran?ois  </s>
<s> Fran?ois,  </s>
<s> thanks as always.  </s>
<s> Mostly agreement here and some new understanding on my part.  </s>
<s> I numbered your comments in the text and just reply here: 1) control code characters - I think of it as characters that represent control codes, so don't really see a problem.  </s>
<s> I'll look at this, after we deal with the more substantial comments.  </s>
<s> I do see your point though in codes not being characters.  </s>
<s> 2) Originally, I really did just mean to discuss just c0... Actually c0 without null, since I didn't think there was an issue with null, but you undermined all of this... ;-( I'll come back to the scope after we review the rest of your points.  </s>
<s> 3) NULL- ok, what to say about it?  </s>
<s> I don't want to doc browsers' random behavior.  </s>
<s> It would be nice to say its illegal and be done with it.  </s>
<s> 4) I do know that IE maps the c1 range into 1252 values.  </s>
<s> It encourages people  </s>
<s> to presume that those values represent legit characters rather than forcing them to use correct NCRs.  </s>
<s> On the other hand, I am sure it is a compatibility issue for many many pages.  </s>
<s> If we discuss c1, I can add this as a caution.  </s>
<s> 5) C0 in html- the spec says yes.  </s>
<s> I agree there are no glyphs, when I tried it, although &amp;#2; was a different box than &amp;#x3;-&amp;#x8; for some reason.  </s>
<s> However, the validator rejects these characters.  </s>
<s> I want to get Martin's comment on why dtd makes it unused.  </s>
<s> 6) c1 is allowed in XML.  </s>
<s> Yes I agree.  </s>
<s> That is why I restricted myself to c0.  </s>
<s> I didn't see an issue.  </s>
<s> Since it is supported, legacy apps don't have a problem migrating to *ML and using it.  </s>
<s> However, I now understand it is restricted in 1.1, so needs to be covered.  </s>
<s> 7) character entity references.  </s>
<s> Maybe this is a terminology problem on my part.  </s>
<s> The title of http://www.w3.org/TR/2002/CR-xml11-20021015/#sec4.1 is character and entity references.  </s>
<s> I presumed the former was ncr and the latter was CER.  </s>
<s> It is possible to give a name to a character in xml.  </s>
<s> Is that not called a CER?  </s>
<s> I guess HTML uses CER for the predefined ones.  </s>
<s> I realize XML doesn't have these definitions predefined.  </s>
<s> Shall I just call it an entity reference?  </s>
<s> 8) NCR doesn't work for null.  </s>
<s> ok, I'll doc this.  </s>
<s> 9) AHA! ok.  </s>
<s> I see the production changed in so that 7f-9f except 85 is excluded.  </s>
<s> Seems to me an odd thing to do, although  </s>
<s> I appreciate there is a lot of ambiguity around controls.  </s>
<s> ok, thanks very much for your careful review!  </s>
<s> What I thought was going to be a cheap, easy one paragraph Q&amp;A has become a much larger effort... oh well.  </s>
<s> Too bad it is in such a marginal area, although I know a couple programmers that were having trouble with this... tex  </s>
<s> Questions &amp; Answers: HTML, XHTML, XML and control code characters  </s>
<s> 1  </s>
<s> Question... Are there any differences in the way HTML, XML, and XHTML support the "control code" characters (U+0001-U+001F)?  </s>
<s> 2  </s>
<s> * HTML supports the C0 range.  </s>
<s> 3  </s>
<s> 5 Other NCRs in the C0 and C1 ranges variously give a  </s>
<s> 4 &amp;#x0080; yields a euro sign!  </s>
<s> * XML 1.0 and XHTML do not allow these characters.  </s>
<s> 6  </s>
<s> * XML 1.1 allows the characters to be represented by Numeric Character References (NCR) or Character Entity References.  </s>
<s> 7  </s>
<s> Solutions In XML 1.1, the simplest alternative is to represent any occurence of a C0 character with an NCR.  </s>
<s> For example, the character "ESCAPE" U+001B would be represented by either &amp;#x1B; (hexadecimal) or &amp;#27; (decimal).  </s>
<s> 8  </s>
<s> XML 1.1, according to Section 4.1 Character and Entity References http://www.w3.org/TR/2002/CR-xml11-20021015/#sec4.1 , extended XML to allow the Unicode characters in the C0 range to be represented as Numeric Character References or Character Entity References.  </s>
<s> noted  </s>
<s> NOTES: 1 There is a similar set of control codes in the range U+007F-U+009F, known as the C1 range.  </s>
<s> Since these are not excluded by any of the markup languages, they are not discussed here.  </s>
<s> 9  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> Reordering a bit: Tex Texin a ?crit:  </s>
<s> Not so fast!  </s>
<s> With a test page in XHTML (supposedly kicks IE in strict parsing mode), I see only the euro displayed, all the others are white rectangles.  </s>
<s> Surprisingly, it's much the same in NS7 (s/white rectangle/replacement char/)!  </s>
<s> OK, let's dive.  </s>
<s> Looking more closely, the spec doesn't really say yes.  </s>
<s> Section 5.1 obliquely says that the document character set is ISO10646.  </s>
<s> And 10646 in turn doesn't define the C0 and C1 controls it just says (Clause 15): "This coded character set provides for use of control functions encoded according to ISO/IEC 6429 or similarly structured standards for control functions, and standards derived from these."  </s>
<s> And if you look at the code charts, the C0 and C1 areas are conspicuously empty (grayed out).  </s>
<s> The HTML spec contains an SGML declaration (section 20.1) which formally declares what the document character set is: CHARSET BASESET "ISO Registration Number 177//CHARSET ISO/IEC 10646-1:1993 UCS-4 with implementation level 3//ESC 2/5 2/15 4/6" DESCSET 0 9 UNUSED 9 2 9 11 2 UNUSED 13 1 13 14 18 UNUSED 32 95 32 127 1 UNUSED 128 32 UNUSED 160 55136 160 55296 2048 UNUSED -- SURROGATES -- 57344 1056768 57344 So it explicitly excludes all of C0, C1 and #x7F, except for TAB, CR and LF.  </s>
<s> We were both wrong.  </s>
<s> Well, there you have it now.  </s>
<s> It's illegal in HTML, XML 1.0 and XML 1.1.  </s>
<s> Well, HTML does have this terminology (in 5.3.2).  </s>
<s> It's not defined clearly, but it seems to cover all the predefined entities that HTML offers "to give authors a more intuitive way of referring to characters in the document character set".  </s>
<s> The purported intuitiveness is, of course, lost on non-English-speakers.  </s>
<s> It is possible to give a name to an entity, which may or may not contain a single character.  </s>
<s> The five entities that XML predefines (lt, gt, amp, quot and apos) do contain only one character.  </s>
<s> It makes things quite symmetrical.  </s>
<s> Apart from the few useful ones (CR, LF, TAB and NEL), all controls must be represented as NCRs; NULL is forbidden altogether.  </s>
<s> Regards, Fran?ois  </s>
<s> Fran?ois, great stuff.  </s>
<s> 4) could it be font on your end?  </s>
<s> I didn't try xhtml, but for an html example, I see several of the characters in the 0x80-90 range in both IE and NS7.  </s>
<s> Perhaps the stricter parsing corrects the other characters, but it is odd the euro shows thru then.  </s>
<s> 5) Unicode 3, section 13.1 says more or less it is up to the application but falls back to 6429.  </s>
<s> The chart shows the control names.  </s>
<s> My simplistic interpretation is both standards (Unicode, 10646) are saying it is up to the application to define their use, and html defines them as not to be used.  </s>
<s> 3) Nulls- ok! character... 9) OK. What seemed odd to me was recognizing the controls were needed enough to add NCRs to support them and then ruling out the c1 range.  </s>
<s> And why allow them as ncr's but not as encoded values?  </s>
<s> thanks Fran?ois.  </s>
<s> I really appreciate your taking the time to dig thru this.  </s>
<s> I think we have way too much detail for the Q&amp;A so, I'll have to figure out how to handle it.  </s>
<s> Great stuff, and much appreciated.  </s>
<s> tex  </s>
<s> Tex Texin cell: +1 781 789 1898 mailto:Tex@XenCraft.com Xen Master http://www.i18nGuy.com  </s>
<s> XenCraft http://www.XenCraft.com  </s>
<s> Making e-Business Work Around the World  </s>
<s> OK, I tried an xhtml file and using ncr's to define the characters 0x80-0x90 I see them, but encoding the characters directly, they are all question marks, including the euro.  </s>
<s> tex  </s>
