<s> I have developed an independent C++ implementation of the XML 1.0 and Xpath 1.0 standards and during this time I noticed some deficiencies with the current Xpath specifications.  </s>
<s> Primarily there is a lack of ability to combine one or more axes in a  </s>
<s> location step.  </s>
<s> Though this is not a language limiting feature, it does  </s>
<s> make statementes where bi-directional functionality is required very cumbersome.  </s>
<s> This deficiency deviates somewhat from the obvious goal of the location path, which is too progressively filter a selection of nodes.  </s>
<s> With each "/" in the location step representing a new filter, it makes sense to focus not on "axes" but on a "selection" of nodes.  </s>
<s> For example, in the current Xpath expresssions the following is cumbersome: "parent::a/following-sibling::*//text() | parent::a/preceding-sibling::*//text()" An obvious solution to the problem which I would like to propose is to allow Xpath filter expressions to occur as location steps.  </s>
<s> This is easy  </s>
<s> to implement and does not deviate from the purpose of the filter expression which is to take a function or an expression which returns a  </s>
<s> node-set and filter it by optional predicates, just like a location step.  </s>
<s> It should be noted that the grammar (in Xpath 1.0) atleast for the filter expression is very poor, and fails to force the intended behaviour of the filter expression.  </s>
<s> So the above example would become: "parent::a/(following-sibling::* | preceding-sibling::*)//text()" Which in my opinion is logically much more concise...  </s>
<s> Regards, Emerson  </s>
<s> It could be that I am missing something, but I believe your proposal is possible in XPath 2.0.  </s>
<s> Check out the third item *before* 3.3 Sequence Expression (in reverse document order ;-) ) for an example.  </s>
<s> The parse tree for that is a little bit lengthy, but basically you can reduce a StepExpr - PrimaryExpr - ParenthesizedExpr - ... - '(' OrExpr ')' - ... (many steps using always the first non terminal) ... - '(' UnionExpr ')' - ... - '(' PathExpr '|' PathExpr ')' There you are! Cheers,  </s>
<s> Oliver (not a WG member)  </s>
<s> ob|do Dipl.Inf.  </s>
<s> Oliver Becker | --+-- E-Mail: obecker@informatik.hu-berlin.de  </s>
<s> | op|qo WWW: http://www.informatik.hu-berlin.de/~obecker  </s>
<s> |  </s>
<s> Correct, this expression is valid in XPath 2.0.  </s>
<s> Michael Kay  </s>
<s> Michael, could you point me to the grammar where this is allowable in Xpath 2.0 I can see no such derivation:  </s>
<s> I think the part that you are missing is that we are dealing with location step's not sequences.  </s>
<s> As you can plainly see from (http://www.w3.org/TR/xpath20/#doc-StepExpr) the Xpath 2.0 specification does Not allow anything other than axis/node-test specifiers within a location step.  </s>
<s> The good news is ive added the filter expression support to my Xpath 1.0 implementation and it works a treat.  </s>
<s> Ive also taken the liberty to convert literals and functions which return strings into node-tests and numbers into abreviated child::*[n] type step expressions (as is done in Xpointer) emerson  </s>
<s> easy  </s>
<s> a  </s>
<s> It could be that I am missing something, but I believe your proposal is possible in XPath 2.0.  </s>
<s> Check out the third item *before* 3.3 Sequence Expression (in reverse document order ;-) ) for an example.  </s>
<s> The parse tree for that is a little bit lengthy, but basically you can reduce a StepExpr - PrimaryExpr - ParenthesizedExpr - ... - '(' OrExpr ')' - ... (many steps using always the first non terminal) ... - '(' UnionExpr ')' - ... - '(' PathExpr '|' PathExpr ')' There you are!  </s>
<s> Cheers, Oliver (not a WG member)  </s>
<s> | ob|do Dipl.Inf.  </s>
<s> Oliver Becker | | --+-- E-Mail: obecker@informatik.hu-berlin.de  </s>
<s> | | op|qo WWW: http://www.informatik.hu-berlin.de/~obecker  </s>
<s> |  </s>
<s> A StepExpr could be a FilterStep which in turn could be a PrimaryExpr with empty Predicates etc ...  </s>
<s> Oliver  </s>
<s> This doesn't sound like XPath to me, perhaps I have misunderstood.  </s>
<s> Michael Kay  </s>
<s> A StepExpr can be a FilterStep, a FilterStep can be a PrimaryExpr, and a PrimaryExpr can be a ParenthesizedExpr, which can have anything inside it.  </s>
<s> In effect, you can now use any expression (subject to operator precedence rules) as an operand of "/", though the type rules require the expression to deliver node()*.  </s>
<s> Michael Kay  </s>
