Hello, 
I am running the Java version of HtmlTidy. 
When the Html input looks like the one below , Tidy replaces the ^M with nothing, resulting in two separate words being combined (see Tidy output below also). 
I do not know what product was used to create the offending Html. 
I tried 
setting Word2000 and Clean to yes, but there was no change. 
Is there anything I can configure to make Tidy substitute a space for the ^M? 
Thanks, Bernice 
B Realm of Marvels: Building Collections for the Future /B /A /P ^M P March 17-June 18, 2000 /P ^M P (Beatrice and Samuel A. Seaver Gallery, 5th Floor) /P ^M P This exhibition will explore the BMA as both a treasure house of wonders and^Mas a growing, ever-changing structure involved in an ongoing process of formal^Mcollecting. 
Seventeen major acquisitions, selected from thousands of works of art^Macquired in the past decade, will be presented amidst related material that^Mrepresents the history, depth, and richness of the Museum's holdings. 
Each will^Mbe spotlighted against a dense array of related objects, which will serve as a^Mreminder of the voracious appetite for knowledge and ownership that sparked the^Mcreation of many museums in the nineteenth century.^M 
P B Organization: /B This exhibition has been organized by Ellen Reeder,^MDeputy Director for Art at the BMA, in collaboration with Teresa Carbone,^MAssociate Curator of American Paintings and Sculpture, and Barry Harwood,^MAssociate Curator of Decorative Arts. 
p This exhibition will explore the BMA as both a treasure house of wonders andas a growing, ever-changing structure involved in an ongoing process of formalcollecting. 
Seventeen major acquisitions, selected from thousands of works of artacquired in the past decade, will be presented amidst related material thatrepresents the history, depth, and richness of the Museum's holdings. 
Each willbe spotlighted against a dense array of related objects, which will serve as areminder of the voracious appetite for knowledge and ownership that sparked thecreation of many museums in the nineteenth century. 
/p p b Organization: /b This exhibition has been organized by Ellen Reeder,Deputy Director for Art at the BMA, in collaboration with Teresa Carbone,Associate Curator of American Paintings and Sculpture, and Barry Harwood,Associate Curator of Decorative Arts. 
/p 
I assume that you mean the character 0x0D (ie. 
'\r') when you say "^M" because tidy processes "^M" like text. 
The line end character for HTML/XML is 0x0A ('\n'). 
Tidy 
strips out control characters (other than '\t' and '\n') from the input stream. 
There is no option to treat '\r' like white space or line-end. 
I suggest that you either preprocess your HTML, or put a hack in StreamInImpl.readChar. 
Andy Quick 
Actually it is 0x0D0x0A (CRLF, "\r\n"). 
Or, more specifically, CRLF is preferred, but you can have CR or LF alone delimit end of line, but whichever one you use, you MUST be consistent throughout the entire document. 
(This is an HTTP requirement for the requested document body.) 
That would be an error then. 
Tidy should treat CR, LF, and CRLF as equivalent and normalize the document to whichever is appropriate for the platform on which it was compiled or, if indeterminate, to CRLF. 
I guess I should have looked at the XML specification again before my previous message. 
Section 2.11 seems to say that #xD or #xDxA should be treated as end-of-line and mapped to #xA when passed to the parser. 
I don't see the "consistency" requirement where the line-ends must be consistent throughout the document. 
If that is the case, 
tidy would need some sort of pre-parsing pass to determine what the line-end sequence is before parsing. 
Treating #xD as a lineend is a simple change, but what about the consistency requirement? 
Andy Quick 
See RFC 2616, "Hypertext Transfer Protocol -- HTTP/1.1", ftp://ftp.isi.edu/in-notes/rfc2616.txt 
: 
3 Protocol Parameters 3.7 Media Types 3.7.1 
Canonicalization and Text Defaults Internet media types are registered with a canonical form. 
An entity-body transferred via HTTP messages MUST be represented in the appropriate canonical form prior to its transmission except for "text" types, as defined in the next paragraph. 
When in canonical form, media subtypes of the "text" type use CRLF as the text line break. 
HTTP relaxes this requirement and allows the transport of text media with plain CR or LF alone representing a line break when it is done consistently for an entire entity-body. 
HTTP applications MUST accept CRLF, bare CR, and bare LF as being representative of a line break in text media received via HTTP. 
In addition, if the text is represented in a character set that does not use octets 13 and 10 for CR and LF respectively, as is the case for some multi-byte character sets, HTTP allows the use of whatever octet sequences are defined by that character set to represent the equivalent of CR and LF for line breaks. 
This flexibility regarding line breaks applies only to text media in the entity-body; a bare CR or LF MUST NOT be substituted for CRLF within any of the HTTP control structures (such as header fields and multipart boundaries). 
I point out, "HTTP... allows the transport of text media with plain CR or LF alone representing a line break WHEN IT IS DONE CONSISTENTLY FOR AN ENTIRE ENTITY-BODY." 
An entity-body is effectively the entire text/* document served, such as text/html, and excludes the HTTP headers which precede it (which must use CRLF) and multipart boundaries. 
HTTP defines the preferred EOL marker as CRLF. 
I guess then if you're not creating web pages for serving via HTTP, such as on a CD-ROM, that consistency may not be required, but it's a safe bet that it will be served via HTTP, and since consistency doesn't hurt when it isn't served via HTTP, that consistency should be enforced. 
It would be sufficient to treat every CR, LF, and CRLF as end-of-line and output as what is appropriate for the platform for which it was compiled or, failing that, default to CRLF. 
(Defaulting to just CR or LF as EOL will cause problems for systems that use LF or CR as EOL respectively, but using CRLF will ensure that all three situations will be satisfied by having a recognized EOL marker and not having one long unbroken line, where the opposing character is either invisible or represented by a placeholder character. 
(LFCR is not anyone's EOL.)) 
We appear to have a simular, but I suspect bug of different origin When JTidy is called through its main method i.e java org.w3c.tidy.Tidy -asxml file.html the output is fine. 
when it is called through its parser method i.e Tidy tidy = new Tidy(); tidy.setMakeClean(true); // tidy.setXmlTags(true); tidy.setXHTML(true); tidy.parse(in, out); the output has deleted spaces, i.e density was calculatedboth for anion A and B and the most instead of density was calculated both for anion A and B and the most This space is NOT at the end of line markers, its in the middle. 
In a file of say about 10,000 characters, it appears perhaps 50-100 spaces will be deleted. 
We think its only spaces are lost, and not other characters. 
If tidy.setXmlTags(true); is uncommented then it produces extra line throws but does not delete gaps. 
I might add that other versions of Tidy process the same file with no problem. 
since calculatedboth has a different meaning from calculated both, we consider this a serious problem. 
Any comments on the origin of the problem? 
Is it normal that JTidy deletes p /p ? 
Denis Queffeulou 
Hi Dave By now I should know, (I have been remind many times) to include summary=" " into tables &amp; alt=" " into picture img . 
It appears to be on the web a lot of web sites that have text movement after you start to read it and the picture begins to loads. 
Is it possible the have a reminder for height=" " width=" " in the img tag, included in the future HTML tidy. 
From Eric 
Maybe some of this could be controlled by a "fussiness" parameter? 
Leaving these attributes off results in the image being displayed at its default dimensions, which is usually correct. 
Specifying the wrong value, OTOH, causes nasty distortions - that may be fine for static sites, but is really a pain for dynamically generated HTML. 
Russell Gold | "... society is tradition and order russgold@acm.org 
(preferred) | and reverence, not a series of cheap russgold@netaxs.com 
| bargains between selfish interests." 
rgold@thesycamoregroup.com | - Poul Anderson, "Iron" 
Bonjour Denis, 
...yes, it is: drop-empty-paras If set to yes, empty paragraphs will be discarded. 
If set to no, empty paragraphs are replaced by a pair of br elements as HTML4 precludes empty paragraphs. 
The default is yes. 
Sebastian Lange Maybe the first chat site that validates as HTML 4.0 even though user input may contain HTML codes. 
Courtesy to Dave Raggett's HTML Tidy: Tidy your documents ONLINE: 
I think it is very easy to find correct dimension of any picture, in just three steps. 
(1) open picture with Internet Explorer (a very popular program) (2) save as (filename.bmp) 
(3) open *.bmp picture with MS paint (comes with windows 95, 98 ....?) get height &amp; width dimensions from there what could be easier, almost as simple as saying "I don't understand" 
what's the matter with everybody? 
:  Hi Dave : :  By now I should know, (I have been remind many times) to include :  summary=" " into tables :  &amp; alt=" " into picture img . 
: :  It appears to be on the web a lot of web sites that have text movement after :  you start to read it and the picture begins to loads. 
: :  Is it possible the have a reminder for height=" " width=" " in the img :  tag, included in the future HTML tidy. 
: Maybe some of this could be controlled by a "fussiness" parameter? 
Leaving these attributes off results in the image being displayed at its default dimensions, which is usually correct. 
Specifying the wrong value, OTOH, causes nasty distortions - that may be fine for static sites, but is really a pain for dynamically generated HTML. 
: Russell Gold | "... society is tradition and order : russgold@acm.org 
(preferred) | and reverence, not a series of cheap : russgold@netaxs.com 
| bargains between selfish interests." 
: rgold@thesycamoregroup.com | - Poul Anderson, "Iron" Outgoing mail is certified Virus Free. 
Checked by AVG anti-virus system (http://www.grisoft.com). 
Version: 6.0.219 / Virus Database: 103 - Release Date: 5-12-00 
I'm not sure why you think this is relevant. 
I have worked on many web sites in which there was not always perfect coordination between the HTML coders and the artists. 
It is not that it is difficult to determine the dimensions of a single picture (as long as you are running Windows, anyway - some people do not). 
It is that when you have dozens of images, it does not happen automatically - and using the wrong dimensions is worse than using no dimensions. 
Russell Gold | "... society is tradition and order russgold@acm.org 
(preferred) | and reverence, not a series of cheap russgold@netaxs.com 
| bargains between selfish interests." 
rgold@thesycamoregroup.com | - Poul Anderson, "Iron" 
:  I think it is very easy to find correct dimension of any picture, in just three steps. 
: :  (1) open picture with Internet Explorer (a very popular program) :  (2) save as (filename.bmp) 
:  (3) open *.bmp picture with MS paint (comes with windows 95, 98 ....?) get height &amp; width dimensions from :  there 
: :  what could be easier, almost as simple as saying "I don't understand" : 
:  what's the matter with everybody? 
: I'm not sure why you think this is relevant. 
HTML "TIDY"NESS is that so hard to understand I have worked on many web sites in which there was not always perfect coordination between the HTML coders and the artists. 
It is not that it is difficult to determine the dimensions of a single picture (as long as you are running Windows, anyway - some people do not). 
It is that when you have dozens of images, it does not happen automatically - and using the wrong dimensions is worse than using no dimensions. 
: Russell Gold | "... society is tradition and order : russgold@acm.org 
(preferred) | and reverence, not a series of cheap : russgold@netaxs.com 
| bargains between selfish interests." 
: rgold@thesycamoregroup.com | - Poul Anderson, "Iron" Outgoing mail is certified Virus Free. 
Checked by AVG anti-virus system (http://www.grisoft.com). 
Version: 6.0.219 / Virus Database: 103 - Release Date: 5-12-00 
Why so complicated? 
With MS Internet Explorer (at least versions 4+, not sure about older), you 
simply right-click the image that you want to check, and select PROPERTIES. 
The appearing pop-up will tell you about the image's dimensions. 
In Netscape (checked with version 4.08 on WinNT5, but I think it's valid for all versions on all platforms), you have two simple ways: right click the image and select "view image". 
In the TITLE bar you will find the dimensions. 
Alternatively, right click into the page and select VIEW INFO (Or select PAGE INFO from the VIEW menu). 
You will get a list of all images contained in the page, and for each image you can retrieve detailed information (like original dimensions and scaled size). 
HTML Editors like Allaire's HomeSite automatically add height and width attribute values of the image's natural dimensions to edited image tags. 
I'd be surprised if, for example, Emacs did not offer similar functionality. 
Merry Christmas! 
sebastian 
Sebastian Lange Maybe the first chat site that validates as HTML 4.0 even though user input may contain HTML codes. 
Courtesy to Dave Raggett's HTML Tidy: Tidy your documents ONLINE: 
and similar suggestions may be useful for a small number of images, but they fail with large numbers. 
Suggestions to "right-click this or that", or use any technique that requires the poor user to take multiple individual actions with each image (locate image, right-click image, note 
dimensions by hand) are impractical there. 
As an aside, this is one area in general where Microsoft tools fail the 
test of "enterprise-readiness": they're mostly built on the assumption that there is always one user doing one thing on one object. 
If you use Microsoft tools for business, ask yourself how you'd handle this real-life example using only MS tools: remove the notes from every page of 50 PowerPoint presentations and also print them in color to PDF files. 
Or this one: find and record in a single text file the dimensions, color characteristics, and other meta-information about every image on a given computer running Windows. 
Those are realistic circumstances. 
___Pete 
Use "View image" in Netscape -- this shows the dimensions directly, as do shareware/freeware programs Klaus Johannes Rusch KlausRusch@atmedia.net 
Automate the task using a simple Perl script and Image::Size (or wwwis or another tool that generates size specifications automatically) Klaus Johannes Rusch KlausRusch@atmedia.net 
Thank you Sebastian &amp; Klaus Just for the record, I have checked the following. 
you can right click picture, MSIE #5 and Opera 5.01 Opera tells you how many color bits display picture in Netscape 4.76 &amp; 6 (or 5?) see in "go" or it tells you at the top of the picture. 
I must add I have never gone to the trouble to check image the first method I said, I just knew it could be done if needed now thanks to everyone, I know there is a quicker and simpler way. 
From Eric : :  I think it is very easy to find correct dimension of any picture, in just three steps. 
: :  (1) open picture with Internet Explorer (a very popular program) :  (2) save as (filename.bmp) 
:  (3) open *.bmp picture with MS paint (comes with windows 95, 98 ....?) get height &amp; width dimensions from :  there : :  what could be easier : Use "View image" in Netscape -- this shows the dimensions directly, as : do shareware/freeware programs : Klaus Johannes Rusch : KlausRusch@atmedia.net : http://www.atmedia.net/KlausRusch/ 
Outgoing mail is certified Virus Free. 
Checked by AVG anti-virus system (http://www.grisoft.com). 
Version: 6.0.219 / Virus Database: 103 - Release Date: 5-12-00 
