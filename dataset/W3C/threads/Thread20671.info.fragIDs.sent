<s> If Amaya attempts to PUT to a server, it will send an HTTP/1.0 request with an "Expect: 100-continue" header.  </s>
<s> This is a 1.1 feature, and as the RFC states: As the RFC you referenced states: An origin server [...] MUST NOT send a 100 (Continue) response if such a request comes from an HTTP/1.0 (or earlier) client.  </s>
<s> It seems odd that Amaya is expecting a response that according to the RFC I  </s>
<s> am not allowed to send it.  </s>
<s> In addition, if I do not send the 100 Continue response (as my server does not implement it), Amaya (appropriately) sends the body of the message.  </s>
<s> However, it then crashes (on Win32).  </s>
<s> I would appreciate if these two bugs (sending an inappropriate expect header, and crashing) could be fixed.  </s>
<s> They are serious barriers to PUT compatibility with Amaya.  </s>
<s> If necessary, I can provide a server against which you can test this behavior.  </s>
<s> Please email me directly for the information.  </s>
<s> Thank you, Aaron Swartz me@aaronsw.com | RSS Info AIM: JediOfPi | ICQ: 33158237| news and information on the RSS format  </s>
<s> Aaron,  </s>
<s> We need more info.  </s>
<s> Can you post the complete protocol exchange that took place?  </s>
<s> Second question, why are you not using HTTP/1.1?  </s>
<s> :) Have you tried using mod_put in apache or my own (now old) put.c program?  </s>
<s> For every 100-continue, there's a timeout.  </s>
<s> If we don't get the reply, we then send the body.  </s>
<s> This is done as such as we don't know beforehand what's the version of the protocol and it's they way that the HTTP spec precises to do it.  </s>
<s> As for the crash, I can't reproduce it without more information from you.  </s>
<s> -jose  </s>
<s> Amaya is not an origin server, but an HTTP 1/1 client.  </s>
<s> Certainly, here's the output from patchPanel: PUT /testing HTTP/1.0 Accept: text/html Accept-Encoding: *,deflate TE: trailers,deflate Expect: 100-continue Host: logicerror.com:8000  </s>
<s> If-Match: "DAB9897FA0C3C89E85C87E73B986731CF34DBF43" User-Agent: amaya/V4.0  </s>
<s> libwww/5.3.1 Cache-Control: no-cache Connection: TE,Keep-Alive Date: Wed, 28 Mar 2001 07:03:24 GMT Content-Length: 1160 Content-Type: text/html Last-Modified: Wed, 28 Mar 2001 07:03:24 GMT (Amaya waits for a 100-continue, and times out) !-- NOTE: This source may be edited and resubmitted using HTTP PUT (with a browser like Amaya or OmniWeb).  </s>
<s> However, only edit between the editing comments, all other changes will be discarded.  </s>
<s> Also be sure not to remove or duplicate the editing marks.  </s>
<s> To change the title, edit the contents of the title tag.  </s>
<s> -- p just an old-fashioned test page -- break it down to three-part...oh never mind.  </s>
<s> /p p small Powered by a href="http://www.blogspace.com/about/"  </s>
<s> Blogspace /a , an a href="http://www.aaronsw.com/"  </s>
<s> Aaron Swartz /a project.  </s>
<s> a href="mailto:aaron@logicerror.com"  </s>
<s> Email the webmaster with problems.  </s>
<s> /a /small /p HTTP/1.0 200 OK Set-Cookie: ad_session_id=9081%2c0%20677%20985806863%20E7AF5E52FC23319CC35F8D66DB521112E BAC1C59; Path=/; Max-Age=1200 MIME-Version: 1.0 Date: Wed, 28 Mar 2001 18:54:25 GMT Server: AOLserver/3.3.1 Content-Type: text/plain Content-Length: 27 Connection: close Your resource is...GRANTED!  </s>
<s> This seems to be a perfectly legal exchange, compatible with the RFC, yet Amaya consistently crashes, on three different machines tested.  </s>
<s> I'm using HTTP/1.0 because that's what the server uses, and I don't feel like rewriting the server.  </s>
<s> I can't use mod_put or put.c because I'm trying to write a PUT handler.  </s>
<s> ;-)  </s>
<s> I hope the above is clear enough.  </s>
<s> If you need more information I can point you to a server and URL that exhibits this behavior.  </s>
<s> Aaron Swartz me@aaronsw.com | ...schoolyard subversion... http://www.aaronsw.com  </s>
<s> | because school harms kids AIM: JediOfPi | ICQ: 33158237| http://aaronsw.com/school/  </s>
<s> [DJW:] According to the evidence provided the question should be why is Amaya not using HTTP/1.1.  </s>
<s> [DJW:] The evidence presented is that it is a HTTP 1.0 client; the PUT in the trace purports to come from Amaya.  </s>
<s> I would say that any HTTP 1.0 client sending Expect: 100-Continue could reasonably expect to either have it ignored or receive a 417 status return.  </s>
<s> I would say that an HTTP 1.0 request with an Expect header was broken.  </s>
<s> [DJW:] --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS.  </s>
