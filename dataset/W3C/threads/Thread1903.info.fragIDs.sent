<s> Reauthenticarion required revisited.  </s>
<s> I'm not sure if this should really go to http-wg or http-ext, so I ll post it here, and if it comes to a consensus, we can think about bringing it to the wg for 1.1...  </s>
<s> The big problem I saw with the reauth required is that while the server can advise the client to ask the user for credentials again, there is no way for the server to be sure that the client really behaved and didnt just say "yeah, whatever" and send cached creds.  </s>
<s> I propose a more generalized method of affecting this problem.  </s>
<s> In english, what Id like to see go on is this: Client is surfing along, and comes to URL A. URLA is a script which performs an action.  </s>
<s> for this example, that action is "grab a coke from the fridge" 1. Client requests a coke 2. server replies: go ask your mother first.  </s>
<s> 3. client asks mom "can I have a coke" 4. client repeats the request and along with the request says: "I did what you asked, mom says OK" 5. server hands out a coke.  </s>
<s> What Im looking at is not to verify that mom was actually asked, but the client claims that it took action.  </s>
<s> In http terms: (As usual, excuse my bnf ) Introduce a new response header action-request: action-request ":" ActionID "," "type" "=" value ActionID = OpaqueString value = "AUTH" | "EXEC" | "ECHO" AUTH means reaquire the credentials for the realm used on this request EXEC means "execute" the content body, which presumably is a script, ie javascript ECHO perform no action, just echo the ActionID in the next request to this URI When this header is received with the 4xx code above, the client should immediately perform the action indicated and try the request again.  </s>
<s> (exact same request except for inclusion of the action-reply header) When received with a 200, and ECHO as the action, simply send the actionID with action-reply for the next request to the same URI only.  </s>
<s> Introduce a new request header action-reply: action-reply ":" ActionID When re-sending a request due to 4xx preAction required, include the ActionID to indicate acknowledgement.  </s>
<s> Introduce response code 4xx preAction required this response code must have an action-request header.  </s>
<s> Essentially this is a server to client request acknowledgement system.  </s>
<s> The case in point for us is for a POST with a CGI where the CGI wants the browser to go do something, like reauth then repeat the same request.  </s>
<s> This is needed because without it, the best we could hope for was a redirect to itself (which the browsers today are smart enough to not do), or use a meta refresh (which would cause repost data?  </s>
<s> to pop up).  </s>
<s> I beleive that in this case reposting the data is ok without user intervention because the POST action is declared to not complete, and the server is instructing the client to "retry" the request.  </s>
<s> When using this the CGI must not carry out the POST when returning the 4xx code.  </s>
<s> Your comments?  </s>
<s> JC Reauthenticarion required revisited.  </s>
<s> This discussion got all mixed up.  </s>
<s> The original requirement is that the server wants the client to discard the current credentials (that is, those used in the request to which this is a response).  </s>
<s> There are (at least) three reasons why the server might want to do this: 1) The server wishes to force the user to reenter credentials (it has been too long, or too many requests since those credentials were originally obtained - make sure the same human being is still there).  </s>
<s> This would normally accompany a 401 response.  </s>
<s> 2) The user has indicated (by pushing a 'logout' button or following an off-site link of some kind) that the authenticated part of the session is over; the server wants the user agent to get the credentials out of cache so that new ones will be obtained next time (eg.  </s>
<s> student is doing registration for next semester from a public browser - pushes the 'commit schedule' button).  </s>
<s> Most often will accompany a 2xx response.  </s>
<s> This is the one that people on the CGI newsgroups ask for several times a week.  </s>
<s> 3) Those credentials are known by the server to be no longer valid (the password just got changed).  </s>
<s> This might be either a positive or negative response.  </s>
<s> This also serves to illustrate that the feature should not be a status code.  </s>
<s> JC Introduce a new response header action-request: JC action-request ":" ActionID "," "type" "=" value JC ActionID = OpaqueString JC value = "AUTH" | "EXEC" | "ECHO" JC AUTH means reaquire the credentials for the realm used JC on this request Not general enough; does not cover cases 2 or 3 above.  </s>
<s> JC EXEC means "execute" the content body, which presumably JC is a script, ie javascript And if I (the user) don't allow execution of arbitrary code shipped to my browser by strangers (no, I don't have Java enabled)?  </s>
<s> JC ECHO perform no action, just echo the ActionID in the JC next request to this URI Yet another form of cookie?  </s>
<s> JC Essentially this is a server to client request acknowledgement JC system.  </s>
<s> And why is that any more assurance that it actually did anything than you had before?  </s>
<s> (the kid can still _claim_ to have asked Mom) Scott Lawrence EmWeb Embedded Server lawrence@agranat.com  </s>
<s> Agranat Systems, Inc. Engineering http://www.agranat.com/  </s>
<s> Josh Cohen:  </s>
<s> I find myself wondering why we need the extra headers you proposed.  </s>
<s> Can't your needs for server to client request acknowledgement be satisfied already by a system in which the server sends a html response with an embedded script, which then contacts the server?  </s>
<s> I tend to agree with Scott that server to client request acknowledgement has little to do with the original `reauthentication requested' problem.  </s>
<s> Koen.  </s>
