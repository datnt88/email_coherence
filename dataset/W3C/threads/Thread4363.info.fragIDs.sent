<s> XSLT 2.0 section 20.3 says: The html output method should not perform escaping for the content of the script and style elements.  </s>
<s> According to HTML 4.01 section B.3.2, " /" within the content of a SCRIPT or STYLE slement should be escaped.  </s>
<s> It also indicates that unencodable characters appearing in a SCRIPT or  </s>
<s> STYLE element "must" be escaped according to the conventions of the script or style language's syntax -- they cannot be written as character references.  </s>
<s> This is a bit unreasonable to impose on an XSLT processor; nevertheless, it should be acknowledged.  </s>
<s> Processors should be given the  </s>
<s> option of performing such escaping, and a fallback behavior (of emitting a character reference anyway, I presume) should be defined.  </s>
<s> Mike Mike J. Brown | http://skew.org/~mike/resume/  </s>
<s> Denver, CO, USA | http://skew.org/xml/  </s>
<s> Thanks for alerting me to this (non-normative) appendix.  </s>
<s> HTML SCRIPT elements do cause some serious problems.  </s>
<s> The fact is, users frequently do produce the cited "illegal" example: document.write  </s>
<s> (" EM This won't work /EM ") and they seem to get away with it.  </s>
<s> What's more, they produce it in two different ways, both of which generally work: (1) as an element: document.write  </s>
<s> (" EM This won't work /EM ") (2) as characters: document.write  </s>
<s> ("EMThis won't work/EM")  </s>
<s> I think the right solution for XSLT is that we should pass on this requirement to use language-specific escaping to the user.  </s>
<s> We should include an example showing that the correct way to write the above is: (3) document.write  </s>
<s> ("EMThis will work\/EM") I don't think we should make either (1) or (2) an error, even though they result in illegal HTML - there are many, many ways to produce illegal HTML as the output of an XSLT stylesheet.  </s>
<s> Michael Kay  </s>
<s> 'The following notes are informative, not normative.  </s>
<s> Despite the appearance of words such as "must" and "should", all requirements in this section appear elsewhere in the specification.' To me this is saying "we're designating this section as informative even though it reads like it's normative.  </s>
<s> The reason we're doing this is because there's nothing new here; all requirements listed here are also listed elsewhere."  </s>
<s> So the appendix is just further explanation of requirements that are more formally defined elsewhere.  </s>
<s> For example, "HTML is an SGML application..." (http://www.w3.org/TR/REC-html40/conform.html#h-4.2) ...therefore it is implicit that an HTML document must conform to SGML's restrictions.  </s>
<s> I don't think we are in disagreement over what constitutes "correct" vs "widely-accepted but incorrect" HTML.  </s>
<s> I think you are just misinterpreting my recommendations (that the spec acknowledge these issues and encourage the output of correct HTML) being a call to make failure to output correct HTML be regarded as an error or conformance issue for an XSLT processor.  </s>
<s> I'm sorry that I wasn't more clear.  </s>
<s> The fact that they get away with either of these is testament to the lenience of HTML user agents in accepting what is, strictly speaking, illegal HTML.  </s>
<s> It is much the same as with the characters #x80-#x9F being disallowed, even by reference, according to HTML's SGML declaration, yet being accepted in common practice.  </s>
<s> The XSLT spec's failure to encourage HTML generators to produce correct output just perpetuates the situation.  </s>
<s> I feel that an XSLT processor should not be forbidden from producing strictly conforming SGML HTML, rather than just widely-accepted tag soup; it should be encouraged, but not required, to make the output as correct as possible.  </s>
<s> "strict in what you produce, lenient in what you accept".. or something like that.  </s>
<s> If you do provide an example, then it should also demonstrate the unencodable character issue.  </s>
<s> The paragraph quoted above is saying that it is illegal to do something like this in a us-ascii encoded document: document.write('&amp;#161;Hola!'); You must do this (I think this is right): document.write('\u00A1Hola!');  </s>
<s> I think it is probably safest to just recommend that any non-ASCII characters in a script or style element be written according to the script or style language's syntax.  </s>
<s> Mike Mike J. Brown | http://skew.org/~mike/resume/  </s>
<s> Denver, CO, USA | http://skew.org/xml/  </s>
