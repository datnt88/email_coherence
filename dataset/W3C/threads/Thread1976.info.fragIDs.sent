A Revised Internet-Draft is available from the on-line Internet-Drafts directories. 
Title : Tunneling SSL Through a WWW Proxy Author(s) : A. Luotonen Filename : draft-luotonen-ssl-tunneling-01.txt 
Pages : 5 Date : 11/06/1995 The wide success of SSL (Secure Sockets Layer from Netscape Communications Corporation) has made it vital that the current WWW proxy protocol be extended to allow an SSL client to open a secure tunnel through the proxy. 
Internet-Drafts are available by anonymous FTP. 
Login with the username "anonymous" and a password of your e-mail address. 
After logging in, type "cd internet-drafts" and then "get draft-luotonen-ssl-tunneling-01.txt". 
A URL for the Internet-Draft is: ftp://ds.internic.net/internet-drafts/draft-luotonen-ssl-tunneling-01.txt 
Internet-Drafts directories are located at: o Africa Address: ftp.is.co.za (196.4.160.8) o Europe Address: nic.nordu.net 
(192.36.148.17) 
Address: ftp.nis.garr.it 
(192.12.192.10) o Pacific Rim Address: munnari.oz.au (128.250.1.21) o US East Coast Address: ds.internic.net 
(198.49.45.10) o US West Coast Address: ftp.isi.edu (128.9.0.32) Internet-Drafts are also available by mail. 
Send a message to: mailserv@ds.internic.net. 
In the body type: "FILE /internet-drafts/draft-luotonen-ssl-tunneling-01.txt". 
NOTE: The mail server at ds.internic.net 
can return the document in MIME-encoded form by using the "mpack" utility. 
To use this feature, insert the command "ENCODING mime" before the "FILE" command. 
To decode the response(s), you will need "munpack" or a MIME-compliant mail reader. 
Different MIME-compliant mail readers exhibit different behavior, especially when dealing with "multipart" MIME messages (i.e., documents which have been split up into multiple messages), so check your local documentation on how to manipulate these messages. 
For questions, please mail to Internet-Drafts@cnri.reston.va.us. 
Cheers, Ari Luotonenari@netscape.com Netscape Communications Corp.http://home.netscape.com/people/ari/ 
501 East Middlefield Road Mountain View, CA 94043, USANetscape Server Development Team 
Hi Ari, hi all, as I see, the draft is fine, and after assigning an RFC number we can incorporate it by reference into 1.1 or 1.2 HTTP protocol. 
I see only one unresolved case: how to deal with multiple firewalls? 
Consider company.com 
connected to the internet trough its firewall 'gatekeeper.company.com' 
and having an even more protected subnet 'finance.company.com' 
connected to company backbone trough a second firewall. 
Currently we have not that many systems configured this way, but this should not imply that in future the situation remains the same. 
Andrew. 
(Endre Balint Nagy) bne@bne.ind.eunet.hu 
The SSL Tunneling I-D applies identically to connections between a client and a proxy, and between two proxies. 
The inner proxy then acts as a client to the outer proxy. 
This functionality of going through multiple firewalls is actually already available in Netscape Proxy Server. 
Cheers, Ari Luotonenari@netscape.com Netscape Communications Corp.http://home.netscape.com/people/ari/ 
501 East Middlefield Road Mountain View, CA 94043, USANetscape Server Development Team 
[Endre Balint Nagy] 
[Ari Luotonen] 
[Endre Balint Nagy] I read this as: multiple firewall travelsal has no efect on the protocol, it's a proxy implemenation issue. 
Partially agree. 
As I see, the (HTTP) protocol has no features to report the server/proxy which generated the error response when something went wrong. 
Client - firewall1 - firewall2 - server connect - - 407 proxy-authenticate connect/proxy-authorisation - - ??? connect 407 proxy-authenticate 407 proxy-authenticate In some cases irrelevant, on which stage the problem occured, but in case of authentication it is relevant. 
If "100 connecting to gatekeeper" stays in the place of the first ???, the client will know that the second 407 generated by gatekeeper. 
(Alternatively, the second 407 can be handled at the first proxy, depending on authentication scheme.) 
As far as I know, we have no standardised proxy-authenticate, only have a placeholder. 
While it is a placeholder, the ssl-tunneling is fine, but when proxy-authenticate is elaborated in detail, some modifications will be needed. 
Of course, this objection applies mostly to the 1.1 draft, not to ssl-tunneling. 
With autenthication on both firewalls? 
Andrew. 
(Endre Balint Nagy) bne@bne.ind.eunet.hu 
One important security note that should be added to this draft: any client that supports this extension MUST perform some correlation between the requested hostname and the certificate returned in the SSL connection - otherwise the system becomes vulnerable to trivial Person-In-The-Middle attacks, with much less effort that conventional attacks. 
No currently deployed systems perform this checking; the next release of the Netscape 2 Beta does do the checking; previous versions are vulnerable. 
Simon (defun modexpt (x y n) "computes (x^y) mod n" (cond ((= y 0) 1) ((= y 1) (mod x n)) ((evenp y) (mod (expt (modexpt x (/ y 2) n) 2) n)) (t (mod (* x (modexpt x (1- y) n)) n)))) 
