Hi, I use Amaya to create XHTML documents containing french and thus use the ISO-8859-1 charset. 
The problem is that Amaya does not insert the encoding in the resulting XHTML document: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" 
So my document does not render well with another XML browser. 
But it's OK if I add the encoding: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" 
Is there something to add in the document to make Amaya generate the encoding ? 
Thanks, Catherine. 
Catherine CHAT - Responsable Technique VIA BUSINESS S.A. Domaine de Voluceau - BP 105 - 78153 Le Chesnay cedex - FRANCE Catherine, If your documents are written in French, I suggest you set a lang attribute on the html or body element. 
Use the Attribute button to do that. 
Then, when you save a document, the encoding is added to the XML declaration and a meta http-equiv... element is generated with the right charset. 
Vincent. 
[DJW:] French uses the HTML and Microsoft US default character encodings (ISO 8859/1 and CP 1252 respectively), so specifying the French language really ought not to change the character set, even if it is the typical misuse of CP 1252 for documents that are perfectly compatible with the HTML default character set. 
[DJW:] For HTML compatibility, I would therefore say that Amaya should be defaulting ISO 8859/1, not UTF-8/16. 
It should not be overriding CP 1252 even if lang is set to fr. 
It should not assume UTF-8/16 when it doesn't know the language. 
If the document is actually served as HTML, 8859/1 is the default, and not all browsers understand http-equiv, which is really a hack for dealing with servers that can't be properly configured, so, whilst Amaya is an [X]HTML tool, it should default to 8859/1. 
Also, in HTML, lang is supposed to be orthogonal, to encoding, so it can, at best, be used as hint to the encoding for newly created documents. 
--------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS. 
Vincent.Quint@inrialpes.fr 
said: Why do it that way? 
It doesn't seem right to tie the encoding with the language specification. 
My understanding is that the encoding defines what numerical byte values are stored in a file to represent characters, while the language specification makes reference to how sequence of characters are made up to form words. 
I might very well want to write a French text in plain ASCII, using XHTML's ISO Latin 1 entities for accented letters. 
In such a case, I just need to add !ENTITY % HTMLlat1 PUBLIC "-//W3C//ENTITIES Latin 1 for XHTML//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml-lat1.ent" %HTMLlat1; to my XML code and declare a UTF-8 encoding. 
I might also want to write an English text, talking about accented letters, in ISO-8859-1 encoding/character set. 
I can understand if, for the moment, Amaya is limited to ISO-8859-1 encoding. 
But then, the insertion of the encoding="ISO-8859-1" attribute should be based on whether there is an accented letter in the current document or not. 
This is actually how my email program works. 
If I send an email message that contains accented letters (like the following to the "Content-Type: text/plain;" header. 
Peace, Bertrand Ibrahim. 
Bertrand.Ibrahim@cui.unige.ch 
My previous message was a bit brief. 
Sorry. 
Obviously, if encoding is clearly stated in a document, Amaya won't change it when saving the document. 
That's only when the encoding is not indicated that Amaya adds ISO-8859-1 based on the lang attribute. 
Vincent. 
Vincent Quint INRIA Rhone-Alpes W3C/INRIA ZIRST e-mail: Vincent.Quint@w3.org 
655 avenue de l'Europe [DJW:] But English, the most likely case for a missed lang, (or at least en-gb) has as good a case for requiring 8859/1 as does French. 
[DJW:] --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS. 
Amaya adds ISO-8859-1 not only for French, but also for many other languages, including English. 
Vincent. 
Bad idea, IMHO. 
Charset is mostly orthogonal to language and one cannot be inferred from the other in general. 
As for the meta http-equiv... , it should always be there, whether the user specifies a language or not (there is always a charset!) Fran?ois Yergeau There is no default charset in HTML. 
From the HTML 4.01 spec [1]: 'Therefore, user agents must not assume any default value for the "charset" parameter.' 
You must have been thinking of the HTTP default charset. 
Bad idea, Amaya doesn't know if the document will be served by HTTP or otherwise, so it cannot assume this default. 
It should always add a Right. 
Fran?ois Yergeau I am sorry but when saving the attached XHTML document with Amaya the header is changed from: to: Isn't it the way to state encoding in XML documents ? 
Catherine. 
Catherine, You are right. 
This is a bug. 
In the current version, the XML parser ignores the charset indicated in the xml declaration. 
This will be fixed, but this version can still generate the right encoding at saving time if it is indicated in the meta http-equiv element. 
In your example, change the second meta element to: I guess you are working locally, because if the server sends the document with a charset indicated in the HTPP header, you should not have this problem. 
Vincent. 
P.S.: Thanks for the nice poem. 
[DJW:] I said served as text/html, which implies the use of an HTTP server and text/html content-type. 
[DJW:] That's not the same thing. 
No encoding means UTF-8 or UTF-16. 
Amaya should store documents as ISO 8859/1 unless told otherwise, as that is what most users will expect; i.e. it should default to storing in that encoding, not the XML default. 
XML then requires that the charset be included in the the PI and XHTML suggests/requires its inclusion in the http-equiv hack. 
What apparently is happening is that it is defaulting to UTF-8, although I suspect it only works correctly if the display also uses UTF-8. 
E.g. if I type GBP (currency symbols) the resulting document displays correctly in a simple text editor in CP 1252 (ISO 8859/1 superset), but the XML encoding says that it should be interpreted as UTF, which wouldn't correctly display. 
It's therefore either defaulting to 8859/1 or to the local GUI display encoding, not to the one it claims to be using. 
[DJW:] --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS. 
I don't see that in your message. 
You wrote things such as "compatible with the HTML default character set" and "For HTML compatibility, I would therefore say that Amaya should be defaulting ISO 8859/1" and "Amaya is an [X]HTML tool, it should default to 8859/1". 
I felt it was important to debunk this purported HTML default charset, which doesn't exist. 
If you mean no encoding *declaration* in XML, then yes (unless there is external information, such as an HTTP header, that says otherwise). 
Well, that's what it does, no? Apart from the fact that this is not a very good idea (a better default would be something based the platform's locale/charset, still better a user preference), the problem is that Amaya currently saves XHTML with inconsistent encoding declarations, unless you set a language. 
If I save a new document, I now see: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" 
The XML declaration, lacking an encoding decl., implies that the encoding is UTF-8 while the document is actually saved in 8859-1. 
The meta comes too late in the head (it should come before title ) and anyway is totally useless; if I can parse that far, I already know it's text/html! 
As Vincent indicated, only if I set a language do I get correct declarations. 
I don't see that, how do get this behaviour? 
What I see is the doc stored in 8859-1 but the XML declaration lying about it. 
If I set a language att on html , the doc is still stored in 8859-1 but the declarations now correctly say so. 
Fran?ois Yergeau 
