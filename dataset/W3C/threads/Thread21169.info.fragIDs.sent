<s> Amaya 7.2 is much better than 6.3 on Windows XP. However there remains a major problem with the configuration and installation.  </s>
<s> It affects many users and should be simple to fix.  </s>
<s> My amaya is using C:\AMAYA as it's user configuration directory.  </s>
<s> WHY!?  </s>
<s> This will ruin any chance of using amaya with either multiple users on one machine, or with network roaming user profiles.  </s>
<s> Actually, on the 'General Preferences' panel it shows 'C:\\amaya' for the 'Amaya user directory'.  </s>
<s> Why the double \\ ?  </s>
<s> INSTEAD, amaya should do what any good windows software does and use the  </s>
<s> Windows environment variable APPDATA as the path to the parent directory of the amaya user directory.  </s>
<s> This works with Windows2000 and XP. OR, if you want to read the registry there is an entry that works with Win98 and WinME as well as Win2K and WinXP.  </s>
<s> It should point to the same place as the environment variable APPDATA: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders : AppData PLEASE make this single change to the next version of Amaya and I can recommend it to the network administrators to add to their campus-wide lab  </s>
<s> image.  </s>
<s> And thank you for making the www a better place.  </s>
<s> Charles Allen Macintosh and PC Computer Support Mathematical Sciences Department O-106 Martin Hall Clemson University Clemson, SC 29634-0975 impala@clemson.edu  </s>
<s> (864) 656-0550 voice  </s>
<s> Hello Charles,  </s>
<s> Following some requests on this list, the Amaya user directory for NT, 2000, and XP architectures is now being stored at: $HOMEDRIVE:\$HOMEPATH\Amaya\config This is documented in the Configuration help page (note that I have a typo there and added two \\... cut and paste problem from the source code).  </s>
<s> Can you tell me if those environment variables exist in your box?  </s>
<s> The double \\ seems to tell that you don't have a HOMEPATH environment variable defined.  </s>
<s> The problem is that this is the third change we do to this code for finding the Windows user home dir.  </s>
<s> It seems it's not always the same even in the same architecture.  </s>
<s> Some of the solutions that were proposed  </s>
<s> require a new system library.  </s>
<s> That is, all users would need to apply a service pack on their boxes to be able to install Amaya if we used functions from that library.  </s>
<s> This didn't sound reasonable to us.  </s>
<s> I'm willing to change it again, but we need to make sure it's the standard way.  </s>
<s> I've not found much documentation on this so far.  </s>
<s> Ideas are welcome.  </s>
<s> -jose  </s>
<s> Well, I just looked at the environment vars in XP, and I found no APPDATA :-) Probably the best way to cope with this is a multilayer approach: - if the environment variable AppData exists, use it as home directory; - otherwise, if the environment variable UserHome (or something like that) exists, use it as home directory; - otherwise, complain with user and tell her to set up a suitable environment variable; - if she forces a "go on", use C:\Amaya\ .  </s>
<s> ciao, .mau.  </s>
<s> Let's take advantage of other open source projects and see how Mozilla or some other program does it.  </s>
<s> From what I see, the starting point to find this out is somewhere around Brant Langer Gurganus If "Actions speak louder than words," how is that "The pen is mightier than the sword."?  </s>
<s> I think Brant Langer Gurganus is on the right track.  </s>
<s> The one and only CSIDL you want to use is CSIDL_APPDATA (0x001a): from  </s>
<s> CSIDL_APPDATA (0x001a) Version 4.71.  </s>
<s> The file system directory that serves as a common repository for application-specific data.  </s>
<s> A typical path is C:\Documents and Settings\username\Application Data.  </s>
<s> This CSIDL is supported by the redistributable Shfolder.dll for systems that do not have the Microsoft?  </s>
<s> Internet Explorer 4.0 integrated Shell installed.  </s>
<s> Basically 'Version 4.71' means it will work in any version of Windows except Win95.  </s>
<s> And it will work in Win95 if the user has the IE4 integrated shell.  </s>
<s> In the rare case of Win95 without the IE 4 shell, MS provides Shfolder.dll.  </s>
<s> - Charles Allen impala@clemson.edu  </s>
<s> Mathematical Sciences TSP, Clemson University About Clemson's parking problem: http://people.clemson.edu/~impala/parking.html  </s>
