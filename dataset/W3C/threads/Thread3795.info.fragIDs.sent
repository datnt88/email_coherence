Hello Michel, Regarding the SHOULD vs. MAY for the use of punycode in the conversion from IRIs to URIs, I have created an issue (punycodeSHOULD-23), and based on the discussion, in particular also Larry's comment, I have chosen to make a compromize. 
The text now says 'MAY' in the general case, but then says "This conversion SHOULD be used when the goal is to maximize interoperability with legacy URI resolvers." 
(where the second part of this sentence is from Roy's draft). 
Please tell me if that's acceptable for you. 
Regards, Martin. 
Adam, I think you have a valid point, I would however make a simpler suggestion, which is two fold: - introduce the concept of IRI used as presentation element of URI protocol element. 
In that sense http://jos x example.net/ is a presentation element for the following protocol element http://xn--jos-dma.example.net/ 
and as you noted http://jos%C3%A9.example.net/ is not a correct URI (per RFC 2616 referring to host itself defined in RFC 2396). 
I have suggested text in that sense to the IRI main editor (Martin). 
Having the concept of presentation element validates http IRIs which exist de facto, whatever we like it or not. 
- add text in the IRI spec saying the following: 

When an IRI is converted to a URI, the conversion SHOULD use scheme-specific knowledge to convert appropriate components where the scheme syntax prevents the usage of percent-encoded text into such components. 
Lack of scheme-specific knowledge (or failure to use it) can cause valid IRIs to be converted to invalid URIs that contain percent-encoded non-ASCII text where they are not permitted. 
It is my opinion that anybody in its right mind would implement IRI to URI mapping considering all the schemes where 'host' is used and map accordingly (ie use Punycode). 
My text avoids direct reference to ACE which is in my opinion unnecessary in the IRI spec and also makes the suggestion to use scheme aware mapping much stronger (SHOULD instead of MAY). 
It is a SHOULD instead of a MUST simply because a scheme may be updated in the future, making the scheme awareness eventually not necessary. 
Michel 
I think this is an interoperability issue, and that neither SHOULD nor MAY are appropriate. 
Rather, there is a MUST with a couple of alternatives. 
Implementations resolving an IRI with non-ascii host names MUST use one of the established methods of resolving the host name correctly. 
Larry 
Hello Larry, 
I think this is a very valid point. 
However, I think that this is overall covered by the current spec. 
The spec has an overall MUST for the general conversion procedure: "Applications MUST map IRIs to URIs using the following two steps." 
It then allows (MAY) an additional step in certain well-defined cases: "Infrastructure accepting IRIs MAY convert the ireg-name component of an IRI as follows (before step 2 above) for schemes that are known to use domain names in ireg-name, but where the scheme definition does not allow %-escaping for ireg-name:" Finally, it recommends that the above additional step be taken under certain conditions: "This conversion SHOULD be used when the goal is to maximize interoperability with legacy URI resolvers." 
So it seems to me that this is covered. 
Of course, there is always the question of whether other things, not discussed in the spec, are allowed or not, but I think it is a general principle when writing IETF specs to not include generalities such as "Any other method than those discussed in this document MUST NOT be used." 
I hope this reply sufficiently addresses this issue (punycodeSHOULD-23). 
I have noted this as tentatively closed. 
Regards, Martin. 
It's now a week since I tentatively closed issue I haven't heard about any problem, so I'm closing this issue. 
Regards, Martin. 
