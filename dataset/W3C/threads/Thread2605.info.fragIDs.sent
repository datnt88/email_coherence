Just after a clarification: 
In the calculation of the response-auth digest for the 'Authentication-Info' header, is the qop-value used the one which is sent by the client in the 'Authorization' header, or the one sent by the server in the Auth-Info header itself? 
Example: the client sends, e.g. a GET request, with no entity-body, so uses "qop=auth" in the 'Authorization' header. 
The server response then has an entity-body, and uses "qop=auth-int" in the 'Authentication-Info' header. 
The sentence The "response-digest" value is calculated as for the "request-digest" in the Authorization header, except that if "qop=auth" or is not specified in the Authorization header for the request, A2 is implies that the qop-value the client sent is used, but the paragraph message-qop Indicates the "quality of protection" options applied to the response by the server. 
The value "auth" indicates authentication; the value "auth-int" indicates authentication with integrity protection. 
The server SHOULD use the same value for the message- qop directive in the response as was sent by the client in the corresponding request. 
seems to implies that the qop-value the server sends is used. 
Regards, joe Joe Orton joe@orton.demon.co.uk ... jeo101@york.ac.uk 
The intent was that they should be the same. 
The server presents alternatives it is willing to support in the WWW-Authenticate challenge, and the client chooses one in its Authorization. 
The server should then use that value in the response. 
If it is not willing to use 'auth', then it should not present that alternative in the challenge. 
If you did switch between request and response, you would want the server to use the value it is sending in calculating the digest - the point of including it in the digest is that it be protected from modification. 
As a practical matter, changing qop wouldn't work at all today, since the only commercial browser that does digest at all doesn't support 'auth-int' yet. 
Scott Lawrence Director of R &amp; D lawrence@agranat.com 
Agranat Systems, Inc. Embedded Web Technology http://www.agranat.com/ 
Ah, can auth-int be used for messages with no body (zero-length), e.g. GET requests? 
I presumed it couldn't, maybe this is the source of my confusion. 
Okay, thanks. 
(I'm writing client code). 
Regards, joe Joe Orton joe@orton.demon.co.uk ... jeo101@york.ac.uk 
I'm not sure where you would have gotten that impression, but yes, a GET 
request can use auth-int. 
The hash of an empty message body is 'd41d8cd98f00b204e9800998ecf8427e'. 
Feel free to test against 'digest-test.agranat.com'; 
send feedback to me. 
Scott Lawrence Director of R &amp; D lawrence@agranat.com 
Agranat Systems, Inc. Embedded Web Technology http://www.agranat.com/ 
Only my imagination... 
I just kind of presumed that H(entity-body) would not be defined if there was 'no' entity-body... 
I see this is wrong now. 
but yes, a GET request can use auth-int. 
Great - "I geddit now". 
Thanks. 
Will do. 
Regards, joe Joe Orton joe@orton.demon.co.uk ... jeo101@york.ac.uk 
