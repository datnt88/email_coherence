<s> The multistatus responses are too verbose.  </s>
<s> For example the MOVE of a very large subtree (thousands or hundreds of thousands of children) will result in a multistatus entry for each successfully and each unsuccessfully moved resource.  </s>
<s> The same applies to many of the other methods.  </s>
<s> I think the responses should operate on the principle of "no news is good news" and only contain entries for the resources which could not be processed.  </s>
<s> They should also not include entries for resources which could not be processed as a result of not being able to process another resource (for example the DELETE method states that if a resource cannot be deleted none of its ancestors may be deleted).  </s>
<s> I think that a verbosity header should then be added which will allow a client to request the fully verbose multistatus response - the default should however be non-verbose.  </s>
<s> The verbose header would be defined as follows: Verbose = "Verbose" ":" ( "T" | "F" ) The Verbose header specifies whether any multistatus response generated by the request should generate entries which correspond to successfully processed resources.  </s>
<s> A value of "T" indicates that the successful multistatus entries MUST be generated.  </s>
<s> A value of "F" indicates that the multistatus response will only contain entries for the unsuccessfully processed resources.  </s>
<s> If the header is not present, then the server SHOULD default to a value of "F".  </s>
<s> If the Verbose header has a value of "F", and there are no errors to be reported, then the server MUST succeed with a 200 OK status code.  </s>
<s> I think the verbose header is unnecessary as is the current response format,  </s>
<s> it is an artifact of design decisions made regarding PROPFIND/PROPPATCH where there were very good reasons for returning everything.  </s>
<s> I suspect that a more basic question is: What sort of response information does one need from DELETE/COPY/MOVE?  </s>
<s> Success information is only useful in the context of your next command.  </s>
<s> That is, I successfully deleted a/b so I don't need to copy it to the backup disk.  </s>
<s> However given the lack of atomic operation any supposition made in the next command as a result of responses from the previous command are generally dangerous.  </s>
<s> That is, you may have just deleted a/b but someone else may just have created a new a/b and so you will need to back it up.  </s>
<s> As such  </s>
<s> I would argue that success information other than a summary "I did what I was told" is useless.  </s>
<s> Failure information, however, is different because it can be used to fix a problem.  </s>
<s> For example, imagine trying to delete a/b and getting back a 401 Unauthorized.  </s>
<s> At that point there is something one can do to actually fix the problem.  </s>
<s> However, failure information based on the namespace, that is, a/b could not be moved so a/b/c and a/b/d did not get deleted, is not terribly useful as it all reflects the same basic problem.  </s>
<s> Given the previous I am proposing the following changes to the specification: COPY/MOVE/DELETE - Only return 4xx and 5xx codes but NEVER 424 Method Failure So the example in 7.8.2.1 would be:  </s>
<s> Request  </s>
<s> DELETE /container/ HTTP/1.1 Host: www.foo.bar  </s>
<s> Response  </s>
<s> HTTP/1.1 207 Multi-Status Content-Type: text/xml Content-Length: xxxxx The Copy example becomes  </s>
<s> Request  </s>
<s> COPY /container/ HTTP/1.1 Host: www.foo.bar  </s>
<s> Destination: http://www.foo.bar/othercontainer/  </s>
<s> Depth: infinity Content-Type: text/xml Content-Length: xxxxx  </s>
<s> Response  </s>
<s> HTTP/1.1 207 Multi-Status Content-Type: text/xml Content-Length: xxxxx etc.  </s>
<s> Any objections?  </s>
<s> Yaron  </s>
<s> Oh and the changes also apply to LOCKs on collections.  </s>
<s> Yaron  </s>
<s> Request  </s>
<s> Response  </s>
<s> Request  </s>
<s> Response  </s>
<s> BTW my note regarding LOCK was incorrect.  </s>
<s> It turns out, interestingly  </s>
<s> enough, that the language already specifies that only the error information  </s>
<s> is to be returned (please refer to section 7.10.4,  </s>
<s> third sentence from the bottom in the last paragraph).  </s>
<s> It was the example that was incorrect, it provided more information than was necessary.  </s>
<s> As such I have fixed the example but not otherwise altered the section on LOCK I have added this as the last paragraph of section 7.6.2 DELETE for Collections and have updated the examples and accompanying text  </s>
<s> If an error occurs with a resource other than the resource identified in the request URI then the response MUST be a 207 Multi-Status.  </s>
<s> 424 Method Failure errors MUST NOT be in the 207 Multi-Status.  </s>
<s> They can be safely left out because the client will automatically know that the ancestors of a resource could not be deleted when the client receives an error for the ancestor's progeny.  </s>
<s> Additionally 204 No Content errors MUST NOT be returned in the 207 Multi-Status.  </s>
<s> The reason for this prohibition is that 204 No  </s>
<s> Content is the default success code.  </s>
<s> As such the client may safely assume  </s>
<s> that a resource was deleted successfully if no response is returned.  </s>
<s> I have changed the last three paragraphs of 7.8.3 COPY for Collections and have updated the examples and accompanying text If an error occurs with a resource other than the resource identified in the  </s>
<s> request URI then the response MUST be a 207 Multi-Status.  </s>
<s> The href XML element in the response refers to the resource that was to be copied, not the resource that was created as a result of the copy.  </s>
<s> In other words, each entry indicates whether the copy on the resource specified in the href XML element succeeded or failed and why.  </s>
<s> The exception to this rule is for errors that occurred on the destination.  </s>
<s> For example, if the destination was locked the response would indicate the destination URL and a 423 Locked error.  </s>
<s> 424 Method Failure errors MUST NOT be returned in the 207 Multi-Status.  </s>
<s> These responses can be safely left out because the client will automatically know that the progeny of a resource could not be copied when the client receives an error for the parent.  </s>
<s> Additionally 201 Created/204 No Content response codes MUST NOT be returned as values in the 207 Multi-Status response.  </s>
<s> They too can be safely left out because they are the default success codes.  </s>
<s> As such the client may safely assume that a resource was copied successfully if no response is returned.  </s>
<s> Finally, 7.9.1 MOVE for Collections, examples and accompanying text also updated  </s>
<s> If an error occurs with a resource other than the resource identified in the request URI then the response MUST be a 207 Multi-Status.  </s>
<s> The href XML element in the response refers to the resource that was to be moved, not the resource that was created as a result of the move.  </s>
<s> In other words, each entry indicates whether the move on the resource specified in the href succeeded or failed and why.  </s>
<s> The exception to this rule is for errors that occurred on the destination.  </s>
<s> For example, if the destination was locked the response would indicate the destination URL and a 423 Locked error.  </s>
<s> 424 Method Failure errors MUST NOT be returned as values in the 207 Multi-Status.  </s>
<s> These errors can be safely left out because the client will automatically know that the progeny of a resource could not be moved when  </s>
<s> the client receives an error for the parent.  </s>
<s> Additionally 201 Created/204 No Content responses MUST NOT be returned as values in the 207 Multi-Status response.  </s>
<s> These responses can be safely left out because they are the default success codes.  </s>
<s> As such the client may safely assume that a resource was moved successfully if no response is returned.  </s>
<s> Yaron  </s>
<s> Request  </s>
<s> Response  </s>
<s> Request  </s>
<s> Response  </s>
<s> I have been waiting for someone to complain about not being able to have the verbose information but it seems as though silence indicates that it is not needed although I could imagine some users finding this information useful.  </s>
<s> Cheers Dylan I think the verbose header is unnecessary as is the current response format, it is an artifact of design decisions made regarding PROPFIND/PROPPATCH where there were very good reasons for returning everything.  </s>
<s> I suspect that a more basic question is: What sort of response information does one need from DELETE/COPY/MOVE?  </s>
<s> Success information is only useful in the context of your next command.  </s>
<s> That is, I successfully deleted a/b so I don't need to copy it to the backup disk.  </s>
<s> However given the lack of atomic operation any supposition made in the next command as a result of responses from the previous command are generally dangerous.  </s>
<s> That is, you may have just deleted a/b but someone else may just have created a new a/b and so you will need to back it up.  </s>
<s> As such I would argue that success information other than a summary "I did what I was told" is useless.  </s>
<s> Failure information, however, is different because it can be used to fix a problem.  </s>
<s> For example, imagine trying to delete a/b and getting back a 401 Unauthorized.  </s>
<s> At that point there is something one can do to actually fix  </s>
<s> the problem.  </s>
<s> However, failure information based on the namespace, that is, a/b could not be moved so a/b/c and a/b/d did not get deleted, is not terribly useful as it all reflects the same basic problem.  </s>
<s> Given the previous I am proposing the following changes to the specification: COPY/MOVE/DELETE - Only return 4xx and 5xx codes but NEVER 424 Method Failure So the example in 7.8.2.1 would be:  </s>
<s> Request  </s>
<s> DELETE /container/ HTTP/1.1 Host: www.foo.bar  </s>
<s> Response  </s>
<s> HTTP/1.1 207 Multi-Status Content-Type: text/xml Content-Length: xxxxx The Copy example becomes  </s>
<s> Request  </s>
<s> COPY /container/ HTTP/1.1 Host: www.foo.bar  </s>
<s> Destination: http://www.foo.bar/othercontainer/  </s>
<s> Depth: infinity Content-Type: text/xml Content-Length: xxxxx  </s>
<s> Response  </s>
<s> HTTP/1.1 207 Multi-Status Content-Type: text/xml Content-Length: xxxxx etc.  </s>
<s> Any objections?  </s>
<s> Yaron  </s>
<s> I would prefer to require that a server MUST return a confirmation of the success of the operation rather than the client simply assuming that the operation succeeded if absolutely no response is received.  </s>
<s> Cheers Dylan If an error occurs with a resource other than the resource identified in the request URI then the response MUST be a 207 Multi-Status.  </s>
<s> 424 Method Failure errors MUST NOT be in the 207 Multi-Status.  </s>
<s> They can be safely left out because the client will automatically know that the ancestors of a resource could not be deleted when the client receives an error for the ancestor's progeny.  </s>
<s> Additionally 204 No Content errors MUST NOT be returned in the 207 Multi-Status.  </s>
<s> The reason for this prohibition is that 204 No  </s>
<s> Content is the default success code.  </s>
<s> As such the client may safely assume  </s>
<s> that a resource was deleted successfully if no response is returned.  </s>
<s> BTW, I actually changed the "MUST"s to "SHOULD"s.  </s>
<s> Thus a server has the  </s>
<s> right to return 424 and 204 but shouldn't unless they have a damn good reason.  </s>
<s> As for requiring confirmation of success, that would be unreasonably verbose.  </s>
<s> If you copy 10,000 files you will end up with 10,000 success statements.  </s>
<s> Given that we have defined, in an absolutely deterministic way, the result without requiring extra bytes on the wire, I think we have done the whole world a favor.  </s>
<s> Yaron  </s>
<s> You can say what you want I still don't like the fact that the paragraph ends with the sentence ".....As such the client may safely assume that a resource was deleted successfully if no response is returned.".  </s>
<s> This implies that a client could send a delete request, the server cuts the connection and the client has to assume that the delete request was successful (or am I missing something reading this paragraph out of context).  </s>
<s> Cheers Dylan BTW, I actually changed the "MUST"s to "SHOULD"s.  </s>
<s> Thus a server has the right to return 424 and 204 but shouldn't unless they have a damn good reason.  </s>
<s> As for requiring confirmation of success, that would be unreasonably verbose.  </s>
<s> If you copy 10,000 files you will end up with 10,000 success statements.  </s>
<s> Given that we have defined, in an absolutely deterministic way, the result without requiring extra bytes on the wire, I think we have done the whole world a favor.  </s>
<s> Yaron  </s>
<s> Ahhh.. now I understand.  </s>
<s> Yes my dear Dylan, you are missing something by reading the paragraph out of context.  </s>
<s> The sentence is included in a paragraph explaining the format of a 207 Multi-Status response.  </s>
<s> Thus the client HAS received a response, it may not contain any PROP elements, but it is a full, properly formatted response.  </s>
<s> Note, btw, that if everything works just perfectly the server should send a 200 Success and call it a day.  </s>
<s> Either way the client does get a response.  </s>
<s> If the client gets no response then it can assume nothing.  </s>
<s> Yaron  </s>
