<s> If a MOVE operation MAY fail when live properties can't be continued as  </s>
<s> live properties at the destination, what should we say about when the server can allow the MOVE and when it can't?  </s>
<s> Is it entirely up to the server or should we make a recommendation?  </s>
<s> Then, if the server does fail, what error code should be returned?  </s>
<s> Lisa  </s>
<s> I don't quite understand the first part of the question.  </s>
<s> If we say that the live properties must continue live at the destination, what more do we need to say?  </s>
<s> (I.e. what situation is left ambiguous?).  </s>
<s> For the second part, a 403 (Forbidden) seems right to me.  </s>
<s> Cheers, Geoff If a MOVE operation MAY fail when live properties can't be continued as  </s>
<s> live properties at the destination, what should we say about when the server can allow the MOVE and when it can't?  </s>
<s> Is it entirely up to the server or should we make a recommendation?  </s>
<s> Then, if the server does fail, what error code should be returned?  </s>
<s> Lisa  </s>
<s> It depends on the precise wording of the language.  </s>
<s> One alternative is to be loose, allowing servers compliant with 2518 to still be compliant with 2518bis (with either MAY or SHOULD, I'm not sure yet): "A MOVE operation MAY fail (403 Forbidden) if the live properties of the source cannot be live properties of the destination.  </s>
<s> The server MAY remove live properties that are no longer appropriate at the destination."  </s>
<s> A stricter alternative: "All live properties on the source resource MUST become live properties on the destination resource with appropriate values and the same  </s>
<s> semantics.  </s>
<s> If the server cannot guarantee this, it MUST fail the request with 403 Forbidden."  </s>
<s> The problem with the stricter alternative is that it forbids a server from removing a live property.  </s>
<s> E.g. in collection "drafts", the property "draftstatus" (in some custom namespace) can be set by clients  </s>
<s> and the server allows certain actions on the resource based on the value of this property.  </s>
<s> Therefore "draftstatus" is a live property.  </s>
<s> When the resource is moved to the "publish" collection, "draftstatus" is no longer appropriate as a live property at all.  </s>
<s> May the server remove it?  </s>
<s> Lisa  </s>
<s> as  </s>
<s> I'd prefer the stricter alternative, but I could live with the former if it said "SHOULD" instead of "MAY".  </s>
<s> Cheers, Geoff It depends on the precise wording of the language.  </s>
<s> One alternative is to be loose, allowing servers compliant with 2518 to still be compliant with 2518bis (with either MAY or SHOULD, I'm not sure yet): "A MOVE operation MAY fail (403 Forbidden) if the live properties of the source cannot be live properties of the destination.  </s>
<s> The server MAY  </s>
<s> remove live properties that are no longer appropriate at the destination."  </s>
<s> A stricter alternative: "All live properties on the source resource MUST become live properties on the destination resource with appropriate values and the same  </s>
<s> semantics.  </s>
<s> If the server cannot guarantee this, it MUST fail the request with 403 Forbidden."  </s>
<s> The problem with the stricter alternative is that it forbids a server from removing a live property.  </s>
<s> E.g. in collection "drafts", the property "draftstatus" (in some custom namespace) can be set by clients  </s>
<s> and the server allows certain actions on the resource based on the value of this property.  </s>
<s> Therefore "draftstatus" is a live property.  </s>
<s> When the resource is moved to the "publish" collection, "draftstatus" is no longer appropriate as a live property at all.  </s>
<s> May the server remove it?  </s>
<s> Lisa  </s>
<s> as  </s>
<s> I also prefer the stricter version... although only for MOVE.  </s>
<s> (The second wording doesn't mention "MOVE" explicitly.) "Clemm, Geoff" com cc:  </s>
<s> Sent by: w3c- Subject: RE: New RFC2518bis draft, COPY / MOVE of live properities dist-auth- request@w3.org  </s>
<s> 07/25/2002 08:58 AM I'd prefer the stricter alternative, but I could live with the former if it said "SHOULD" instead of "MAY".  </s>
<s> Cheers, Geoff It depends on the precise wording of the language.  </s>
<s> One alternative is to be loose, allowing servers compliant with 2518 to still be compliant with 2518bis (with either MAY or SHOULD, I'm not sure yet): "A MOVE operation MAY fail (403 Forbidden) if the live properties of the  </s>
<s> source cannot be live properties of the destination.  </s>
<s> The server MAY remove live properties that are no longer appropriate at the destination."  </s>
<s> A stricter alternative: "All live properties on the source resource MUST become live properties on the destination resource with appropriate values and the same  </s>
<s> semantics.  </s>
<s> If the server cannot guarantee this, it MUST fail the request with 403 Forbidden."  </s>
<s> The problem with the stricter alternative is that it forbids a server from removing a live property.  </s>
<s> E.g. in collection "drafts", the property "draftstatus" (in some custom namespace) can be set by clients  </s>
<s> and the server allows certain actions on the resource based on the value of this property.  </s>
<s> Therefore "draftstatus" is a live property.  </s>
<s> When the resource is moved to the "publish" collection, "draftstatus" is no longer appropriate as a live property at all.  </s>
<s> May the server remove it?  </s>
<s> Lisa  </s>
<s> as  </s>
<s> Yes, good point Jason, these constraints should only apply to MOVE, and definitely not to COPY.  </s>
<s> For COPY, I would like us to use the rfc-3253 semantics, i.e. that a COPY is semantically equivalent to a GET/PROPFIND followed by a PUT/PROPPATCH, where the PROPFIND/PROPPATCH is for all properties that can be PROPPATCH'ed at the destination.  </s>
<s> Cheers, Geoff I also prefer the stricter version... although only for MOVE.  </s>
<s> (The second wording doesn't mention "MOVE" explicitly.) "Clemm, Geoff" gclemm@rational.com  </s>
<s> "Clemm, Geoff" gclemm@rational.com  </s>
<s> Sent by: w3c-dist-auth-request@w3.org 07/25/2002 08:58 AM I'd prefer the stricter alternative, but I could live with the former if it said "SHOULD" instead of "MAY".  </s>
<s> Cheers, Geoff -----Original Message----- It depends on the precise wording of the language.  </s>
<s> One alternative is to be loose, allowing servers compliant with 2518 to still be compliant with 2518bis (with either MAY or SHOULD, I'm not sure yet): "A MOVE operation MAY fail (403 Forbidden) if the live properties of the source cannot be live properties of the destination.  </s>
<s> The server MAY remove live properties that are no longer appropriate at the destination."  </s>
<s> A stricter alternative: "All live properties on the source resource MUST become live properties on the destination resource with appropriate values and the same  </s>
<s> semantics.  </s>
<s> If the server cannot guarantee this, it MUST fail the request with 403 Forbidden."  </s>
<s> The problem with the stricter alternative is that it forbids a server from removing a live property.  </s>
<s> E.g. in collection "drafts", the property "draftstatus" (in some custom namespace) can be set by clients  </s>
<s> and the server allows certain actions on the resource based on the value of this property.  </s>
<s> Therefore "draftstatus" is a live property.  </s>
<s> When the resource is moved to the "publish" collection, "draftstatus" is no longer appropriate as a live property at all.  </s>
<s> May the server remove it?  </s>
<s> Lisa  </s>
<s> as  </s>
<s> This won't work (in all cases).  </s>
<s> The resource may have multiple representations (depending on request headers), but a simple sequence of GET/PROPFIND-PUT/PROPPATCH will only copy one of the representations.  </s>
<s> I believe this definition will work in enough cases for the implementor to be able to extrapolate what to do in those multiple-representation cases (and I'll bet is very close to how Xythos actually does implement its cross-repository MOVE).  </s>
<s> In particular, I believe we have to say something to clarify the distinction between MOVE and COPY, and that this would be a reasonable compromise between "fully defines every case" (not achievable) and "undefined" (pretty much what we have in 2518).  </s>
<s> But I'm always open to replacing it with something better!  </s>
<s> Cheers, Geoff  </s>
<s> This won't work (in all cases).  </s>
<s> The resource may have multiple representations (depending on request headers), but a simple sequence of GET/PROPFIND-PUT/PROPPATCH will only copy one of the representations.  </s>
<s> I support Geoff's proposal.  </s>
<s> COPY seems like a difficult species to define, and what Geoff proposes below seem like the best definition that we are likely to come up with.  </s>
<s> "Clemm, Geoff" com cc: Sent by: w3c- Subject: RE: New RFC2518bis draft, COPY / MOVE of live properities dist-auth- request@w3.org  </s>
<s> 07/25/2002 02:14 PM  </s>
<s> I believe this definition will work in enough cases for the implementor to be able to extrapolate what to do in those multiple-representation cases (and I'll bet is very close to how Xythos actually does implement its cross-repository MOVE).  </s>
<s> In particular, I believe we have to say something to clarify the  </s>
<s> distinction between MOVE and COPY, and that this would be a reasonable compromise between "fully defines every case" (not achievable) and "undefined" (pretty much what we have in 2518).  </s>
<s> But I'm always open to replacing it with something better!  </s>
<s> Cheers, Geoff  </s>
<s> This won't work (in all cases).  </s>
<s> The resource may have multiple representations (depending on request headers), but a simple sequence of GET/PROPFIND-PUT/PROPPATCH will only copy one of the representations.  </s>
<s> Unless I hear otherwise, I'm going to mark COPY_LIVE_PROPS as resolved... Resolved: 8/1/02: COPY should do the equivalent of a GET/PROPFIND followed  </s>
<s> by PUT/PROPPATCH. - MOVE should maintain the integrity of the resource in that all live properties and behaviors should remain live and have the same semantics at the new location as at the old location.  </s>
<s> If there is any doubt "same" is defined according to the resource author's concept of "this resource".  </s>
<s> If you'd like this changed, just speak up.  </s>
<s> :-) J.  </s>
<s> "COPY should do the equivalent of a GET/PROPFIND followed by PUT/PROPPATCH."  </s>
<s> I think *if* we say something like this we should warn that this may not produce a new resource that behaves the same under variant handling (because only one of possible multiple variants would be copied).  </s>
<s> Behalf Of Jason Crawford  </s>
<s> Unless I hear otherwise, I'm going to mark COPY_LIVE_PROPS as resolved... Resolved: 8/1/02: COPY should do the equivalent of a GET/PROPFIND followed  </s>
<s> by PUT/PROPPATCH. - MOVE should maintain the integrity of the resource in that all live properties and behaviors should remain live and have the same semantics at the new location as at the old location.  </s>
<s> If there is any doubt "same" is defined according to the resource author's concept of "this resource".  </s>
<s> If you'd like this changed, just speak up.  </s>
<s> :-) J.  </s>
<s> That warning is fine with me.  </s>
<s> There are a variety of ways in which the new resource could act differently, and that is one of them.  </s>
<s> Cheers, Geoff "COPY should do the equivalent of a GET/PROPFIND followed by PUT/PROPPATCH."  </s>
<s> I think *if* we say something like this we should warn that this may not produce a new resource that behaves the same under variant handling (because only one of possible multiple variants would be copied).  </s>
<s> -----Original Message----- Behalf Of Jason Crawford  </s>
<s> Unless I hear otherwise, I'm going to mark COPY_LIVE_PROPS as resolved... Resolved: 8/1/02: COPY should do the equivalent of a GET/PROPFIND followed  </s>
<s> by PUT/PROPPATCH. - MOVE should maintain the integrity of the resource in that all live properties and behaviors should remain live and have the same semantics at the new location as at the old location.  </s>
<s> If there is any doubt "same" is defined according to the resource author's concept of "this resource".  </s>
<s> If you'd like this changed, just speak up.  </s>
<s> :-) J.  </s>
<s> Fine with me also.  </s>
<s> :-)  </s>
<s> Sorry to react so late to this; I've been on sabbatical.  </s>
<s> I'm not saying I necessarily disagree, but I'm worried by the fact that  </s>
<s> this definition distinguishes between COPY and MOVE in a way that's quite different from what many other (well-implemented) specs do.  </s>
<s> Consider the following: 1.  </s>
<s> Many specs define MOVE as the atomic equivalent of COPY followed by DELETE.  </s>
<s> Wait a minute, actually 2518 does too!  </s>
<s> Wouldn't this  </s>
<s> "clarification" break this?  </s>
<s> 2. (Separate but related issue; don't think it's on the issue list.)  </s>
<s> There is no reason to *require* COPY to create a *new* resource; in fact, that's quite a problem for servers that implement copy-on-write semantics.  </s>
<s> I believe the key sentences in the current RFC are: Subsequent alterations to the destination resource will not modify the source resource.  </s>
<s> Subsequent alterations to the source resource will not modify the destination resource.  </s>
<s> which of course there are many ways to implement.  </s>
<s> 3. As others have pointed out, a single GET/PROPFIND followed by a single PUT/PROPPATCH is very unlikely to do a good copy.  </s>
<s> This is exactly why we have a separate method for COPY in the first place.  </s>
<s> It seems to me that the best clarification we could provide about both COPY and MOVE has to do with servers being able to say whether they own the destination resource and thus can guarantee the kinds of "property preservation" clients are hoping for.  </s>
<s> That is, there seem to me to be two key cases:  </s>
<s> Case 1: Both source and destination URLs/resources are controlled by the  </s>
<s> same "server semantics/process," and thus the source server can do a COPY by associating a resource with the destination URL that behaves exactly the same as the source resource under all variant forms of GET/PROPFIND (modulo locks not being copied and the location being different).  </s>
<s> In this case MOVE is, in fact, indistinguishable to WebDAV  </s>
<s> clients from a successful COPY followed by a successful DELETE.  </s>
<s> (Although perhaps delta-V clients might be able to distinguish...)  </s>
<s> Case 2: The source and destination resources are controlled by the same "server semantics/process," and thus neither can do better than GET/PUT PROPFIND/PROPPATCH.  </s>
<s> I don't think we should spend a lot of time trying to put requirements on what to do in Case 2, especially since there's no reason for a client to think that doing the COPY is going to produce results that are either better or more efficient than just doing the four roundtrips!  </s>
<s> Instead I think we should try to clarify the requirements on Case 1 and we should add a way for servers to either say in advance or say after the fact (or both) which kind of COPY will/did happen.  </s>
<s> dan  </s>
<s> the  </s>
<s> WebDAV  </s>
<s> Not only deltaV clients may be able to distinguish, but ACL clients could.  </s>
<s> For example, in Xythos WFS, when a file is copied the server initializes the ACLs like a new file.  </s>
<s> On the other hand when a file is moved, the server copies the ACLs intact.  </s>
<s> Xythos WFS also tracks access logs on files, and when a file is moved we want to keep the access logs on it, but when it's copied we don't want to duplicate the access logs, just keep the access logs for the original.  </s>
<s> Overall, the new distinction between MOVE and COPY seems more often useful than problematic.  </s>
<s> Lisa  </s>
<s> Dan, I've written a long answer to your posting, but I think I'll just send a short one.  </s>
<s> I tend to agree with Lisa.  </s>
<s> The way we've specified it now seems like the best we're going to do right now.  </s>
<s> COPY creates a new resource that is modeled on the source on a "best effort' basis whereas MOVE simply changes the URL at which we access a resource.  </s>
<s> And we've chosen to suggest that COPY (by default) just do the equivalent of of GET/PUT prop FIND/PATCH.  </s>
<s> I do see value in what you say at the end of your note.  </s>
<s> There might be value in a COPY'ing server to state how it treated the liveness of properties it just copied.  </s>
<s> Similarly it might be nice for a client to be able to point to a resource and ask a server what liveness constraints it's trying to maintain on various properties.  </s>
<s> But didn't we just remove the keep-alive feature?  </s>
<s> Apparently this wasn't used.  </s>
<s> So I'm hesitant to spend time working on liveness management features right now.  </s>
<s> Maybe later.  </s>
<s> I don't think what we're currently proposing closes the door on this.  </s>
<s> J.  </s>
<s> (agreed)  </s>
<s> From: w3c-dist-auth-request@w3.org [mailto:w3c-dist-auth-request@w3.org]On  </s>
<s> Behalf Of Dan Brotsky Sent: Monday, August 19, 2002 11:27 PM Subject: Re: New RFC2518bis draft, COPY / MOVE of live properities  </s>
<s> Yes.  </s>
<s> Yes, but that's an implementation detail.  </s>
<s> Even if you implement the copy as copy-on-write, for the *client* it will be a new resource nevertheless.  </s>
