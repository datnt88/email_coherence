<s> Should the setCssText method of a CSSRule that contains a style declaration [eg.  </s>
<s> CSSStyleRule] behave similarly to the setCssText of CSSStyleDeclaration. I.e can it be used to add CSSValues to the rule's internal style declaration.  </s>
<s> Example: styleRule.setCssText("H1  </s>
<s> {font-size: 10pt}"); styleRule.setCssText("H1  </s>
<s> {ascent:10}"); Should the last line remove 'font-size' from the style's internal style declaration or will it simply append the 'ascent' value, leaving the 'font-size' value intact.  </s>
<s> The latter behavior seems the more reasonable solution, but it is not stated in the specification.  </s>
<s> If the former behavior is followed then there will be problems dealing with outstanding CSSValues.  </s>
<s> Thanks for the clarification.  </s>
<s> Blaine  </s>
<s> It will remove it.  </s>
<s> setCssText is setting the _entire_ cssText - otherwise,  </s>
<s> it should be called "appendCssText".  </s>
<s> Should the setCssText method of a CSSRule that contains a style declaration [eg.  </s>
<s> CSSStyleRule] behave similarly to the setCssText of CSSStyleDeclaration. I.e can it be used to add CSSValues to the rule's internal style declaration.  </s>
<s> Example: styleRule.setCssText("H1  </s>
<s> {font-size: 10pt}"); styleRule.setCssText("H1  </s>
<s> {ascent:10}"); Should the last line remove 'font-size' from the style's internal style declaration or will it simply append the 'ascent' value, leaving the 'font-size' value intact.  </s>
<s> The latter behavior seems the more reasonable solution, but it is not stated in the specification.  </s>
<s> If the former behavior is followed then there will be problems dealing with outstanding CSSValues.  </s>
<s> Thanks for the clarification.  </s>
<s> Blaine  </s>
<s> Setting this attribute will result in the parsing of the new value and resetting of the properties in the declaration block.  </s>
<s> It also allows the insertion of additional properties and their values into the block.  </s>
<s> -- Document Object Model CSS Wed, 10 May 2000 15:09:02 GMT Hum, the cssText description could be better.  </s>
<s> What about : Setting this attribute will result in the parsing of the new value and resetting of all the properties in the declaration block including theremoval or addition of properties.  </s>
<s> Philippe  </s>
<s> Yes, this description is good.  </s>
<s> Can you please tell me what would happen  </s>
<s> in the following case where I retrieve a CSSValue from the rule's style declaration, and then make a call to the rule's setCssText method which removes the value's property from the declaration?  </s>
<s> Does the outstanding CSSValue reference become detached from its parent rule and simply perform method calls on the old data [without affecting the rule's declaration values] or does the reference become invalid and invalid state exceptions are thrown on any of the value's method calls?  </s>
<s> Example.  </s>
<s> styleRule.setCssText("H1 { ascent: 10 }"); CSSValue styleValue = style.getPropertyCSSValue("ascent");  </s>
<s> style.setCssText("H1  </s>
<s> {} "); //**** ascent property is removed eventhough a reference is outstanding ***// ( (CSSPrimitiveValue)styleValue).getFloatValue();  </s>
<s> Does the last call throw an invalid state exception or does it return the old value 10?  </s>
<s> Thanks, Blaine  </s>
<s> Hi Chris, 'appendCssText' is probably a better name, however CSSStyleDeclaration's setCssText, according to the current description, does not remove any properties.  </s>
<s> It is only capable of resetting and appending additional properties.  </s>
<s> Blaine  </s>
<s> From: bbrodie@savagesoftware.com (Blaine Brodie) Subject: Re(2): Expected behavior of CSSRule's setCssText.  </s>
<s> Too late for the next publication.  </s>
<s> I'll add the text before the REC.  </s>
<s> In that case, style.getPropertyCSSValue("ascent")  </s>
<s> will return null.  </s>
<s> The ascent property can be only applied on the @font-face rule [1].  </s>
<s> Let me rewrite your example: fontfaceRule.setCssText("@font-face  </s>
<s> { ascent: 10 }"); CSSValue fontfaceValue = fontfaceRule.getPropertyCSSValue("ascent");  </s>
<s> style.setCssText("@font-face  </s>
<s> {} "); /**** ascent property is removed eventhough a reference is outstanding ***/ ( (CSSPrimitiveValue)fontfaceValue).getFloatValue();  </s>
<s> Since the default value of the ascent font property is undefined, getFloatValue() will return INVALID_ACCESS_ERR.  </s>
<s> But I certainly don't recommend this kind of program since this depends on the CSS property.  </s>
<s> Some CSS properties can be a CSSValue or a CSSValue or a CSSValueList.  </s>
<s> Let's imagine a property "foo" with the following definition: inherit | integer | ident + Depending on the value, you'll cast the CSSValue in a different way.  </s>
<s> It becomes a nightmare if you invoke setCssText on the CSS*Value* after the cast.  </s>
<s> Some implementations can raise an INVALID_ACCESS_ERR, some others an invalid state exception, this depend on your implementation.  </s>
<s> I'm not sure we want to define these corners cases.  </s>
<s> It will add more constraints on the implementation of the interfaces and complexity in the spec for a bad practice.  </s>
<s> I recommend to change your program if you really want to do that as following: fontfaceRule.setCssText("@font-face  </s>
<s> { ascent: 10 }"); CSSValue fontfaceValue = fontfaceRule.getPropertyCSSValue("ascent");  </s>
<s> style.setCssText("@font-face  </s>
<s> {} "); /**** ascent property is removed eventhough a reference is outstanding ***/ if (fontfaceValue.getValueType()  </s>
<s> == CSS_PRIMITIVE_VALUE) { // this raises an INVALID_ACCESS_ERR since it is really a CSSPrimitiveValue ( (CSSPrimitiveValue)fontfaceValue).getFloatValue(); Philippe [1] http://www.w3.org/TR/CSS2/fonts.html#matching  </s>
<s> Hello Philippe, Thanks for the clarification.  </s>
<s> One other question regarding expected  </s>
<s> behavior of the setCssText method.  </s>
<s> What is expected to occur when there is an outstanding reference to a property value and then the property is removed via the rule's setCssText method and then that property is added back in via another call to the setCssText method.  </s>
<s> Should the outstanding  </s>
<s> reference be reenabled or will the reference remain in an invalid state for the rest of its life?  </s>
<s> Example: fontfaceRule.setCssText("@font-face  </s>
<s> { ascent: 10 }"); //property added CSSValue fontfaceValue = fontfaceRule.getPropertyCSSValue("ascent");  </s>
<s> fontfaceRule.setCssText("@font-face  </s>
<s> { }"); //property removed fontfaceRule.setCssText("@font-face  </s>
<s> { ascent: 10}"); //property re-added Should 'fontfaceValue' become reactive after the last call?  </s>
<s> Blaine  </s>
<s> All CSS objects in the DOM are "live", like NodeList or Attr.  </s>
<s> So, if you get a reference to a CSSValue object, it will be updated even if you do the changes throught the CSSStyleDeclaration interface.  </s>
<s> Philippe  </s>
