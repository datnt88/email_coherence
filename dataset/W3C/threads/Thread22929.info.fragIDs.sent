<s> Is it legal for a comment node to be created or modified to contain the string '-- ' in it?  </s>
<s> Ari Krupnikov  </s>
<s> As far as the DOM is concerned, yes.  </s>
<s> It's the serializer's responsibility to do something appropriate with it -- complain, or change the  into ,  </s>
<s> or whatever seems reasonable -- and/or your application's responsibility not to create this situation in the first place.  </s>
<s> We expect DOM Level 3 will add the ability to request a well-formedness check, which will report this sort of thing.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> It's not the ' ' that is the problem - it's the '--': XML rec, 2.5 Comments (http://www.w3.org/TR/1998/REC-xml-19980210#sec-comments) says 'For compatibility, the string "--" (double-hyphen) must not occur within  </s>
<s> comments.'  </s>
<s> BTW, are entity references resolved in comments?  </s>
<s> Ari Krupnikov  </s>
<s> Good point.  </s>
<s> But consider ...  </s>
<s> I'm honestly not sure when character references get processed, so I'm not sure whether that comes through as written, as --, or gets caught as a syntax error.  </s>
<s> I would be surprised if it's the latter.  </s>
<s> The DOM made a deliberate decision not to enforce every possible  </s>
<s> well-formedness constraint on every operation.  </s>
<s> String content, in general, is something we do not check at this time.  </s>
<s> If you're concerned, either refrain from producing ill-formed documents or check/fix them before using them... or access the DOM through higher-level libraries that provide those checks and repairs.  </s>
<s> As noted, DOM Level 3 is expected to provide more assistance in finding well-formedness problems, but will do so only when requested.  </s>
<s> I don't think so.  </s>
<s> Compare the grammar for comments [15] with the grammar for AttValue [10] or content [43].  </s>
<s> Comments don't make explicit provision for references, and hence are just raw character strings.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> It's well-formed; the only sequences that matter in a comment are "--" (illegal) and "-- " (terminator).  </s>
<s> All other characters are so much junk.  </s>
<s> There is / one art || John Cowan jcowan@reutershealth.com no more / no less || http://www.reutershealth.com  </s>
<s> to do / all things || http://www.ccil.org/~cowan with art- / lessness \\ -- Piet Hein  </s>
<s> !-- &amp;#45;&amp;#45;--  </s>
<s> That's about what I expected.  </s>
<s> The problem is that the DOM has committed to showing people their "junk", so we have to decide whether the content of  </s>
<s> that comment should be reported as " -- " or " &amp;#45;&amp;#45; "  </s>
<s> Which we should pick depends on when numeric character reference processing occurs versus other parts of XML syntax processing... and I'm still a bit fuzzy on that detail.  </s>
<s> Joe Kesselman / IBM Research  </s>
<s> Questionless, the latter is correct.  </s>
<s> Numeric character references are interpreted only in content and in attribute values.  </s>
<s> Everywhere else, they're either illegal (names, mostly) or uninterpreted.  </s>
<s> Not when but where.  </s>
<s> There is / one art || John Cowan jcowan@reutershealth.com no more / no less || http://www.reutershealth.com  </s>
<s> to do / all things || http://www.ccil.org/~cowan with art- / lessness \\ -- Piet Hein  </s>
<s> For completeness: A a comment with a nodeValue ending in the character '-' is also well-formed (see XML Erratum 27).  </s>
<s> The XML spec says that comments are not part of the document's character data (?  </s>
<s> 2.5), likewise prod.  </s>
<s> [15] does not refer to 'CharRef' (prod.  </s>
<s> [66]) when defining 'Comment'.  </s>
<s> This seems to me to be a strong indication, that the character sequence '&amp;#45;&amp;#45;' in a comment is ontologically nothing else than a character sequence.  </s>
<s> Dieter K?hler, M. A. - dieter.koehler@ppp.uni-bamberg.de  </s>
<s> Mittlere Kaulberg 22, D-96049 Bamberg, +49(0)951-5190726 "http://www.philo.de/Philosophie-Seiten/":  </s>
<s> 1000+ Philosophie-Links "http://www.philo.de/VirtualLibrary/14.de.htm": Deutsche Philo-Links "http://www.philo.de/xml/":  </s>
<s> Open XML - XML-Komponenten f?r Delphi  </s>
<s> Since writers often use comments in all languages to exclude parts of a document or program from processing (what we call "commenting out" source text, I would suggest that any implementation that stores comments ought to store them as unmodified strings.  </s>
<s> Consider the effects of expanding on this common situation: !--  </s>
<s> In fact, I would go so far as to allow embedded CDATA sections in comments.  </s>
<s> J. G. Spragge ---------- standard disclaimers apply Essays on capital punishment and network ethics at  </s>
