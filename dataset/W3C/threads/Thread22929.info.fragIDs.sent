Is it legal for a comment node to be created or modified to contain the string '-- ' in it? 
Ari Krupnikov 
As far as the DOM is concerned, yes. 
It's the serializer's responsibility to do something appropriate with it -- complain, or change the  into , 
or whatever seems reasonable -- and/or your application's responsibility not to create this situation in the first place. 
We expect DOM Level 3 will add the ability to request a well-formedness check, which will report this sort of thing. 
Joe Kesselman / IBM Research 
It's not the ' ' that is the problem - it's the '--': XML rec, 2.5 Comments (http://www.w3.org/TR/1998/REC-xml-19980210#sec-comments) says 'For compatibility, the string "--" (double-hyphen) must not occur within 
comments.' 
BTW, are entity references resolved in comments? 
Ari Krupnikov 
Good point. 
But consider ... 
I'm honestly not sure when character references get processed, so I'm not sure whether that comes through as written, as --, or gets caught as a syntax error. 
I would be surprised if it's the latter. 
The DOM made a deliberate decision not to enforce every possible 
well-formedness constraint on every operation. 
String content, in general, is something we do not check at this time. 
If you're concerned, either refrain from producing ill-formed documents or check/fix them before using them... or access the DOM through higher-level libraries that provide those checks and repairs. 
As noted, DOM Level 3 is expected to provide more assistance in finding well-formedness problems, but will do so only when requested. 
I don't think so. 
Compare the grammar for comments [15] with the grammar for AttValue [10] or content [43]. 
Comments don't make explicit provision for references, and hence are just raw character strings. 
Joe Kesselman / IBM Research 
It's well-formed; the only sequences that matter in a comment are "--" (illegal) and "-- " (terminator). 
All other characters are so much junk. 
There is / one art || John Cowan jcowan@reutershealth.com no more / no less || http://www.reutershealth.com 
to do / all things || http://www.ccil.org/~cowan with art- / lessness \\ -- Piet Hein 
!-- &amp;#45;&amp;#45;-- 
That's about what I expected. 
The problem is that the DOM has committed to showing people their "junk", so we have to decide whether the content of 
that comment should be reported as " -- " or " &amp;#45;&amp;#45; " 
Which we should pick depends on when numeric character reference processing occurs versus other parts of XML syntax processing... and I'm still a bit fuzzy on that detail. 
Joe Kesselman / IBM Research 
Questionless, the latter is correct. 
Numeric character references are interpreted only in content and in attribute values. 
Everywhere else, they're either illegal (names, mostly) or uninterpreted. 
Not when but where. 
There is / one art || John Cowan jcowan@reutershealth.com no more / no less || http://www.reutershealth.com 
to do / all things || http://www.ccil.org/~cowan with art- / lessness \\ -- Piet Hein 
For completeness: A a comment with a nodeValue ending in the character '-' is also well-formed (see XML Erratum 27). 
The XML spec says that comments are not part of the document's character data (? 
2.5), likewise prod. 
[15] does not refer to 'CharRef' (prod. 
[66]) when defining 'Comment'. 
This seems to me to be a strong indication, that the character sequence '&amp;#45;&amp;#45;' in a comment is ontologically nothing else than a character sequence. 
Dieter K?hler, M. A. - dieter.koehler@ppp.uni-bamberg.de 
Mittlere Kaulberg 22, D-96049 Bamberg, +49(0)951-5190726 "http://www.philo.de/Philosophie-Seiten/": 
1000+ Philosophie-Links "http://www.philo.de/VirtualLibrary/14.de.htm": Deutsche Philo-Links "http://www.philo.de/xml/": 
Open XML - XML-Komponenten f?r Delphi 
Since writers often use comments in all languages to exclude parts of a document or program from processing (what we call "commenting out" source text, I would suggest that any implementation that stores comments ought to store them as unmodified strings. 
Consider the effects of expanding on this common situation: !-- 
In fact, I would go so far as to allow embedded CDATA sections in comments. 
J. G. Spragge ---------- standard disclaimers apply Essays on capital punishment and network ethics at 
