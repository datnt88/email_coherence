<s> Hi,  </s>
<s> I use Amaya to create XHTML documents containing french and thus use the ISO-8859-1 charset.  </s>
<s> The problem is that Amaya does not insert the encoding in the resulting  </s>
<s> XHTML document: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"  </s>
<s> So my document does not render well with another XML browser.  </s>
<s> But it's OK if I add the encoding: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"  </s>
<s> Is there something to add in the document to make Amaya generate the encoding ?  </s>
<s> Thanks, Catherine.  </s>
<s> Catherine CHAT - Responsable Technique VIA BUSINESS S.A. Domaine de Voluceau - BP 105 - 78153 Le Chesnay cedex - FRANCE  </s>
<s> Catherine,  </s>
<s> If your documents are written in French, I suggest you set a lang attribute on the html or body element.  </s>
<s> Use the Attribute button to do that.  </s>
<s> Then, when you save a document, the encoding  </s>
<s> is added to the XML declaration and a meta http-equiv... element is generated with the right charset.  </s>
<s> Vincent.  </s>
<s> [DJW:] French uses the HTML and Microsoft US default character encodings (ISO 8859/1 and CP 1252 respectively), so specifying the French language  </s>
<s> really ought not to change the character set, even if it is the typical misuse of CP 1252 for documents that are perfectly compatible with the HTML default  </s>
<s> character set.  </s>
<s> [DJW:] For HTML compatibility, I would therefore say that Amaya should be defaulting ISO 8859/1, not UTF-8/16.  </s>
<s> It should not be overriding CP 1252 even if lang is set to fr.  </s>
<s> It should not assume UTF-8/16 when it doesn't know the language.  </s>
<s> If the document is actually served as HTML, 8859/1 is the default, and not all browsers understand  </s>
<s> http-equiv, which is really a hack for dealing with servers that can't be properly configured, so, whilst  </s>
<s> Amaya is an [X]HTML tool, it should default to 8859/1.  </s>
<s> Also, in HTML, lang is supposed to be orthogonal, to encoding, so it can, at best, be used as hint to the encoding for newly created documents.  </s>
<s> --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS.  </s>
<s> Vincent.Quint@inrialpes.fr  </s>
<s> said:  </s>
<s> Why do it that way?  </s>
<s> It doesn't seem right to tie the encoding with the language specification.  </s>
<s> My understanding is that the encoding defines what numerical byte values are stored in a file to represent characters,  </s>
<s> while the language specification makes reference to how sequence of characters are made up to form words.  </s>
<s> I might very well want to write a French text in plain ASCII, using XHTML's ISO Latin 1 entities for accented letters.  </s>
<s> In such a case, I just need to add !ENTITY % HTMLlat1 PUBLIC "-//W3C//ENTITIES Latin 1 for XHTML//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml-lat1.ent" %HTMLlat1; to my XML code and declare a UTF-8 encoding.  </s>
<s> I might also want to write an English text, talking about accented letters, in ISO-8859-1 encoding/character set.  </s>
<s> I can understand if, for the moment, Amaya is limited to ISO-8859-1  </s>
<s> encoding.  </s>
<s> But then, the insertion of the encoding="ISO-8859-1" attribute  </s>
<s> should be based on whether there is an accented letter in the current document or not.  </s>
<s> This is actually how my email program works.  </s>
<s> If I send an email message that contains accented letters (like the following to the "Content-Type: text/plain;" header.  </s>
<s> Peace, Bertrand Ibrahim.  </s>
<s> Bertrand.Ibrahim@cui.unige.ch  </s>
<s> My previous message was a bit brief.  </s>
<s> Sorry.  </s>
<s> Obviously, if encoding is clearly stated in a document, Amaya won't  </s>
<s> change it when saving the document.  </s>
<s> That's only when the encoding is not indicated that Amaya adds ISO-8859-1 based on the lang attribute.  </s>
<s> Vincent. Vincent Quint INRIA Rhone-Alpes W3C/INRIA ZIRST e-mail: Vincent.Quint@w3.org  </s>
<s> 655 avenue de l'Europe  </s>
<s> [DJW:] But English, the most likely case for a missed lang, (or at least en-gb) has as good a case for requiring 8859/1 as does French.  </s>
<s> [DJW:] --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS.  </s>
<s> Amaya adds ISO-8859-1 not only for French, but also for many other languages, including English.  </s>
<s> Vincent.  </s>
<s> Bad idea, IMHO.  </s>
<s> Charset is mostly orthogonal to language and one cannot be inferred from the other in general.  </s>
<s> As for the meta http-equiv... , it should always be there, whether the user specifies a language or not (there is always a charset!) Fran?ois Yergeau  </s>
<s> There is no default charset in HTML.  </s>
<s> From the HTML 4.01 spec [1]: 'Therefore, user agents must not assume any default value for the "charset" parameter.'  </s>
<s> You must have been thinking of the HTTP default charset.  </s>
<s> Bad idea, Amaya doesn't know if the document will be served by HTTP or otherwise, so it cannot assume this default.  </s>
<s> It should always add a  </s>
<s> Right. Fran?ois Yergeau  </s>
<s> I am sorry but when saving the attached XHTML document with Amaya the header is changed from: to: Isn't it the way to state encoding in XML documents ?  </s>
<s> Catherine.  </s>
<s> Catherine, You are right.  </s>
<s> This is a bug.  </s>
<s> In the current version, the XML parser ignores the charset indicated in the xml declaration.  </s>
<s> This will be fixed, but this version can still generate the right encoding at saving time if it is indicated in the meta http-equiv element.  </s>
<s> In your example, change the second meta element to: I guess you are working locally, because if the server sends the document with a charset indicated in the HTPP header, you should not have this problem.  </s>
<s> Vincent.  </s>
<s> P.S.: Thanks for the nice poem.  </s>
<s> [DJW:] I said served as text/html, which implies the use of an HTTP server and text/html content-type.  </s>
<s> [DJW:] That's not the same thing.  </s>
<s> No encoding means UTF-8 or UTF-16.  </s>
<s> Amaya should store documents as  </s>
<s> ISO 8859/1 unless told otherwise, as that is what most users will expect; i.e. it should default to storing in  </s>
<s> that encoding, not the XML default.  </s>
<s> XML then requires that the charset be included in the the PI and XHTML suggests/requires its inclusion in the http-equiv hack.  </s>
<s> What apparently is happening is that it is defaulting to UTF-8, although I suspect it only works correctly if the display also uses UTF-8.  </s>
<s> E.g. if I type GBP (currency  </s>
<s> symbols) the resulting document displays correctly in a simple text editor in CP 1252 (ISO 8859/1 superset), but the XML encoding says that it should be interpreted as UTF, which wouldn't correctly display.  </s>
<s> It's therefore either defaulting to 8859/1 or to the local GUI display encoding, not to the one it claims to be using.  </s>
<s> [DJW:] --------------------------- DISCLAIMER --------------------------------- Any views expressed in this message are those of the individual sender, except where the sender specifically states them to be the views of BTS.  </s>
<s> I don't see that in your message.  </s>
<s> You wrote things such as "compatible with the HTML default character set" and "For HTML compatibility, I would therefore say that Amaya should be defaulting ISO 8859/1" and "Amaya is an [X]HTML tool, it should default to 8859/1".  </s>
<s> I felt it was important to debunk this purported HTML default charset, which doesn't exist.  </s>
<s> If you mean no encoding *declaration* in XML, then yes (unless there is external information, such as an HTTP header, that says otherwise).  </s>
<s> Well, that's what it does, no? Apart from the fact that this is not a very good idea (a better default would be something based the platform's locale/charset, still better a user preference), the problem is that Amaya currently saves XHTML with inconsistent encoding declarations, unless you set a language.  </s>
<s> If I save a new document, I now see: !DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"  </s>
<s> The XML declaration, lacking an encoding decl., implies that the encoding is UTF-8 while the document is actually saved in 8859-1.  </s>
<s> The meta comes too late in the head (it should come before title ) and anyway is totally useless; if I can parse that far, I already know it's text/html!  </s>
<s> As Vincent indicated, only if I set a language do I get correct declarations.  </s>
<s> I don't see that, how do get this behaviour?  </s>
<s> What I see is the doc stored in 8859-1 but the XML declaration lying about it.  </s>
<s> If I set a language att on html , the doc is still stored in 8859-1 but the declarations now correctly say so.  </s>
<s> Fran?ois Yergeau  </s>
