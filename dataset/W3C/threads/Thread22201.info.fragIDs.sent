<s> I've added a attrcreatetextnode3 and 4 that should come closer to the stated  </s>
<s> intent of the the test and modified the descriptions for attrcreatetextnode  </s>
<s> and attrcreatetextnode2.  </s>
<s> exercise the test  </s>
<s> I went back and checked earlier sources and that seems to have been  </s>
<s> brought  </s>
<s> over from the original NIST tests.  </s>
<s> Definitely the actual test doesn't exercise the intent, not only is the semi-colon missing but it uses a % instead of a &amp;.  </s>
<s> I think the right thing to do is to change the description and admit that the test isn't doing what it should be doing and to add additional tests that might actually trigger the potentially flawed behavior.  </s>
<s> Was there a reason this message was sent off-list?  </s>
<s> Could you resent this  </s>
<s> or  </s>
<s> the original message to the mailing list to get it in the official record?  </s>
<s> ----- Original Message ----- From: "Nick Efthymiou" NEFTH@pacbell.net Sent: Saturday, April 20, 2002 2:59 AM Subject: Testcase attrcreatetextnode2.xml in level1/core does not exercise the test  </s>
<s> Please review tnode2.xml?annotate=1.2  </s>
<s> Line 22 states the intention of the test: 22: child of of the fourth employee and assign the "Y%ent1;" Line 44 sets the value as follows (note missing ";"): 44: nodeValue obj="streetAttr" value='"Y%ent1"'/ Since no entity is set, the test case does not test what it is intended  </s>
<s> to.  </s>
<s> The same bug (test does not exercise what is intended) is apparently  </s>
<s> also  </s>
<s> true with attrcreatetextnode: tnode.xml?annotate=1.7  </s>
<s> Same line numbers (22 vs. 44).  </s>
<s> Regards, - Nick -  </s>
<s> Not sure I understand why we have 4 tests - Perhaps we should set the attribute to be something different than what was originally in the file -- the use of %ent1 was an error, but rather than using &amp;ent1;, which is what is in the xml file already, we should set it to &amp;ent2; - then it may be less confusing.  </s>
<s> What's the purpose of the additional tests.  </s>
<s> Curt, did you create attrcreatetextnode2, and forget to change the metadata info?  </s>
<s> I don't think that is a test that we created.  </s>
<s> Could you please explain the differences and the additional need for attrcreatetextnode2, 3, &amp; 4? I would think in general if a test has a bug, we should agree on a fix and fix the original test rather than creating additional tests.  </s>
<s> Is there something more going on here than is stated in the description.  </s>
<s> It does appear that you are trying to do something with nodevalue as well -- could you provide a little more detail?  </s>
<s> --Mary exercise the test  </s>
<s> stated  </s>
<s> attrcreatetextnode  </s>
<s> I went back and checked earlier sources and that seems to have been  </s>
<s> over from the original NIST tests.  </s>
<s> Definitely the actual test doesn't exercise the intent, not only is the semi-colon missing but it uses a % instead of a &amp;.  </s>
<s> I think the right thing to do is to change the description and admit  </s>
<s> that  </s>
<s> the test isn't doing what it should be doing and to add additional tests that might actually trigger the potentially flawed behavior.  </s>
<s> Was there a reason this message was sent off-list?  </s>
<s> Could you resent  </s>
<s> this  </s>
<s> the original message to the mailing list to get it in the official  </s>
<s> record?  </s>
<s> ----- Original Message ----- From: "Nick Efthymiou" NEFTH@pacbell.net Sent: Saturday, April 20, 2002 2:59 AM Subject: Testcase attrcreatetextnode2.xml in level1/core does not  </s>
<s> exercise  </s>
<s> Please review tnode2.xml?annotate=1.2  </s>
<s> Line 22 states the intention of the test: 22: child of of the fourth employee and assign the "Y%ent1;" Line 44 sets the value as follows (note missing ";"): 44: nodeValue obj="streetAttr" value='"Y%ent1"'/ Since no entity is set, the test case does not test what it is  </s>
<s> intended  </s>
<s> The same bug (test does not exercise what is intended) is apparently  </s>
<s> true with attrcreatetextnode: tnode.xml?annotate=1.7  </s>
<s> Same line numbers (22 vs. 44).  </s>
<s> Regards, - Nick -  </s>
<s> From the description of the test, the original author were trying to find a processor that would set an attribute to "Yes" by mistakening expanding an reference to the ent1 entity on a call to setNodeValue or equivalent.  </s>
<s> However, they used "Y%ent1" instead of "Y&amp;ent1;".  </s>
<s> The tests were not bad tests, they were just weak tests.  </s>
<s> However, after a test is released, there should be not substantive change to the body of the test.  </s>
<s> In this case, since the existing tests weren't bad, they did not need to be removed from the suite.  </s>
<s> However, to actually test what they had intended to test required adding new tests.  </s>
<s> p.s. I did check the log and it appears that attrcreatetextnode2 was a variation of attrcreatetextnode that I made to provide coverage for Attr.setNodeValue about 6 months ago (the original test uses Attr.setValue), but I did not change the contributor and date from the original.  </s>
<s> I've changed the metadata on the CVS version.  </s>
<s> The original bug reports addressed weaknesses that existed in both attrcreatetextnode and attrcreatetextnode2.  </s>
<s> Hmmm -- not I'm even more confused.  </s>
<s> When I looked at the original test, I thought that the expected result was supposed to be "Y&amp;ent1;", not the expanded version.  </s>
<s> I don't have the spec in front of me at the moment, but I believe both it and the comment against it were that the expected result should not expand the entity, rather be the text itself.  </s>
<s> Thus, there was a problem with the test, setting the result to "Y%ent1" instead of "Y&amp;ent1;".  </s>
<s> At that point, I would have changed the test to simply use "Y&amp;ent1;" instead.  </s>
<s> After further consideration, it might be better to change it to be some other entity, maybe "Y&amp;ent2;", since that particular attribute is already set to "Y&amp;ent1;" in the staff.xml  </s>
<s> file -- it's difficult to determine that the setValue actually did anything otherwise.  </s>
<s> --Mary P.S. Please for the moment cc: Rick and/or myself or www-dom-ts issues if you want feedback.  </s>
<s> We seem to be having problems getting mail from this list.  </s>
<s> There appears to have been a 24 hour delay in messages getting relayed.  </s>
<s> It is not just you.  </s>
<s> The conformant value is "Y&amp;ent1;" or "Y%ent1" depending on the test.  </s>
<s> The test was intended to expose a potential flaw where the parameter was processed through an entity expansion step.  </s>
<s> If that flaw existed then "Y&amp;ent1;" would be incorrectly expanded to "Yes", however "Y%ent1" would either not be recognized as anything special or even more unlikely as a incomplete parameter entity reference.  </s>
<s> If such a flaw existed, "Y&amp;ent1;" is much more likely to expose it than "Y%ent1".  </s>
<s> I believe the use of the same fragment "Y&amp;ent1;" in staff.xml and in the test was intentional, that the test author wanted to do something with a DOM method that looked very much like content in the XML document, but had different results due to the entity expansion step in parsing the XML document and the lack of an entity expansion step in processing values set by DOM methods.  </s>
<s> I don't think there is any difficulty distinguishing between the initial state and a conformant state.  </s>
<s> After the setValue call, the attribute would have a value that would have required the XML document to have contained "Y&amp;amp;ent1;".  </s>
<s> I'm pretty sure that attrcreatetextnode3 does what the author of attrcreatetextnode was wanting to do but didn't quite accomplish.  </s>
<s> Hmmm -- not I'm even more confused.  </s>
<s> When I looked at the original test, I thought that the expected result was supposed to be "Y&amp;ent1;", not the expanded version.  </s>
<s> I don't have the spec in front of me at the moment, but I believe both it and the comment against it were that the expected result should not expand the entity, rather be the text itself.  </s>
<s> Thus, there was a problem with the test, setting the result to "Y%ent1" instead of "Y&amp;ent1;".  </s>
<s> At that point, I would have changed the test to simply use "Y&amp;ent1;" instead.  </s>
<s> After further consideration, it might be better to change it to be some other entity, maybe "Y&amp;ent2;", since that particular attribute is already set to "Y&amp;ent1;" in the staff.xml  </s>
<s> file -- it's difficult to determine that the setValue actually did anything otherwise.  </s>
<s> --Mary P.S. Please for the moment cc: Rick and/or myself or www-dom-ts issues if you want feedback.  </s>
<s> We seem to be having problems getting mail from this list.  </s>
<s> Comments inlined.  </s>
<s> --Mary There appears to have been a 24 hour delay in messages getting relayed.  </s>
<s> It is not just you.  </s>
<s> The conformant value is "Y&amp;ent1;" or "Y%ent1" depending on the test.  </s>
<s> The test was intended to expose a potential flaw where the parameter was processed through an entity expansion step.  </s>
<s> If that flaw existed then "Y&amp;ent1;" would be incorrectly expanded to "Yes", however "Y%ent1" would either not be recognized as anything special or even more unlikely as a incomplete parameter entity reference.  </s>
<s> If such a flaw existed, "Y&amp;ent1;" is much more likely to expose it than "Y%ent1".  </s>
<s> I believe the use of the same fragment "Y&amp;ent1;" in staff.xml and in the test was intentional, that the test author wanted to do something with a DOM method that looked very much like content in the XML document, but had different results due to the entity expansion step in parsing the XML document and the lack of an entity expansion step in processing values set by DOM methods.  </s>
<s> I don't think there is any difficulty distinguishing between the initial state and a conformant state.  </s>
<s> After the setValue call, the attribute would have a value that would have required the XML document to have contained "Y&amp;amp;ent1;".  </s>
<s> I'm pretty sure that attrcreatetextnode3 does what the author of attrcreatetextnode was wanting to do but didn't quite accomplish.  </s>
<s> [mb] I disagree -- it was simply a mistake in invoking the entity.  </s>
<s> These tests were originally authored here at NIST, so I'm privy to what the author intended.  </s>
<s> This one was written early on and has simply been translated into java and then DOM TSML with the error.  </s>
<s> The intent of the test was to set it to "Y&amp;ent1;" and it was simply an error.  </s>
<s> I don't see the need for four tests (and find having four of them rather confusing), and don't believe that having a test that sets the value to a flawed parameter entity reference is particularly useful.  </s>
<s> Overall, the goal here is to have a good set of conformance tests.  </s>
<s> I don't see problems in modifying flawed tests to do what they should do rather than creating additional tests.  </s>
<s> Just simply make the corrections, and update the metadata.  </s>
<s> The cvs log will annotate differences and allow one to see the progression of the tests.  </s>
<s> Additional tests should only be created if something else needs to be tested.  </s>
<s> ----- Original Message ----- Hmmm -- not I'm even more confused.  </s>
<s> When I looked at the original test, I thought that the expected result was supposed to be "Y&amp;ent1;", not the expanded version.  </s>
<s> I don't have the spec in front of me at the moment, but I believe both it and the comment against it were that the expected result should not expand the entity, rather be the text itself.  </s>
<s> Thus, there was a problem with the test, setting the result to "Y%ent1" instead of "Y&amp;ent1;".  </s>
<s> At that point, I would have changed the test to simply use "Y&amp;ent1;" instead.  </s>
<s> After further consideration, it might be better to change it to be some other entity, maybe "Y&amp;ent2;", since that particular attribute is already set to "Y&amp;ent1;" in the staff.xml  </s>
<s> file -- it's difficult to determine that the setValue actually did anything otherwise.  </s>
<s> --Mary P.S. Please for the moment cc: Rick and/or myself or www-dom-ts issues if you want feedback.  </s>
<s> We seem to be having problems getting mail from this list.  </s>
