<s> The ERB yesterday discussed the issue of datatypes (among others).  </s>
<s> I was foolish enough to toss out a strawman proposal, so was granted the task of tuning it up (into a flaxman, perhaps?) for the WG to discuss.  </s>
<s> There seem to be two main axes along which we can differentiate approaches: 1) The range of datatypes we choose to support.  </s>
<s> 2) The place where datatypes get defined, and then where they get associated with particular data (individual element instance; elements that provide meta-information; or the DTD).  </s>
<s> NOTE: There is a third axis, namely whether datatypes can be applied to attributes, to content, or both; but I think a solution that only applies to  </s>
<s> one would look fairly silly so I show all examples in a way that can work  </s>
<s> for both.  </s>
<s> Along the first axis, there are several obvious points we can choose:  </s>
<s> a) Do nothing: have no types for #PCDATA, and only the existing attribute declared values.  </s>
<s> b) Define a small, fixed number of atomic types.  </s>
<s> c) Define a language for defining datatypes: regex (say, per POSIX), or perhaps HyLex.  </s>
<s> d) Define a way to access *any* programming, scripting, or other language at  </s>
<s> all.  </s>
<s> For example, consider a datatype like DATETIME, and assume for the moment one of the ISO-standard forms, such as "1997-05-21 22:45:00".  </s>
<s> The four points just described enable different degrees of validation (well-formedness is not at issue; and we are talking here about validation *within* the purview of the system we are standardizing; individual applications can do any post-processing and checking they want).  </s>
<s> For the 4 approaches above, respectively: a) No validation is provided; "foo" is a perfectly valid value for a DATETIME, since DATETIME has no standing in SGML (it's either a CDATA attribute or CDATA/RCDATA/#PCDATA content).  </s>
<s> If you make a separate element (not attribute) that contains only a DATETIME value, you could still associate a NOTATION attribute which could, in some implementation, invoke a validation processor outside SGML.  </s>
<s> b) If and only if we provide this DATETIME type, implementors of validating XML parsers would build it just as they build support for IDREFS now.  </s>
<s> c) Validation of the lexical form can be defined by users who need it, but as MSM pointed out regexes can't catch February 29 of non-leap years (except via a *really* hideously long expression).  </s>
<s> d) Since in (d) you can access a complete language (like C or Java), of course you can implement the whole leap-year algorithm and invoke it.  </s>
<s> Of course, (c) or (d) could *also* provide predefined forms as in (b), and (d) could still provide one particular language as in (c).  </s>
<s> Regexes are so ubiquitous, and buy an essentially infinite mechanism for only slightly more (possibly less) effort than (b), so I think they should be included.  </s>
<s> I  </s>
<s> wouldn't mind (d), so long as we require support for regexes as an interoperable choice.  </s>
<s> NOTE: In following examples I include a NOTATION name as would be needed for (d).  </s>
<s> With (c) these could of course be deleted, since the constraint language would be a constant.  </s>
<s> Along the second axis, possible approaches are shown below.  </s>
<s> In any of these cases we could use entities or hyperlink references to keep the constraint definitions outside the actual physical document stream, which may be desirable so WF parsers need not waste time to parse past constructs they won't need.  </s>
<s> a) Associate datatypes with data via attributes.  </s>
<s> Provide a place to define  </s>
<s> the datatypes elsewhere (header, referenced file, etc).  </s>
<s> This is a lot like HyTime "lextypes", which do this rather nicely.  </s>
<s> This has the advantage that nothing in SGML has to be touched.  </s>
<s> It has the disadvantages of considerable indirection, reliance on DTDs, verbosity, and requiring internal structure for attributes (or in attribute lists if you split up XML-LEXTYPE into, say, XML-LEXTYPE-.PCDATA and XML-LEXTYPE-TYPE -- like HyTime LINKENDS and the TC).  </s>
<s> It does make it possible to apply entirely different constraints to different instances of the same attribute, but this might be considered a liability as well as a benefit.  </s>
<s> Obviously the definitions could be expressed in elements, in new declaration types added by an amendment, or in PIs.  </s>
<s> There is also a variation where the *entire* datatype definition goes on the attributes, but that is more verbose, less clear, and obviates mnemonic names for datatypes.  </s>
<s> b) State the relationships between datatypes and attributes or content right with the definitions, for example in header elements that apply for the rest of the document.  </s>
<s> This reduces clutter: expr="[0-9]+" notation="regex" expr="[a-z][0-9]" notation="regex"  </s>
<s> c) In the DTD itself, via an amendment.  </s>
<s> Since SGML already has declarations  </s>
<s> for the objects we want to constrain, and those declarations already provide  </s>
<s> similar kinds of constraints (such as attribute declared values), this seems the conceptually appropriate place.  </s>
<s> It would also require the least  </s>
<s> complicated indirection and would be a near-trivial change technically.  </s>
<s> One way to do it is simply to adopt HyTime's lexical typing mechanism into SGML proper (that mechanism also becomes simpler in the process).  </s>
<s> For example:  </s>
<s> !-- like entity dcls, one could allow the value to be an external ID, not just a literal -- !ATTLIST p type CDATA(letdig) This requires only a few, backward-compatible additions:  </s>
<s> i) A new DATATYPE declaration patterned after HyTime's lexical type definition AF (this does not introduce any broad dependency on HyTime, since the lexical typing is well modularized).  </s>
<s> ii) An optional (lextype-name) suffix on attribute declared values (at least CDATA) and on the keyword #PCDATA.  </s>
<s> I believe there is no syntax conflict with () in either place; if I missed one, some other delimiter could of course be substituted.  </s>
<s> The declared value name and/or #PCDATA keywords could of course be replaced rather than suffixed by the lexical type name, for example by #DATATYPE(name).  </s>
<s> I think this approach can get the full capability of HyTime's lextype, including the ability to hook to any external constraint language for arbitrarily complex constraints.  </s>
<s> It does not complicate *parsing* of XML document instances, since WFedness is unaffected (in just the same way that HyTime lexical types, which are managed entirely separate from SGML parsing, do not affect SGML validity or parsed results).  </s>
<s> *Validation* in this scenario is harder only by exactly as much as it take to support the new capability.  </s>
<s> So far as I can see, its sole relative disadvantage is that it requires an enhancement to SGML itself.  </s>
<s> So, that's a structuring of basic options.  </s>
<s> I favor providing one specific, powerful though not total constraint language, namely regular expressions, and a hook for getting to any others via NOTATION like SGML and HyTime provide for many other cases.  </s>
<s> I also favor proposing an amendment to move this compatibly into SGML proper, since it is a very small, backward compatible, but highly leveragable change, and is far cleaner than having to attach it indirectly somewhere else.  </s>
<s> Hope I've at least been clear.  </s>
<s> Steven J. DeRose, Ph.D., Chief Scientist Inso Electronic Publishing Solutions (formerly EBT)  </s>
<s> There's a fourth axis: Which software module should be in charge of data type validation, the XML processor or an application?  </s>
<s> A number of people were pointing out the work involved in implementing some such validation schemes, and it may put us far outside XML-Lang's "development budget."  </s>
<s> If we make XML-Type a separate spec, the existence of a type-validation application would be implied, the way XML-Link implies the existence of a link-processing application.  </s>
<s> Eve  </s>
<s> I vote for (c) and (d), using HyLex for (c) and NOTATIONs to declare (but not necessarily define) support for (d).  </s>
<s> HyLex is not as familiar to most people as Perl or POSIX regexps, but it's equally powerful.  </s>
<s> It's also more verbose, but is less cryptic to the uninitiated.  </s>
<s> Or (d), in the DTD itself via (GASP!) processing instructions.  </s>
<s> Something like: ?LEXMODEL url( (scheme, "://", host, (":", port)?, "/")?, path, ("#", fragment)?, ("?", query)?  </s>
<s> ) !-- ?LEXTYPE ...  PI associates a lexical model with an attribute or content: -- !-- Possibility: defining a NOTATION with the same name as a lexical model declares semantics for that type: -- !NOTATION url PUBLIC "-//IETF//NOTATION RFC 1738 Uniform Resource Locators" All this stuff can go in the DTD, or possibly at the front of the document (except for !NOTATION... decls).  </s>
<s> --Joe English jenglish@crl.com  </s>
<s> I am against adding data typing as another XML-lang validation issue.  </s>
<s> I'd prefer "validating XML-lang" and "validating data types" to be separate (orthogonal) issues/features/modules/whatever so that an "XML-datatyping"  </s>
<s> spec (misleadingly named, since it would be data typing for all SGML) could  </s>
<s> be used (or not) independently for XML or SGML applications.  </s>
<s> I'd entertain some sort of "datatyping=yes" attribute on our introductory ?XML ... version="1.0"  </s>
<s> ... ?  </s>
<s> PI, but the default handling of XML should  </s>
<s> not require datatyping.  </s>
<s> It just isn't necessary to require that of all  </s>
<s> XML processors.  </s>
<s> paul  </s>
<s> I support this.  </s>
<s> I know it's dangerous to start specifying how software should behave, but there are now so many different axes to XML that it's critical that we modularise them into components.  </s>
<s> It may not be a universal view, but I find software helps to define the spec.  </s>
<s> As far as I can see a type-validation processor would only validate - not transform - and would be required to pass error indications to the next component (perhaps a link processor).  </s>
<s> Apart from different platforms I don't see the need for a large number of these validators, and it would be valuable to have an XML library where one could be picked off the shelf.  </s>
<s> P. Peter Murray-Rust, domestic net connection Virtual School of Molecular Sciences  </s>
<s> I support Steven's separation of the "data type" problem into several issues.  </s>
<s> In fact, I think it is appropriate to divide it further, and this may help to separate the work into the parts that need to be done now versus those that can be deferred.  </s>
<s> 1.How is the type of an element identified.  </s>
<s> That is, the specific syntax that says "this element is of type x".  </s>
<s> This needs to address the fact that several types are further qualified (such as the number of digits for the proposed DECIMAL type).  </s>
<s> 2.From what namespace do types come?  </s>
<s> Is it a closed set, or an extensible one?  </s>
<s> If extensible, how and by whom?  </s>
<s> 3.If a set is defined by us, is it part of the language specification, or a standard library?  </s>
<s> 4.Are data types the same as element types?  </s>
<s> Notations?  </s>
<s> Some new beast?  </s>
<s> Answering the questions above solves the problem of unambiguously attaching a data type to an element.  </s>
<s> We could go further and ask How do we validate that the element contains the claimed type?  </s>
<s> In what language are the validations expressed?  </s>
<s> How do we distribute the parsers and validators?  </s>
<s> How does validation interact with the issue of element sub-classing?  </s>
<s> (Strongly, in my opinion.) The immediate needs I am hearing from customers is only to solve the first set.  </s>
<s> That is, they simply need a way for an author of an element to communicate a subtype of PCDATA and a notation.  </s>
<s> They will have parsers for the notations they care about.  </s>
<s> They are not presently interested in any general-purpose validation, enforcement, or parsing language.  </s>
<s> I hope this is helpful.  </s>
<s> --Andrew Layman AndrewL@microsoft.com  </s>
<s> Not an option - users are screaming for datatyping  </s>
<s> Too limiting  </s>
<s> A possibility  </s>
<s> The SGML solution - but could be dangerous in a Web environment unless supported by a starter-set of useful notations  </s>
<s> This I like  </s>
<s> This ignores the real problem - how to data type attribute values.  </s>
<s> The element would have to be one with an XML reserved name, such as XML-datatype.  </s>
<s> In your examples they are presumably empty tags as the expressions are entered as attribute values, but for notations such as JavaScript and other programming type languages you would probably want it as content.  </s>
<s> Why use an amendment - why not use the existing lextype attribute from the SGML Extended Facilities annex?  </s>
<s> You don't need a new markup declaration for datatypes - we can use LEXTYPE.  </s>
<s> The SGML Extended Facilities annex already shows how lexical types can be declared in a reusable document instance that can be referred to by many DTDs using a ?IS10744  </s>
<s> LEXUSE processing instruction.  </s>
<s> (XML should not invent its own set of cogs - it should find more efficient ways of using existing SGML ones!)  </s>
<s> You don't need a new construct for identifying the lextype of attributes in  </s>
<s> declared values (this would require a change to SGML before becoming valid).  </s>
<s> Simply adopt the lextype attribute of HyTime.  </s>
<s> This allows you to associate  </s>
<s> different lexical types with different attributes and with content, e.g. !ATTLIST element-x a CDATA #REQUIRED b CDATA #IMPLIED c CDATA "default" lextype CDATA #FIXED "#CONTENT lextype-x a lextype-a b lextype-b c` lextype-c" You also need a way for users to override the default lextype in certain circumstances.  </s>
<s> Hence my earlier suggestion to allow PI's with notation (or lexical type) names to element-x a=" ?XML-LEX my-lex?  </s>
<s> value" .  </s>
<s> Martin Bryan, The SGML Centre, Churchdown, Glos.  </s>
<s> GL3 2PU, UK  </s>
<s> This is my favourite.  </s>
<s> It is in the spirit of XML (the 95% solution with 5% of the effort).  </s>
<s> C and d add a lot of complexity and I can see very little gain.  </s>
<s> As programming languages and SQL show, you don't need more than half a dozen types.  </s>
<s> Something close to this set is enough: boolean, integer, real, character, string, and date/time.  </s>
<s> XML already has ways to make arrays, records and pointers.  </s>
<s> Bert  </s>
<s> Steve's analysis is sensible and I agree with most of it.  </s>
<s> It is totally undeniable that a general typing mechanism, whether based on regex or hylex or whatever, gives a degree of flexibility and fine control that is unbeatable.  </s>
<s> [snip]  </s>
<s> One point - count me as one vote *against* wiring this into either XML-lang or WG8, and *for* doing it in a separate doc, using vanilla attribute/notation mechanisms, for now.  </s>
<s> That way everybody gets to use it now, and people who don't care don't have to build the machinery into the parser... let's try and defend that grad-student-week, it's one of our proudest achievements.  </s>
<s> -Tim  </s>
<s> Usually, I'm on the "leave the application developers to their own devices" side, but I agree with Tim.  </s>
<s> At least from the database perspective I'm getting right now, a separate document that provides a set of data types based on the SQL set appears to be a very sensible and immediately useful product.  </s>
<s> ONE For.  </s>
<s> len  </s>
<s> One point - count me as one vote *against* wiring this into either XML-lang or WG8, and *for* doing it in a separate doc, using vanilla attribute/notation mechanisms, for now.  </s>
<s> That way everybody gets to use it now, and people who don't care don't have to build the machinery into the parser... let's try and defend that grad-student-week, it's one of our proudest achievements.  </s>
<s> -Tim  </s>
<s> I agree completely with this.  </s>
<s> Don't forget that XML-lang *as at present* is an extremely powerful tool that 99% of potential users have never seen and it will take time to get used to.  </s>
<s> Except for a few very minor tweaks as are occasionally reported it works.  </s>
<s> People are developing DTDs using it.  </s>
<s> XML-TYPE is functionally completely independent of XML-lang and can be managed by a post-parser module.  </s>
<s> I may have missed it in the draft, but I'd suggest adding the following phrase in 3.3 or appropriate place: "the use of attribute names beginning "XML-" in any way other that those described in this specification and [reference to other XML specs] is [some form of error]" And to advise as an annexe that the following attribute names are currently reserved: XML-TYPE XML-LINK XML-SPACE XML-STYLE It might be appropriate to add something like "some of these attributes may be processed and/or validated in dedicated modules" For the SD5 debate, I was only asking for a convenient character that current parser technology could pass through unaltered.  </s>
<s> If necessary I can always use the colonic approach with a string like 'CML___...MOL' (work that one out :-)  </s>
<s> For the XML-LINK discussions, I think it's important to decide whether the spec is implementable by a CS grad student *without previous HyTime experience* and purely from the spec.  </s>
<s> I think it should be.  </s>
<s> I also think  </s>
<s> those implementations should have a communality of function [I understand, but I'm worried by, simply defining the terms and leaving the rest up to the implementation.  </s>
<s> Implementers need more guidance than that.]  </s>
<s> P. Peter Murray-Rust, domestic net connection Virtual School of Molecular Sciences  </s>
<s> Steve's analysis is sensible and I agree with most of it.  </s>
<s> It is totally undeniable that a general typing mechanism, whether based on regex or hylex or whatever, gives a degree of flexibility and fine control that is unbeatable.  </s>
<s> My SQL proposal offers only two bits of added functionality: - the MIN and MAX values that can be used to constrain data ranges, and - the fact that the DATE and TIME values carry validation semantics that cannot reasonably be expressed in regexps, yet are not that hard to implement and are generally implemented by library functions all over the place.  </s>
<s> My analysis based only on personal experience is that what people really de facto want out there in the MIS world is those few basic SQL types; thus if we got a general-purpose regexp-based facility, I would go ahead and package up a set of pre-cooked forumlations that would give people those SQL types.  </s>
<s> I expect that's what people would use mostly... which makes me wonder where the regexp solution sits on the cost-benefit curve.  </s>
<s> There is one other problem, I have no idea how serious it is, but it needs to be addressed: the implementation of general pattern-based typing in the wide-character environment.  </s>
<s> Naive implementations of automata for regexps become nonviable when the table has to have 64k columns.  </s>
<s> Doable, of course, but...  </s>
<s> From my point of view, I *know* that there are some people who need those SQL types, and I know validators for them are no sweat - from here they look like another one of the 80/20 points we seem to have had some success in hitting.  </s>
<s> On the other hand, it seems pretty obvious that if there was a general pattern-based typing facility, it would find lots of uses - I know I'd use it.  </s>
<s> Don't know if I'd be able to build it, though.  </s>
<s> One point - count me as one vote *against* wiring this into either XML-lang or WG8, and *for* doing it in a separate doc, using vanilla attribute/notation mechanisms, for now.  </s>
<s> That way everybody gets to use it now, and people who don't care don't have to build the machinery into the parser... let's try and defend that grad-student-week, it's one of our proudest achievements.  </s>
<s> -Tim  </s>
<s> Yes.  </s>
<s> Under the current terms and relationships, that is the best goal.  </s>
<s> This is true, but harder.  </s>
<s> Implementation guidance in VRML specifications is being decided after the fact of language specification in the process of conformance testing design.  </s>
<s> However, VRML is a single application language.  </s>
<s> Is XML?  </s>
<s> What levels of conformance are tested for XML and how is that related to implementation certification?  </s>
<s> I think deciding that will make it easier to decide where the lines are.  </s>
<s> len  </s>
<s> [C Blullard]  </s>
<s> Right.  </s>
<s> I have asked more than once on this list what "conformance" will mean for XML "processors".  </s>
<s> I have yet to hear anything back which furthers my torment that I am missing something:-( Sean Sean Mc Grath sean@digitome.com  </s>
<s> Digitome Electronic Publishing  </s>
