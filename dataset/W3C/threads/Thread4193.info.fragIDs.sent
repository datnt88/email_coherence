<s> In my 2/11 reply to your note below a few items were not addressed as these needed to be taken up by the F&amp;O task force.  </s>
<s> These items were discussed on 3/3 and resolved as below.  </s>
<s> Again, we thank you for your comments and close reading of the document.  </s>
<s> - For all functions that accept an optional collation argument: What happens if a collation is specified but the sequence is not  </s>
<s> strings?  </s>
<s> Is the collation just ignored?  </s>
<s> [AM] Agreed.  </s>
<s> The next draft will contain appropriate wording.  </s>
<s> - According to the Unicode(tm) website, Unicode(tm) is a trademark and should be designated so everywhere it is used.  </s>
<s> See  </s>
<s> [AM] There is no precedent for this in any of the XML specs.  </s>
<s> One of the taskforce participants said that their lawyers had told him that the trademark needed to be cited only if there was a contractual dependency between the partners.  </s>
<s> *** 6.2 The codepoints-to-string() and string-to-codepoints() functions are  </s>
<s> great,  </s>
<s> but they are completely underspecified.  </s>
<s> - What happens if the input sequence to codepoints-to-string() is  </s>
<s> empty?  </s>
<s> (Presumably the empty string, but this is not stated.) - What happens if the codepoints are not valid characters in XQuery strings, for example codepoints-to-string((0))? - What happens if the codepoints contain a combining sequence that is  </s>
<s> not  </s>
<s> valid? - What happens if the codepoints are not valid codepoints (i.e.,  </s>
<s> outside  </s>
<s> the range 0-10FFFF inclusive)?  </s>
<s> [AM] Agreed.  </s>
<s> Additional semantics will be specified in the next draft.  </s>
<s> *** 6.4 - The following functions perform comparisons, and therefore should probably accept an optional collation argument (but currently do not): tokenize substring [this one's especially weird, because substring-after/substring-before do accept an optional collation  </s>
<s> argument]  </s>
<s> - The lower-case and upper-case functions are locale-unaware.  </s>
<s> Consider  </s>
<s> supplying another argument (collation or otherwise) to allow  </s>
<s> applications  </s>
<s> to handle locale-dependent casing (such as the famous Turkish I).  </s>
<s> [AM] From the minutes of the meeting: On locale-dependent casing; we will ask the author of the message to please refer to a specification that we can reference to make this change.  </s>
<s> (Collations do not have casing information.) Unicode TR21 defines a table that has locale-insensitive folding and mentions locale-sensitive folding.  </s>
<s> The editors will ask for public feedback in this area.  </s>
<s> - Consider adding at least title-case() and possibly also case-fold().  </s>
<s> It  </s>
<s> is strange to select only two of the four functions described in the Unicode Case Model (TR #10).  </s>
<s> Both the Java and .NET  </s>
<s> class libraries support  </s>
<s> these  </s>
<s> functions, so there is no barrier to development.  </s>
<s> [AM] The taskforce did not agree to these suggestions.  </s>
<s> *** 14.3.1,  </s>
<s> 14.3.2 - It's strange that sequence-deep-equal() and sequence-node-equal()  </s>
<s> return  </s>
<s> the empty sequence if either argument is the empty sequence, but  </s>
<s> otherwise  </s>
<s> return false if their two arguments have different lengths.  </s>
<s> I  </s>
<s> recommend  </s>
<s> against special-casing the empty sequence here.  </s>
<s> The empty sequence  </s>
<s> should  </s>
<s> compare true with itself, and false with every other sequence.  </s>
<s> [AM] Agreed.  </s>
<s> The next draft will contain these changes.  </s>
<s> All the best, Ashok  </s>
<s> From: Ashok Malhotra Sent: Tuesday, February 11, 2003 9:38 AM Thank you for your comments.  </s>
<s> Please see inline.  </s>
<s> All the best, Ashok -----Original Message----- From: XQuery [mailto:xquery@attbi.com] Sent: Saturday, January 25, 2003 3:59 PM Subject: Some F&amp;O issues Apologies if some of these have been previously reported or are open issues; I did not perform due diligence and check.  </s>
<s> (For that matter, I may  </s>
<s> have  </s>
<s> reported some of these already myself, I didn't keep track.) *** All sections - For all functions that accept an optional collation argument: What happens if a collation is specified but the sequence is not  </s>
<s> strings?  </s>
<s> Is the collation just ignored?  </s>
<s> [AM] Good point.  </s>
<s> I've put it on the F&amp;O telcon agenda.  </s>
<s> - According to the Unicode(tm) website, Unicode(tm) is a trademark and should be designated so everywhere it is used.  </s>
<s> See [AM] Good point.  </s>
<s> Editorial.  </s>
<s> *** 6.2 The codepoints-to-string() and string-to-codepoints() functions are  </s>
<s> great,  </s>
<s> but they are completely underspecified.  </s>
<s> - What happens if the input sequence to codepoints-to-string() is  </s>
<s> empty?  </s>
<s> (Presumably the empty string, but this is not stated.) - What happens if the codepoints are not valid characters in XQuery strings, for example codepoints-to-string((0))? - What happens if the codepoints contain a combining sequence that is  </s>
<s> not  </s>
<s> valid? - What happens if the codepoints are not valid codepoints (i.e.,  </s>
<s> outside  </s>
<s> the range 0-10FFFF inclusive)?  </s>
<s> [AM] [AM] On the agenda.  </s>
<s> *** 6.4 - The following functions perform comparisons, and therefore should probably accept an optional collation argument (but currently do not): tokenize [TBD] substring [this one's especially weird, because substring-after/substring-before do accept an optional collation  </s>
<s> argument]  </s>
<s> - The lower-case and upper-case functions are locale-unaware.  </s>
<s> Consider  </s>
<s> supplying another argument (collation or otherwise) to allow  </s>
<s> applications  </s>
<s> to handle locale-dependent casing (such as the famous Turkish I). - Consider adding at least title-case() and possibly also case-fold().  </s>
<s> It  </s>
<s> is strange to select only two of the four functions described in the Unicode Case Model (TR #10).  </s>
<s> Both the Java and .NET  </s>
<s> class libraries support  </s>
<s> these  </s>
<s> functions, so there is no barrier to development.  </s>
<s> [AM] We have discussed similar suggestions but they are on the agenda again.  </s>
<s> - Is it an error if in the quantifier {n,m}, n  m ?[AM]  </s>
<s> [AM] I presume this refers to the translate function.  </s>
<s> The semantics  </s>
<s> for  </s>
<s> this case are specified.  </s>
<s> - What happens if n or m exceeds the maximum integer value supported  </s>
<s> by  </s>
<s> the implementation?  </s>
<s> *** 14.3.1,  </s>
<s> 14.3.2 - It's strange that sequence-deep-equal() and sequence-node-equal()  </s>
<s> return  </s>
<s> the empty sequence if either argument is the empty sequence, but  </s>
<s> otherwise  </s>
<s> return false if their two arguments have different lengths.  </s>
<s> I  </s>
<s> recommend  </s>
<s> against special-casing the empty sequence here.  </s>
<s> The empty sequence  </s>
<s> should  </s>
<s> compare true with itself, and false with every other sequence.  </s>
<s> [AM] This is on the agenda based on other mail.  </s>
<s> *** 14.4 - I found section 14.4 difficult to interpret precisely and correctly.  </s>
<s> Some particular problems with the wording: [AM] The text in these sections has been rewritten.  </s>
<s> I hope you will  </s>
<s> find  </s>
<s> that the next version of the document addresses your concerns.  </s>
<s> Some revision may be necessary now that we have agreed to preserve the  </s>
<s> timezone  </s>
<s> on date/time values.  </s>
<s> *** 14.4.3, 14.4.4 - How do min()/max() behave on the empty sequence?  </s>
<s> The text does not  </s>
<s> say.  </s>
<s> - Must all members really be the exact same type?  </s>
<s> The other functions promote all numeric types to a common type.  </s>
<s> - What happens if members are subtypes (e.g., subtypes of the duration types)?  </s>
<s> Presumably they're promoted to the appropriate duration type  </s>
<s> and  </s>
<s> the comparison performed there, but the text taken literally precludes this possibility.  </s>
<s> *** 14.4.2, 14.4.5 - The sum function really ought to be listed immediately before avg.  </s>
<s> Fine, they're in alphabetical order, blah blah.  </s>
<s> I'm not convinced.  </s>
<s> - The constraints for sum() and avg() are strangely not alike.  </s>
<s> - Both functions talk about timezone normalization, even though date/time/dateTime values are not allowed (because both functions  </s>
<s> require  </s>
<s> that all members be numeric or else the same type and support  </s>
<s> op:add().  </s>
<s> The only definition of op:add() on non-numeric types in which both  </s>
<s> operands  </s>
<s> have the same types are yearMonthDuration and dayTimeDuration).  </s>
<s> - Similarly, both functions talk about support op:add() (and in the  </s>
<s> case  </s>
<s> of avg, division by integer).  </s>
<s> But clearly the numeric types and the two duration types I just mentioned are the only types that fit this bill,  </s>
<s> so  </s>
<s> the description is unnecessarily indirect.  </s>
<s> Cheers, Michael Brundage xquery@attbi.com  </s>
<s> In section 2.4.3, the XQuery language draft says: "It is a static error [err:XP0008] to use an ElementName in an ElementTest if that name is not found in the in-scope element definitions unless a TypeNameOrWildcard is specified." and "It is a static error [err:XP0008] to use an AttributeName in an AttributeTest if that name is not found in the in-scope attribute definitions unless a TypeNameOrWildcard is specified."  </s>
<s> But the error description for XP0008 reads: "It is a static error if an expression refers to a type name, function name, namespace prefix, or variable name that is not defined in the static context." which does not cover element or attribute names.  </s>
<s> It seems to me that a new error should be created for these 2 cases.  </s>
<s> Thanks, Priscilla  </s>
<s> Fixed by adding element and attribute names to XP0008.  </s>
<s> Thanks!  </s>
<s> --Don Chamberlin "Priscilla Walmsley" priscilla@walmsley.com  </s>
<s> Sent by: public-qt-comments-request@w3.org 11/21/2003 07:16 AM Subject: [XQuery] use of XP0008 for element/attribute names In section 2.4.3, the XQuery language draft says: "It is a static error [err:XP0008] to use an ElementName in an ElementTest if that name is not found in the in-scope element definitions unless a TypeNameOrWildcard is specified." and "It is a static error [err:XP0008] to use an AttributeName in an AttributeTest if that name is not found in the in-scope attribute definitions unless a TypeNameOrWildcard is specified."  </s>
<s> But the error description for XP0008 reads: "It is a static error if an expression refers to a type name, function name, namespace prefix, or variable name that is not defined in the static context." which does not cover element or attribute names.  </s>
<s> It seems to me that a new error should be created for these 2 cases.  </s>
<s> Thanks, Priscilla  </s>
