From: David W. Morris[SMTP:dwm@shell.portal.com] 
Subject: Re: Sticky header 
I think this leads to an ambiguous situation when the client is pipelining requests. 
We identified this ambiguity at the meeting we had in January of the persistent-connections subgroup. 
I think the ambiguity is also resolved if we change HTTP/1.1 to not allow pipelining UNTIL the first server response is received accepting the persistent connection and hence pipelining. 
I thought that this was already the rule. 
Did it get lost when we made persistence the default? 
That response will either include the server acceptance of the STICKY more or it won't. 
But there will be no ambiguity for the server to interpret. 
Dave Morris 
From: David W. Morris[SMTP:dwm@shell.portal.com] 
I think this leads to an ambiguous situation when the client is pipelining requests. 
We identified this ambiguity at the meeting we had in January of the persistent-connections subgroup. 
I think the ambiguity is also resolved if we change HTTP/1.1 to not allow pipelining UNTIL the first server response is received accepting the persistent connection and hence pipelining. 
I thought that this was already the rule. 
Did it get lost when we made persistence the default? 
Not lost, exactly. 
My recollection of the situation is this: The draft-*-06 spec does not require the client to wait before pipelining. 
Dave Morris asserted that this could cause problems; Roy Fielding asserted that it would not. 
Larry Masinter asked some people to consider the issue. 
My position was that I was not convinced by either side. 
I suggested that if Dave (or someone else) could come up with a specific example of how this would break, then I would be more sympathetic to his point of view. 
As far as I remember, nobody has provided such an example. 
Given that the "Proposed Standard" phase is the place to take this kind of risk, I felt it was not necessary to require the client to wait. 
Note that if waiting is actually unnecessary and yet the spec requires the client to wait, we are wasting an entire RTT on many (although not all) HTTP connections. 
I suggest that this would be a mistake. 
In particular, if you agree with me that the existing sticky-header proposal has the race condition that I believe it has, it would be possible to eliminate it either by requiring a client to wait before pipelining, or to use the three-way handshake that I described. 
But because of the extra RTT delay the former option imposes on pipelining, it seems preferrable to avoid it if possible. 
-Jeff 
I agree that it has a race condition (but I beleive your example purporting to show it had a bug). 
I think the simplest fix is to require a client that wants to pipeline and use sticky headers to wait to start taking advantage of sticky headers until it has seen a response from the server agreeing to use sticky headers. 
I think this extra RTT wait is OK because I think the 
occaisions where the client has any idea of what to fetch in a pipelined manner when the connection is first opened are rare -- typically, it needs to get the first HTML resource before it knows which GIFs to fetch (in a pipelined manner). 
I agree that this is the best solution to the problem, if only because it's the simplest. 
I know it's the simplest, because it's the one I first thought of, and if I thought of it.... 
This rule probably should apply to any future Connection features/extensions as well. 
Daniel DuBois, Software Animal http://www.spyglass.com/~ddubois/ 
Subject: Sorry From: Dedi Shy shayd@post.tau.ac.il Newsgroups: sci.chem 
I'm afraid that if someone will do a query on me in Deja News research service he'll think I'm a real shallow person cuase all the newsgroups I'm writting to begin with alt.tv. 
So I'm writting to all the intellectual newsgroups also, so they'll see I'm really smart. 
Sorry for the disturbance! 
