<s> I thought I'd send some comments in now that it's last call.  </s>
<s> Briefly, what I saw (I focussed on the core) looks good -- addresses many (but not all) of the issues I had with the level 1 work, and I'm glad to see that things went along smoothly even in my absence!  </s>
<s> :-) Of particular note: * The system and public IDs are really for the "document type's external subset", not for the "document type", as it's now written.  </s>
<s> DTDs often consist of many components, each with their own identifiers.  </s>
<s> As written, those IDs could refer to one of dozens of identifiers -- not useful.  </s>
<s> I'd like to see DomImplementation and DocumentType describe this correctly (a small editorial change).  </s>
<s> * I can't see how I'd write a chunk of code that'll know it can use Level 2 features ... e.g. it's portable and needs to work with both L1 and L2. I'd like to see a "DOM" feature (for DOMImplementation) be defined, which would report on which level is supported.  </s>
<s> * It's confusing to have feature definitions scattered all over the spec.  </s>
<s> I'd like to see them collected in one table at one place, so their overall scope is more readily understood.  </s>
<s> * I still don't see why there's no solution for getting access to a system default DOM implementation, at least for Java.  </s>
<s> I'm posting an implementation in a followup post.  </s>
<s> I'd like to see something like this in the org.w3c.dom  </s>
<s> Java package.  </s>
<s> Thanks for the good work! - Dave  </s>
<s> LookI like the report format, but I still feel like I need the table of contents to have clickable links to let me get to each of the documented classes.  </s>
<s> This structure (sans such TOC support) is relatively hard to navigate.  </s>
<s> 1.1.7Namespaces  </s>
<s> ... it may be useful to note that the DOM has adopted an 'early binding' model of namespace URIs to elements.  </s>
<s> With early binding, the URIs are permanently bound to elements as they get created.  </s>
<s> Late binding is more like what one would get by moving text around in a text editor -- the URI bindings are context-dependant.  </s>
<s> (So there are significant ramifications...) Also, I'm glad to see the simplification of having the namespace support be in the core interfaces versus being separate.  </s>
<s> Life is much easier that way!  </s>
<s> 1.2General re compatibility ... I don't see how I can write a chunk of code that'll know to act differently if it's using DOM Level 2 or DOM Level 1. SUGGESTION: have a DOMImplementation 'feature".  </s>
<s> "DOM" would have values "1.0" (for DOM L1) or "2.0" (L2).  </s>
<s> 1.2DOMException ... ambiguous re whether the other numeric codes are reserved to W3C or not.  </s>
<s> They should be.  </s>
<s> Similar comment for "Node" ... nobody except W3C should be defining new numeric codes for "nodeType".  </s>
<s> 1.2DomImplementation ... createDocumentType() seems to have no accomodation for an internal subset.  </s>
<s> I'd suggest at least correcting the text; it's not the "document type system identifier" (or public ID), but the "external subset system identifier" (or public identifier).  </s>
<s> Also, having the "feature" identifiers scattered throughout the document is suboptimal.  </s>
<s> At least list the features from each chapter up at the front of the chapter, in a table to visually highlight them.  </s>
<s> 1.2Document ... refers to "invalid" characters.  </s>
<s> "Illegal" would be more correct (with reference under DOMException to XML, HTML, and related specs for what that means).  </s>
<s> Of course the INVALID_CHARACTER_ERR name is grandfathered... 1.2Document.importNode  </s>
<s> ...  </s>
<s> I'm rather uncomfortable with that name "import" since that implies the same object is in use (e.g. if I import something from Canada).  </s>
<s> "copy" is the appropriate word, and is even used in the documentation more than once.  </s>
<s> "import" suggests the wrong thing.  </s>
<s> 1.3DocumentType ... as above on DomImplementation, the text should say the IDs are for the "document type's external subset", 7Traversal ...  </s>
<s> I'm still not a fan of this stuff, but at least it's optional.  </s>
<s> (Seems like it should integrate with the view mechanism in some places, but doesn't -- oops.) App CJava Binding ... I ** REALLY ** think it'd be useful to define a standard way to get access to a DOM implementation, so that only parser connectivity really needs to be left to nonstandard APIs.  </s>
<s> A few more comments on the core, and a correction to what I said earlier.  </s>
<s> The NamedNodeMap.setNamedItemNS method seems to be missing.  </s>
<s> 1.1.1The  </s>
<s> description of "Document" should also say that there may only be a maximum of one DocumentType; it's not just true for Elements.  </s>
<s> 1.2DOMImplementation.createDocumentType ... the more I look at it, the less I like the notion that the document type be associated with some document "late" in the game.  </s>
<s> Every node in the doctype then needs to be able to get coupled "late" to an owning document, rather than being so coupled from day one.  </s>
<s> That basically means every type of node in the whole DOM, not just DocumentType, may need to work with a null ownerDocument.  </s>
<s> Yuck.  </s>
<s> One patch is to have DocumentType.getEntities/getNotations  </s>
<s> be able to throw an appropriate exception if they're called without having the DocumentType bound to a document yet; that eliminates all the cases where nodes (perhaps many, many, many of them!) will need to be patched up or try to lie about their owner document.  </s>
<s> Of course all that still leaves open the question of when contents get stuffed into a DocumentType object.  </s>
<s> Though construction seems to be out of scope for DOM, the spec does need to ensure there's a workable answer.  </s>
<s> And I don't clearly see one now, unless it's to stick to the DOM L1 model without the DocumentType special cases.  </s>
<s> 1.2Node.cloneNode  </s>
<s> ... clones are always mutable, yes?  </s>
<s> Needs stating; else a conformant implementation couldn't support the process that was outlined with Entity nodes (mutating clones of readonly nodes).  </s>
<s> 1.2Attr ... nit, the lack of a space after the period terminating the first sentence of the "Attr" description confuses javadoc.  </s>
<s> Looks like some tool is stripping whitespace that's a line end, rather than just normalizing it to other whitespace (some other text got merged, e.g. in that adjoined sentence).  </s>
<s> 1.2NamedNodeMap.*ItemNS  </s>
<s> ... what should this do when being used to access items (notations and entities from the DTD) that aren't scoped with namespaces?  </s>
<s> How about if the namespace URI is null?  </s>
<s> NamedNodeMap.setNamedItemNS ... no such method; why?  </s>
<s> Everywhere else there are both namespace-naive and namespace-aware methods, but this one (very important!) case is omitted.  </s>
<s> NamedNodeMap.removeNamedItem ... should be able to report an error (NO_MODIFICATION_ALLOWED_ERR) for readonly maps, just like the setNamedItem method.  </s>
<s> NamedNodeMap.item ... negative indices should return null too 1.3DocumentType ... please change the "publicID" and "systemID" to  </s>
<s> match the case ("Id" not "ID") in Notation and Entity nodes.  </s>
<s> It's a gratuitous change in convention, and complicates some code sharing that would otherwise be natural.  </s>
<s> Ignore that one, sorry -- I noticed such functionality is there, evidently I missed it before.  </s>
<s> It does help.  </s>
<s> - Dave  </s>
<s> That's clearly an oversight from me, I'll fix it right away.  </s>
<s> Arnaud  </s>
