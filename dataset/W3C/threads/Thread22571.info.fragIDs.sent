<s> I am kind of lost here.  </s>
<s> my code is the following.  </s>
<s> I have a [test] org.apache.xerces.dom.DOMExceptionImpl: DOM006 Hierarchy request error [test] org.apache.xerces.dom.DOMExceptionImpl: DOM006 Hierarchy request error on the appendChild call in insertFragment method.  </s>
<s> If I remove this two lines It works really fine.  </s>
<s> Can anyone help please .  </s>
<s> main DocumentImpl docum = new DocumentImpl(); DocumentFragment docC=requeteCollecte.cpgnCreation(array,dateModif,docum); // I create the fragment with this method : DocumentFragment doc = docum.createDocumentFragment();  </s>
<s> Document doc = requeteCollecte.insertFragment(docC,docum);  </s>
<s> public Document insertFragment(DocumentFragment fragment, Document doc) if(doc!=null) Element element = doc.createElement("creation");  </s>
<s> doc.appendChild(element); NodeList list = fragment.getChildNodes();  </s>
<s> if(list!=null) for(int i=0;i list.getLength();i++)  </s>
<s> doc.appendChild(list.item(i));  </s>
<s> NamedNodeMap att = fragment.getAttributes();  </s>
<s> if(att!=null) for(int j=0;j att.getLength();j++) doc.appendChild(att.item(j)); return doc; Armelle Clech  </s>
<s> Armelle, A Document can have only ONE child of type ELEMENT_NODE (this is the "document element").  </s>
<s> see DOM spec : If you replace doc.appendChild(....) by element.appendChild(...) in insertFragment this should solve your problem even if I'm not sure it will give the result you are expecting...  </s>
<s> Christophe  </s>
<s> This mailing list is meant to discuss aspects of the DOM *specification*.  </s>
<s> Questions about specific implementations should be sent elsewhere.  </s>
<s> For Xerces-J the right list is xerces-j-dev.  </s>
<s> See Arnaud Le Hors - IBM Cupertino, XML Technology Group  </s>
