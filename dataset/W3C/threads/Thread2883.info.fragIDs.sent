<s> Should a Connection: close header be allowed on a 100-continue response?  </s>
<s> If so what does it mean?  </s>
<s> Does it  </s>
<s> mean the connection is closed after the 100-continue response is sent and the body must be sent on a new connection (seems very wrong) or that the body is sent and the connection is closed after the final response, and if so, shouldn't that final response have a Connection: close header?  </s>
<s> 14.10 Connection HTTP/1.1 defines the "close" connection option for the sender to signal that the connection will be closed after completion of the response.  </s>
<s> For example, Connection: close in either the request or the response header fields indicates that the connection SHOULD NOT be considered `persistent' (section 8.1) after the current request/response is complete.  </s>
<s> HTTP/1.1 applications that do not support persistent connections MUST include the "close" connection option in every message.  </s>
<s> I think the "every message" is incorrect.  </s>
<s> In trying to come up with alternative wording I now question if it makes any sense to send it on a 101 response?  </s>
<s> Alternate wording would be either: "every message except 100 continue responses" or "every message except 1XX responses".  </s>
<s> But I think that  </s>
<s> might be too broad.  </s>
<s> If you don't agree with the above, then I think the following needs to be considered: 8.1.2  </s>
<s> Overall Operation  </s>
<s> Persistent connections provide a mechanism by which a client and a server can signal the close of a TCP connection.  </s>
<s> This signaling takes  </s>
<s> place using the Connection header field (section 14.10).  </s>
<s> Once a close has been signaled, the client MUST NOT send any more requests on that connection.  </s>
<s> Should this be "send any more requests" or "begin any more requests though it may complete in process ones such as sending a body after receiving a 100-continue response" ?  </s>
<s> Thanks.  </s>
<s> Howard  </s>
<s> Does it matter?  </s>
<s> Does there exist a realistic situation in which a server would send Connection: close and require a consistent, interoperable behavior on the part of the client?  </s>
<s> No? Then it doesn't need to be specified.  </s>
<s> ....Roy  </s>
<s> I came at it from another spot.  </s>
<s> While trying to work around an IE bug: we found our server implementation could do better at sending "Connection: close" when it knew it was going to close the connection and not just relying on clients to cope well with dropped connections.  </s>
<s> In trying to get it right, we weren't sure if we should send it on 100-continue responses.  </s>
<s> Someone here read: HTTP/1.1 applications that do not support persistent connections MUST include the "close" connection option in every message.  </s>
<s> and thought we needed to send it (a 100-continue response is a message so we MUST include it).  </s>
<s> It didn't make sense to me, thought it could break things, and wanted to check what was right.  </s>
<s> We won't send close on 100-continue responses.  </s>
<s> Howard  </s>
<s> Oh, I didn't realize you were asking about something that is already specified incorrectly in the spec.  </s>
<s> That is definitely an error in section 14.10 of RFC 2616.  </s>
<s> It should say An HTTP/1.1 client that does not support persistent connections MUST include the "close" connection option in every request message.  </s>
<s> An HTTP/1.1 server that does not support persistent connections MUST include the "close" connection option in every response message that does not have a 1xx (informational) status code.  </s>
<s> since, as you say, it doesn't make any sense to send it on a 1xx message.  </s>
<s> ....Roy  </s>
